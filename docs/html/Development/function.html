<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.功能模块说明 &mdash; 杰理之家开发文档(IOS) 1.13.0 文档</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="https://doc.zh-jieli.com/Apps/static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="https://doc.zh-jieli.com/Apps/static/js/custom.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="3 目录浏览" href="browse_desc.html" />
    <link rel="prev" title="1.接入流程" href="import_desc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> 杰理之家开发文档(IOS)
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">开发框架</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Framework/framework.html">SDK架构</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开发说明</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="import_desc.html">1.接入流程</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2.功能模块说明</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">2.1 基础功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">2.1.1 请求设备信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">2.1.2 查询设备系统信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">2.1.3 监听设备状态信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">2.1.4 切换设备模式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id7">2.2 音量控制功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">2.2.1 设备音量设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">2.2.2 示例代码</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id10">2.3 设备音乐控制</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">2.3.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">2.3.2 示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">2.3.3 相关接口</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">2.3.3.1 使用范例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id15">2.4 均衡器调试功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">2.4.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">2.4.2 示例代码</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#eq">2.4.2.1 系统EQ调试</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">2.4.2.2 设置混响/限幅</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">2.4.2.3 使用范例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id20">2.5 时钟功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id21">2.5.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#demo">2.5.2 使用demo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">2.5.2.1 同步时间</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23">2.5.2.2 读取闹钟</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24">2.5.2.3 修改闹钟</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25">2.5.2.4 删除闹钟</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26">2.5.2.5 获取默认铃声选择列表</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">2.5.2.6 闹钟铃声试听</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28">2.5.2.7 停止铃声试听</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29">2.5.2.8 获取闹铃模式设置</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">2.5.2.9 设置闹铃模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id31">2.5.2.10 闹钟正在响或则闹钟停止响</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32">2.5.2.11 停止闹钟响声回调</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id34">2.6 外接设备控制功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id35">2.6.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id36">2.6.2 示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id37">2.6.3 注意事项</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fm">2.7 FM控制功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id38">2.7.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id39">2.7.2 相关接口</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id40">2.7.3 示例代码</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id41">2.8 灯光控制功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id42">2.8.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id43">2.8.2 相关接口</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id44">2.8.3 示例代码</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id45">2.9 ID3信息控制功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id46">2.9.1 控制类相关接口</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id47">2.9.1.1 使用范例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id48">2.9.2 监听以及使用方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lrc">2.9.3 设备LRC歌词显示</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id49">2.9.3.1 功能描述</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id50">2.9.3.2 示例代码</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tws">2.10 TWS功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id51">2.10.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id52">2.10.2 示例代码</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id53">2.10.2.1 智能充电仓相关</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id54">2.10.2.2 获取设备的图片</a></li>
<li class="toctree-l4"><a class="reference internal" href="#edr">2.10.2.3 设置EDR名字</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id57">2.10.2.4 按键设置(对耳)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#led">2.10.2.5 LED设置(对耳)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mic">2.10.2.6 MIC设置(耳机)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id61">2.10.2.7 工作模式(耳机)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id63">2.10.2.8 同步时间戳(耳机)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id65">2.10.2.9 获取设备信息(耳机)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id67">2.10.2.10 设备广播通知(耳机)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id69">2.10.2.11 关闭或开启设备广播(耳机)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adv">2.10.2.12 用于ADV设置同步后需要主机操作的行为</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id72">2.10.2.13 对挂脖耳机类型支持</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id73">2.10.2.14 辅听耳机验配功能</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id74">2.10.2.15 一拖二耳机功能支持</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#anc">2.11 ANC设置功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id76">2.11.1 功能说明</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sdkanc">2.11.2 耳机SDK添加ANC(主动降噪)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id77">2.11.2.1 使用范例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id78">2.12 声卡功能配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id79">2.12.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id80">2.12.2 示例代码</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id81">2.12.2.1 使用范例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id82">2.12.3 配置文档</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id83">2.12.3.1 使用范例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id84">2.13 查找设备功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id85">2.13.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id86">2.13.2 示例代码</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id87">2.13.2.1 使用范例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id88">2.14 用户自定义命令功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id89">2.14.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id90">2.14.2 示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id91">2.14.3 注意事项</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ota">2.15 OTA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id92">2.15.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id93">2.15.2 使用demo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id94">2.15.2.1 OTA升级文件下载</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id95">2.15.2.2 OTA升级设备</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id96">2.15.2.3 OTA的升级状态</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id97">2.15.2.4 OTA的返回结果</a></li>
<li class="toctree-l4"><a class="reference internal" href="#md5">2.15.2.5 获取MD5的数据</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id98">2.15.2.6 版本校对,并获取升级文件</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id99">2.15.2.7 执行OTA升级</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id100">2.16 设备提示音替换</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id101">2.16.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wts">2.16.2 音频文件转码 .WTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id102">2.16.3 打包/解包音频文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id103">2.16.4 获取设备的提示音信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id104">2.16.5 替换设备的提示音</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id105">2.17 带屏幕设备功能设置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id107">2.17.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id108">2.17.2 屏幕亮度设置/获取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id109">2.17.3 手电筒设置/获取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id110">2.17.4 当前设备使用的屏显信息获取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id111">2.17.5 屏幕保护程序背景获取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id112">2.17.6 屏幕图片设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id113">2.17.7 同步天气到设备</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#spdif">2.18 SPDIF模式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id115">2.18.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id116">2.18.2 更新SPDIF模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id117">2.18.3 获取SPDIF模式的状态</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id118">2.18.4 设置SPDIF模式的播放状态</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id119">2.18.5 设置SPDIF模式音源</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pc">2.19 PC从机模式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id121">2.19.1 功能描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id122">2.19.2 更新PC从机模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id123">2.19.3 获取PC从机模式的状态</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id124">2.19.4 设置PC从机模式的播放状态</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id125">2.19.5 设置PC从机模式的操作类型</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="browse_desc.html">3 目录浏览</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">工程介绍</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../resource/index.html">1. SDK开发包介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resource/index.html#id1">2. 功能实现参考</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Other/debug.html">测试调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Other/version.html">发布记录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Other/openSourceCommunity.html">开源社区</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">杰理之家开发文档(IOS)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>2.功能模块说明</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>2.功能模块说明<a class="headerlink" href="#id1" title="永久链接至标题"></a></h1>
<section id="id2">
<h2>2.1 基础功能<a class="headerlink" href="#id2" title="永久链接至标题"></a></h2>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>1.下列中的数据模型可以通过SDK查看</p>
<p>2.本文档只展示部分重要数据模型</p>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>获取系统/状态信息模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_Device()</span></code> 系统信息变更/状态获取，都是通过该模型获取</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>闹钟相关模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_Ring()</span></code> 闹钟铃声模型</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_AlarmSetting()</span></code> 闹钟设置模型</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">RTC_RingInfo()</span></code> 闹钟铃声详情模型，部分设备不支持，需要考虑过固件实际版本</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_RTC()</span></code> 闹钟RTC模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备文件模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_File()</span></code> 文件模型，此功能用于文件浏览/播放等一系列的文件操作相关功能</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备FM模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_FM()</span></code> FM模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>TWS耳机参数模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_Headset()</span></code> TWS耳机参数模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>蓝牙相关参数模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_BT()</span></code> 蓝牙相关参数模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>均衡调试器模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_EQ()</span></code> 均衡调试器模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备降噪模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_ANC()</span></code> 设备降噪模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备灯光模式模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JL_LightMode()</span></code> 设备灯光模式模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备灯光情景模式模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JL_LightSceneMode()</span></code> 设备灯光情景模式模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备Flash操作模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_Flash()</span></code> 设备Flash操作模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备耳机模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_Headset()</span></code> 设备耳机模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备Speex模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModel_SPEEX()</span></code> 设备Speex模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>设备智能免摘的耳机管理模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelSmartPickFree()</span></code> 设备智能免摘的耳机管理模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>TWS场景降噪模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelSceneNoiseReduction()</span></code> TWS场景降噪模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>TWS风噪检测模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelNoiseDetection()</span></code> TWS风噪检测模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>TWS人声增强模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelVocalBoost()</span></code> TWS人声增强模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>模式使能位的模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelDevFunc()</span></code> 模式使能位的模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>存储管理的模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelCardInfo()</span></code> 存储管理的模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>文件结构的模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelFileStruct()</span></code> 文件结构的模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Spdif的模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelSPdif()</span></code> Spdif的模型</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PC模式的模型</dt><dd><ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">JLModelPCServer()</span></code> PC模式的模型</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<section id="id3">
<h3>2.1.1 请求设备信息<a class="headerlink" href="#id3" title="永久链接至标题"></a></h3>
<p>获取设备的基础信息，包括设备电量、设备各个模块状态、所处模式等。</p>
<p>示例代码：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="cm">/*--- 获取设备信息 ---*/</span><span class="w"></span>
<span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdTargetFeatureResult</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">elf</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;设备信息：%@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">device</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>2.1.2 查询设备系统信息<a class="headerlink" href="#id4" title="永久链接至标题"></a></h3>
<p>获取设备系统的信息内容，为后续操作提供基础信息。</p>
<p>示例代码：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*--- 查询设备系统信息 ---*/</span><span class="w"></span>
<span class="p">[</span><span class="n">wSelf</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetSystemInfo</span><span class="o">:</span><span class="n">JL_FunctionCodeCOMMON</span><span class="w"></span>
<span class="w">                                         </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">JLModel_SystemInfo</span><span class="w"> </span><span class="o">*</span><span class="n">systemInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">elf</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputSystemInfoModel</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;设备系统信息：%@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">systemInfo</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>2.1.3 监听设备状态信息<a class="headerlink" href="#id5" title="永久链接至标题"></a></h3>
<p>对于设备的状态信息变化，可通过KVO监听设备的状态信息变化，并获取设备的状态信息。</p>
<p>示例代码：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*--- 监听设备状态信息 ---*/</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">addNote</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">JLModel_Device</span><span class="w"> </span><span class="n">observeModelProperty</span><span class="o">:</span><span class="s">@&quot;currentFunc&quot;</span><span class="w"> </span><span class="n">Action</span><span class="o">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">noteCurrentFunction</span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="n">Own</span><span class="o">:</span><span class="nb">self</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">noteCurrentFunction:</span><span class="p">(</span><span class="bp">NSNotification</span><span class="o">*</span><span class="p">)</span><span class="nv">note</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">BOOL</span><span class="w"> </span><span class="n">isOK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">isCurrentDeviceCmd</span><span class="o">:</span><span class="n">note</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isOK</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NO</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">devel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">devel</span><span class="p">.</span><span class="n">currentFunc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_FunctionCodeBT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;关闭手机所有音乐.&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>2.1.4 切换设备模式<a class="headerlink" href="#id6" title="永久链接至标题"></a></h3>
<p>示例代码：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="cm">/*--- 切换设备模式 ---*/</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">changeDeviceMode:</span><span class="p">(</span><span class="n">JL_FunctionCode</span><span class="p">)</span><span class="nv">code</span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdFunction</span><span class="o">:</span><span class="n">JL_FunctionCodeCOMMON</span><span class="w"> </span><span class="n">Command</span><span class="o">:</span><span class="n">code</span><span class="w"> </span><span class="n">Extend</span><span class="o">:</span><span class="mh">0x00</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_FunctionCodeBT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">             </span><span class="n">LocalMusicVC</span><span class="w"> </span><span class="o">*</span><span class="n">vc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">LocalMusicVC</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"></span>
<span class="w">             </span><span class="n">vc</span><span class="p">.</span><span class="n">modalPresentationStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UIModalPresentationFullScreen</span><span class="p">;</span><span class="w"></span>
<span class="w">             </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">presentViewController</span><span class="o">:</span><span class="n">vc</span><span class="w"> </span><span class="n">animated</span><span class="o">:</span><span class="nb">YES</span><span class="w"> </span><span class="n">completion</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_FunctionCodeFM</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetSystemInfo</span><span class="o">:</span><span class="n">JL_FunctionCodeFM</span><span class="w"> </span><span class="n">Result</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"></span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_FunctionCodeFMTX</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetSystemInfo</span><span class="o">:</span><span class="n">JL_FunctionCodeFMTX</span><span class="w"> </span><span class="n">Result</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"></span>
<span class="w">     </span><span class="p">}];</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id7">
<h2>2.2 音量控制功能<a class="headerlink" href="#id7" title="永久链接至标题"></a></h2>
<section id="id8">
<h3>2.2.1 设备音量设置<a class="headerlink" href="#id8" title="永久链接至标题"></a></h3>
</section>
<section id="id9">
<h3>2.2.2 示例代码<a class="headerlink" href="#id9" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mSystemVolume</span><span class="w"> </span><span class="n">cmdSetSystemVolume</span><span class="o">:</span><span class="mi">10</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusFail</span><span class="p">){</span><span class="w"></span>
<span class="w">         </span><span class="c1">//[DFUITools showText:kJL_TXT(&quot;settings_failed&quot;) onView:self delay:1.0];</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id10">
<h2>2.3 设备音乐控制<a class="headerlink" href="#id10" title="永久链接至标题"></a></h2>
<section id="id11">
<h3>2.3.1 功能描述<a class="headerlink" href="#id11" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>当设备处于播放SD卡或U盘/TF卡时，手机端进行控制时用到</p>
</div></blockquote>
</section>
<section id="id12">
<h3>2.3.2 示例代码<a class="headerlink" href="#id12" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mMusicControlManager</span><span class="w"> </span><span class="n">cmdFastPlay</span><span class="o">:</span><span class="n">JL_FCmdMusicFastBack</span><span class="w"></span>
<span class="w">                                         </span><span class="nl">Second</span><span class="p">:(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="n">fabsf</span><span class="p">((</span><span class="n">pg</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">f_tott</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_curt</span><span class="p">))</span><span class="w"></span>
<span class="w">                                         </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="c1">//progress_sec = (int)(f_tott*pg);</span>
<span class="w">     </span><span class="c1">//NSLog(@&quot;---------------&gt; To Progress Second: %d&quot;,progress_sec);</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sv_tott</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="p">[</span><span class="n">JL_Tools</span><span class="w"> </span><span class="n">delay</span><span class="o">:</span><span class="mf">0.6</span><span class="w"> </span><span class="n">Task</span><span class="o">:^</span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;----&gt; delay get music progess 0&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">             </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">getDeviceMusicProgress</span><span class="p">];</span><span class="w"></span>
<span class="w">         </span><span class="p">}];</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">getDeviceMusicProgress</span><span class="p">];</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id13">
<h3>2.3.3 相关接口<a class="headerlink" href="#id13" title="永久链接至标题"></a></h3>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="n">NS_ENUM</span><span class="p">(</span><span class="kt">UInt8</span><span class="p">,</span><span class="w"> </span><span class="n">JL_FCmdMusic</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_FCmdMusicPP</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="c1">//PP按钮</span>
<span class="w">    </span><span class="n">JL_FCmdMusicPREV</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="c1">//上一曲</span>
<span class="w">    </span><span class="n">JL_FCmdMusicNEXT</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="c1">//下一曲</span>
<span class="w">    </span><span class="n">JL_FCmdMusicMODE</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="c1">//切换播放模式</span>
<span class="w">    </span><span class="n">JL_FCmdMusicEQ</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="c1">//EQ</span>
<span class="w">    </span><span class="n">JL_FCmdMusicFastBack</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="c1">//快退</span>
<span class="w">    </span><span class="n">JL_FCmdMusicFastPlay</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x07</span><span class="p">,</span><span class="w"> </span><span class="c1">//快进</span>
<span class="p">};</span><span class="w"></span>


<span class="n">NS_ASSUME_NONNULL_BEGIN</span><span class="w"></span>

<span class="k">@interface</span> <span class="nc">JL_MusicControlManager</span> : <span class="nc">JL_FunctionBaseManager</span><span class="w"></span>

<span class="cp">#pragma mark ---&gt; 设置播放模式</span>
<span class="cm">/**</span>
<span class="cm"> @param mode 模式</span>
<span class="cm"> 0x01:全部循环; 0x02:设备循环; 0x03:单曲循环; 0x04:随机播放; 0x05:文件夹循环</span>
<span class="cm"> */</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetSystemPlayMode:</span><span class="p">(</span><span class="n">JL_MusicMode</span><span class="p">)</span><span class="nv">mode</span><span class="p">;</span><span class="w"> </span><span class="c1">// 该接口已废弃</span>

<span class="cp">#pragma mark ---&gt; 快进快退</span>
<span class="cm">/**</span>
<span class="cm"> @param cmd 快进或者快退枚举</span>
<span class="cm"> @param sec 时间</span>
<span class="cm"> @param result 返回结果</span>
<span class="cm"> */</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdFastPlay:</span><span class="p">(</span><span class="n">JL_FCmdMusic</span><span class="p">)</span><span class="nv">cmd</span><span class="w"></span>
<span class="w">            </span><span class="nl">Second</span><span class="p">:(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="nv">sec</span><span class="w"></span>
<span class="w">            </span><span class="nl">Result</span><span class="p">:(</span><span class="n">JL_CMD_RESPOND</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"> </span><span class="c1">// 该接口已废弃</span>

<span class="k">@end</span><span class="w"></span>
</pre></div>
</div>
<p>为推行更方便使用的API，当前类将会被废弃，使用新的类： <strong>JLDevPlayerCtrl</strong> 来接替；
区别在于当前类是存在于 <cite>JL_ManagerM</cite> 类初始化生成而， <cite>JLDevPlayerCtrl</cite> 则是基于实例类，在开发者有需要时即时生成。</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 播放器回调</span>
<span class="k">@protocol</span> <span class="nc">JLDevPlayerCtrlDelegate</span><span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span><span class="w"></span>

<span class="c1">/// 播放状态</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - ctrl: 播放器</span>
<span class="c1">///   - playMode: 播放模式</span>
<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">jlDevPlayerCtrl</span><span class="o">:</span><span class="p">(</span><span class="n">JLDevPlayerCtrl</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">ctrl</span><span class="w"> </span><span class="n">playMode</span><span class="o">:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">playMode</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 播放状态回调</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - ctrl: 播放器</span>
<span class="c1">///   - status: 播放状态</span>
<span class="c1">///   - card: 当前播放的设备</span>
<span class="c1">///   - time: 当前播放的时间</span>
<span class="c1">///   - total: 总时长</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">jlDevPlayerCtrl:</span><span class="p">(</span><span class="n">JLDevPlayerCtrl</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">ctrl</span><span class="w"> </span><span class="nf">playStatus:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">status</span><span class="w"> </span><span class="nf">currentCard:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">card</span><span class="w"> </span><span class="nf">currentTime:</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="nv">time</span><span class="w"> </span><span class="nf">tolalTime:</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="nv">total</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 播放文件回调</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - ctrl: 播放器</span>
<span class="c1">///   - name: 文件名</span>
<span class="c1">///   - clus: 文件簇号</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">jlDevPlayerCtrl:</span><span class="p">(</span><span class="n">JLDevPlayerCtrl</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">ctrl</span><span class="w"> </span><span class="nf">fileName:</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">name</span><span class="w"> </span><span class="nf">currentClus:</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="nv">clus</span><span class="p">;</span><span class="w"></span>

<span class="k">@end</span><span class="w"></span>


<span class="c1">/// 设备播放器管理类</span>
<span class="k">@interface</span> <span class="nc">JLDevPlayerCtrl</span> : <span class="nc">JLCmdBasic</span><span class="w"></span>

<span class="c1">/// 播放状态</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">playStatus</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 当前播放的设备</span>
<span class="c1">/// 0x00 : USB</span>
<span class="c1">/// 0x01 : SD_0</span>
<span class="c1">/// 0x02 : SD_1</span>
<span class="c1">/// 0x03 : FLASH</span>
<span class="c1">/// 0x04 : LineIn</span>
<span class="c1">/// 0x05 : FLASH2</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">currentCard</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 当前播放时间</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">currentTime</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 歌曲总时长</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">tolalTime</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 当前播放文件名</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">strong</span><span class="p">)</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">fileName</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 当前播放文件的簇号</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">currentClus</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 当前播放模式</span>
<span class="c1">///  0x01:全部循环;</span>
<span class="c1">///  0x02:设备循环;</span>
<span class="c1">///  0x03:单曲循环;</span>
<span class="c1">///  0x04:随机播放;</span>
<span class="c1">///  0x05:文件夹循环</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">playMode</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 代理</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">weak</span><span class="p">)</span><span class="kt">id</span><span class="o">&lt;</span><span class="n">JLDevPlayerCtrlDelegate</span><span class="o">&gt;</span><span class="w"> </span><span class="n">delegate</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 操控设备播放器设置</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - cmd: 操作命令</span>
<span class="c1">///    0x01：PP按钮</span>
<span class="c1">///    0x02：上一曲</span>
<span class="c1">///    0x03：下一曲</span>
<span class="c1">///    0x04：切换播放模式(当前播放模式：不可指定，设备播放模式自增）</span>
<span class="c1">///    0x05：EQ</span>
<span class="c1">///    0x06：快退</span>
<span class="c1">///    0x07：快进</span>
<span class="c1">///   - sec: 时间（当快进/快退时需要，其他功能时值为0）</span>
<span class="c1">///   - manager: 设备对象</span>
<span class="c1">///   - result: 返回结果</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdPlayerCtrl:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">cmd</span><span class="w"></span>
<span class="w">            </span><span class="nl">Second</span><span class="p">:(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="nv">sec</span><span class="w"></span>
<span class="w">            </span><span class="nl">Manager</span><span class="p">:(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"></span>
<span class="w">            </span><span class="nl">Result</span><span class="p">:(</span><span class="n">JL_CMD_RESPOND</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id14">
<h4>2.3.3.1 使用范例<a class="headerlink" href="#id14" title="永久链接至标题"></a></h4>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="p">@</span><span class="n">objcMembers</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">MediasFuncsView</span><span class="o">:</span><span class="w"> </span><span class="n">JLDevPlayerCtrlDelegate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">private</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="n">devCtrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JLDevPlayerCtrl</span><span class="p">()</span><span class="w"></span>
<span class="w">      </span><span class="n">devCtrl</span><span class="p">.</span><span class="n">delegate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="w"></span>

<span class="w">      </span><span class="n">func</span><span class="w"> </span><span class="n">jlDevPlayerCtrl</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="n">ctrl</span><span class="o">:</span><span class="w"> </span><span class="n">JLDevPlayerCtrl</span><span class="p">,</span><span class="w"> </span><span class="n">playMode</span><span class="o">:</span><span class="w"> </span><span class="kt">UInt8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;playMode:\(playMode)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>

<span class="w">      </span><span class="n">func</span><span class="w"> </span><span class="n">jlDevPlayerCtrl</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="n">ctrl</span><span class="o">:</span><span class="w"> </span><span class="n">JLDevPlayerCtrl</span><span class="p">,</span><span class="w"> </span><span class="n">playStatus</span><span class="w"> </span><span class="n">status</span><span class="o">:</span><span class="w"> </span><span class="kt">UInt8</span><span class="p">,</span><span class="w"> </span><span class="n">currentCard</span><span class="w"> </span><span class="n">card</span><span class="o">:</span><span class="w"> </span><span class="kt">UInt8</span><span class="p">,</span><span class="w"> </span><span class="n">currentTime</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="kt">UInt32</span><span class="p">,</span><span class="w"> </span><span class="n">tolalTime</span><span class="w"> </span><span class="n">total</span><span class="o">:</span><span class="w"> </span><span class="kt">UInt32</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="n">guard</span><span class="w"> </span><span class="n">let</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JL_RunSDK</span><span class="p">.</span><span class="n">sharedMe</span><span class="p">().</span><span class="n">mBleEntityM</span><span class="o">?</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">getDeviceModel</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="p">{</span><span class="k">return</span><span class="p">}</span><span class="w"></span>
<span class="w">       </span><span class="nb">self</span><span class="p">.</span><span class="n">updateWith</span><span class="p">(</span><span class="n">model</span><span class="o">:</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>

<span class="w">     </span><span class="n">func</span><span class="w"> </span><span class="n">jlDevPlayerCtrl</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="n">ctrl</span><span class="o">:</span><span class="w"> </span><span class="n">JLDevPlayerCtrl</span><span class="p">,</span><span class="w"> </span><span class="n">fileName</span><span class="w"> </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">currentClus</span><span class="w"> </span><span class="n">clus</span><span class="o">:</span><span class="w"> </span><span class="kt">UInt32</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;fileName:\(fileName)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;currentClus:\(currentClus)&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">//设备播放器管理类的属性，都是通过固件的更新的命令，获取相应更新的值。</span>
<span class="w">    </span><span class="n">JLDevPlayerCtrl</span><span class="w"> </span><span class="o">*</span><span class="n">devPlayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JLDevPlayerCtrl</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">IBAction</span><span class="p">)</span><span class="n">actionMode</span><span class="o">:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">sender</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w">     </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">getDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">currentFunc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_FunctionCodeMUSIC</span><span class="p">){</span><span class="w"></span>
<span class="w">       </span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="p">[</span><span class="n">devPlayer</span><span class="w"> </span><span class="n">cmdPlayerCtrl</span><span class="o">:</span><span class="mh">0x04</span><span class="w"> </span><span class="n">Second</span><span class="o">:</span><span class="mi">0</span><span class="w"> </span><span class="n">Manager</span><span class="o">:</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="p">}];</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id15">
<h2>2.4 均衡器调试功能<a class="headerlink" href="#id15" title="永久链接至标题"></a></h2>
<section id="id16">
<h3>2.4.1 功能描述<a class="headerlink" href="#id16" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>均衡器调试功能，对设备的EQ进行设置</p>
</div></blockquote>
</section>
<section id="id17">
<h3>2.4.2 示例代码<a class="headerlink" href="#id17" title="永久链接至标题"></a></h3>
<section id="eq">
<h4>2.4.2.1 系统EQ调试<a class="headerlink" href="#eq" title="永久链接至标题"></a></h4>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">///  当前EQ模式</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JL_EQMode</span><span class="w"> </span><span class="n">eqMode</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// EQ段数类型</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JL_EQType</span><span class="w"> </span><span class="n">eqType</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// EQ参数值</span>
<span class="c1">/// （只适用于EQ Mode == CUSTOM情况）</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="w">  </span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">eqArray</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 自定义 EQ数组</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="w">  </span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">eqCustomArray</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// EQ频率</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="w">  </span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">eqFrequencyArray</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// EQ的预设值数组</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">JLModel_EQ</span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">eqDefaultArray</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">  设置系统EQ</span>
<span class="cm">  @param eqMode EQ模式</span>
<span class="cm">  @param params EQ参数(10个参数,仅适用于JL_EQModeCUSTOM情况)</span>
<span class="cm">  */</span><span class="w"></span>
<span class="w">  </span><span class="o">+</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">cmdSetSystemEQ</span><span class="o">:</span><span class="p">(</span><span class="n">JL_EQMode</span><span class="p">)</span><span class="n">eqMode</span><span class="w"> </span><span class="n">Params</span><span class="o">:</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">*</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="n">params</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="c1">/// 查询系统EQ内容</span>
<span class="w">  </span><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">cmdGetSystemEQ</span><span class="o">:</span><span class="p">(</span><span class="n">JLSystemEQResult</span><span class="p">)</span><span class="n">result</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="c1">///  当前EQ模式</span>
<span class="w">   </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JL_EQMode</span><span class="w"> </span><span class="n">eqMode</span><span class="p">;</span><span class="w"></span>

<span class="w">   </span><span class="c1">/// EQ段数类型</span>
<span class="w">   </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JL_EQType</span><span class="w"> </span><span class="n">eqType</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id18">
<h4>2.4.2.2 设置混响/限幅<a class="headerlink" href="#id18" title="永久链接至标题"></a></h4>
<p>设置混响以及限幅值时需要先判断设备是否支持。</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="c1">//0:支持混响和限幅器 1：只支持混响 2：只支持限幅器</span>
<span class="k">if</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">reverberationTypes</span><span class="p">.</span><span class="n">count</span><span class="o">==</span><span class="mi">2</span><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="n">reverberationTypes</span><span class="w"> </span><span class="n">containsObject</span><span class="o">:</span><span class="l">@(</span><span class="n">JL_ReverberationAndDynamicType</span><span class="l">)</span><span class="p">]</span><span class="w"> </span><span class="c1">//支持混响和限幅器</span>
<span class="w">   </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="n">reverberationTypes</span><span class="w"> </span><span class="n">containsObject</span><span class="o">:</span><span class="l">@(</span><span class="mi">1</span><span class="l">)</span><span class="p">]){</span><span class="w"></span>
<span class="w">    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">if</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">reverberationTypes</span><span class="p">.</span><span class="n">count</span><span class="o">==</span><span class="mi">1</span><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="n">reverberationTypes</span><span class="w"> </span><span class="n">containsObject</span><span class="o">:</span><span class="l">@(</span><span class="n">JL_OnlyReverberationType</span><span class="l">)</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="c1">//只支持混响</span>
<span class="w">    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">if</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">reverberationTypes</span><span class="p">.</span><span class="n">count</span><span class="o">==</span><span class="mi">1</span><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="n">reverberationTypes</span><span class="w"> </span><span class="n">containsObject</span><span class="o">:</span><span class="l">@(</span><span class="n">JL_OnlyDynamicLimiterType</span><span class="l">)</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="c1">//只支持限幅器</span>
<span class="w">    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p><cite>JL_BinChargeManager</cite> 使用的接口如下：</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 设置混响值</span>
<span class="c1">/// @param depthValue 深度 0-100</span>
<span class="c1">/// @param intensityValue 强度 0-100</span>
<span class="c1">/// @param dynamicLimiterValue 动态限幅值 -60 - 0</span>
<span class="c1">/// @param reverOn 是否开启</span>
<span class="c1">/// @param type 混响类型</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetReverberation:</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nv">depthValue</span><span class="w"></span>
<span class="w">            </span><span class="nl">IntensityValue</span><span class="p">:(</span><span class="kt">int</span><span class="p">)</span><span class="nv">intensityValue</span><span class="w"></span>
<span class="w">    </span><span class="nl">DynamicLimiterValue</span><span class="p">:(</span><span class="kt">int</span><span class="p">)</span><span class="nv">dynamicLimiterValue</span><span class="w"></span>
<span class="w">        </span><span class="nl">SwtichReverState</span><span class="p">:(</span><span class="kt">int</span><span class="p">)</span><span class="nv">reverOn</span><span class="w"></span>
<span class="w">                </span><span class="nl">FunType</span><span class="p">:(</span><span class="n">JL_ReverberationFunType</span><span class="p">)</span><span class="nv">type</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id19">
<h4>2.4.2.3 使用范例<a class="headerlink" href="#id19" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// 设置系统EQ</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetSystemEQ</span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">eqArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="l">@(</span><span class="mi">2</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">3</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">2</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">2</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">8</span><span class="l">)</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mSystemEQ</span><span class="w"> </span><span class="n">cmdSetSystemEQ</span><span class="o">:</span><span class="n">JL_EQModeCUSTOM</span><span class="w"> </span><span class="n">Params</span><span class="o">:</span><span class="n">eqArray</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 查询系统EQ内容</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdGetSystemEQ</span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="w">     </span><span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mSystemEQ</span><span class="w"> </span><span class="n">cmdGetSystemEQ</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">JL_SystemEQ</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="p">}];</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="c1">// 设置混响值</span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">depthValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"> </span><span class="c1">//范围是0到100</span>
<span class="kt">int</span><span class="w"> </span><span class="n">intensityValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">70</span><span class="p">;</span><span class="w"> </span><span class="c1">//范围是0到100</span>
<span class="kt">int</span><span class="w"> </span><span class="n">dynamicLimiterValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-30</span><span class="p">;</span><span class="w"> </span><span class="c1">//范围是-60到0</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">switchState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NO</span><span class="p">;</span><span class="w"> </span><span class="c1">//混响的开关</span>
<span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JL_OnlyReverberationType</span><span class="w"> </span><span class="c1">//支持JL_ReverberationAndDynamicType、JL_OnlyReverberationType、JL_OnlyDynamicLimiterType三种类型</span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mChargingBinManager</span><span class="w"> </span><span class="n">cmdSetReverberation</span><span class="o">:</span><span class="p">[</span><span class="n">depthValue</span><span class="p">]</span><span class="w"></span>
<span class="w">                                      </span><span class="nl">IntensityValue</span><span class="p">:[</span><span class="n">intensityValue</span><span class="p">]</span><span class="w"></span>
<span class="w">                                 </span><span class="nl">DynamicLimiterValue</span><span class="p">:[</span><span class="n">dynamicLimiterValue</span><span class="p">]</span><span class="w"></span>
<span class="w">                                    </span><span class="nl">SwtichReverState</span><span class="p">:</span><span class="n">switchState</span><span class="w"> </span><span class="n">FunType</span><span class="o">:</span><span class="n">type</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id20">
<h2>2.5 时钟功能<a class="headerlink" href="#id20" title="永久链接至标题"></a></h2>
<section id="id21">
<h3>2.5.1 功能描述<a class="headerlink" href="#id21" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>同步闹钟设备、管理闹钟包括：读取、修改、删除</p>
</div></blockquote>
</section>
<section id="demo">
<h3>2.5.2 使用demo<a class="headerlink" href="#demo" title="永久链接至标题"></a></h3>
<section id="id22">
<h4>2.5.2.1 同步时间<a class="headerlink" href="#id22" title="永久链接至标题"></a></h4>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//在JLManagerM -&gt; JL_SystemTime -&gt; cmdSetSystemTime</span>
<span class="w"> </span><span class="cm">/*--- 同步时间戳 ----*/</span><span class="w"></span>
<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;---&gt;(2) SET Device time.&quot;</span><span class="p">);</span><span class="w"></span>
<span class="bp">NSDate</span><span class="w"> </span><span class="o">*</span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSDate</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="n">JL_SystemTime</span><span class="w"> </span><span class="o">*</span><span class="n">systemTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mSystemTime</span><span class="p">;</span><span class="w"></span>
<span class="p">[</span><span class="n">systemTime</span><span class="w"> </span><span class="n">cmdSetSystemTime</span><span class="o">:</span><span class="n">date</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id23">
<h4>2.5.2.2 读取闹钟<a class="headerlink" href="#id23" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetSystemInfo</span><span class="o">:</span><span class="n">JL_FunctionCodeRTC</span><span class="w"> </span><span class="n">SelectionBit</span><span class="o">:</span><span class="mh">0xF2</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//TODO: do something...</span>
<span class="w">    </span><span class="c1">//拿到的itemArray去做闹钟列表的数据展示</span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id24">
<h4>2.5.2.3 修改闹钟<a class="headerlink" href="#id24" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>

<span class="c1">//新建一个闹钟</span>
<span class="n">JLModel_RTC</span><span class="w"> </span><span class="o">*</span><span class="n">rtcmodel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLModel_RTC</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;闹钟&quot;</span><span class="p">);</span><span class="w"></span>
<span class="bp">NSDateFormatter</span><span class="w"> </span><span class="o">*</span><span class="n">formatter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSDateFormatter</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="n">formatter</span><span class="p">.</span><span class="n">dateFormat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;yyyy:MM:DD:HH:mm:ss&quot;</span><span class="p">;</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">nowStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">formatter</span><span class="w"> </span><span class="n">stringFromDate</span><span class="o">:</span><span class="p">[</span><span class="bp">NSDate</span><span class="w"> </span><span class="n">new</span><span class="p">]];</span><span class="w"></span>
<span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">timeArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">nowStr</span><span class="w"> </span><span class="n">componentsSeparatedByString</span><span class="o">:</span><span class="s">@&quot;:&quot;</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">timeArr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcMonth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">timeArr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcDay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">timeArr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcHour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">timeArr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">timeArr</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcSec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">timeArr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00</span><span class="p">;</span><span class="c1">//响铃类型</span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcEnable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">YES</span><span class="p">;</span><span class="w"></span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//当前闹钟编号</span>

<span class="c1">//一般而言可以通过上述的读取闹钟方法，获取到设备当前所有闹钟，然后根据对应的rtcIndex进行设置</span>
<span class="c1">//JLModel_RTC *rtcmodel = // cmdGetSystemInfo: SelectionBit: Result:</span>

<span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="c1">//获取设备属性详情</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">rtcDfRings</span><span class="p">.</span><span class="n">count</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="c1">//当设备支持自定义闹铃时</span>
<span class="w">    </span><span class="n">JLModel_Ring</span><span class="w"> </span><span class="o">*</span><span class="n">ring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="p">.</span><span class="n">rtcDfRings</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="c1">//设备所带默认闹铃声音</span>
<span class="w">    </span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">ringInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">RTC_RingInfo</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//闹铃类型：默认或自定义</span>
<span class="w">    </span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//铃声存放位置，详情可参考</span>
<span class="w">    </span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">clust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//自定义闹铃文件簇号</span>
<span class="w">    </span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">ring</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="n">dataUsingEncoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span><span class="c1">//铃声名字</span>
<span class="w">    </span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nb">self</span><span class="p">.</span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="c1">//铃声的名字文件长度</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="c1">//当前闹铃设置包含新增或修改一个/多个的闹铃</span>
<span class="w">   </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mAlarmClockManager</span><span class="w"> </span><span class="n">cmdRtcSetArray</span><span class="o">:</span><span class="l">@[</span><span class="n">rtcmodel</span><span class="l">]</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//TODO: 返回当前设备的闹铃个数，to do something...</span>
<span class="w">   </span><span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id25">
<h4>2.5.2.4 删除闹钟<a class="headerlink" href="#id25" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JLModel_RTC</span><span class="w"> </span><span class="o">*</span><span class="n">rtcmodel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//.... 通过获取设备闹钟得到某个闹钟</span>
<span class="c1">//JLModel_RTC</span>
<span class="kt">int</span><span class="w"> </span><span class="n">rtcIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcIndex</span><span class="p">;</span><span class="c1">//闹钟序号</span>
<span class="w">  </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mAlarmClockManager</span><span class="w"> </span><span class="n">cmdRtcDeleteIndexArray</span><span class="o">:</span><span class="l">@[@(</span><span class="n">rtcIndex</span><span class="l">)]</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">UInt8</span><span class="p">)[</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="c1">//TODO: do something...</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusFail</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="c1">//ERR: delete failed</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id26">
<h4>2.5.2.5 获取默认铃声选择列表<a class="headerlink" href="#id26" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">defaultRings</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">model</span><span class="p">.</span><span class="n">rtcDfRings</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id27">
<h4>2.5.2.6 闹钟铃声试听<a class="headerlink" href="#id27" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JLModel_RTC</span><span class="w"> </span><span class="o">*</span><span class="n">rtcmodel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLModel_RTC</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="c1">//构建或者从设备获取</span>
<span class="n">JLModel_Ring</span><span class="w"> </span><span class="o">*</span><span class="n">ring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//闹铃对象，通过获取默认或新建;</span>
<span class="n">rtcModel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//类型</span>
<span class="cm">/*</span>
<span class="cm">typedef NS_ENUM(UInt8, JL_CardType) {</span>
<span class="cm">    JL_CardTypeUSB                  = 0, //USB</span>
<span class="cm">    JL_CardTypeSD_0                 = 1, //SD_0</span>
<span class="cm">    JL_CardTypeSD_1                 = 2, //SD_1</span>
<span class="cm">    JL_CardTypeFLASH                = 3, //FLASH</span>
<span class="cm">    JL_CardTypeLineIn               = 4, //LineIn</span>
<span class="cm">    JL_CardTypeFLASH2               = 5, //FLASH2</span>
<span class="cm">};</span>
<span class="cm">*/</span><span class="w"></span>
<span class="n">rtcModel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JL_CardTypeUSB</span><span class="p">;</span><span class="c1">//响铃内容来自哪儿</span>
<span class="n">rtcModel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">clust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ring</span><span class="p">.</span><span class="n">index</span><span class="p">;</span><span class="c1">//文件簇号</span>
<span class="n">rtcModel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">ring</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="n">dataUsingEncoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span><span class="c1">//文件名</span>
<span class="n">rtcModel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtcModel</span><span class="p">.</span><span class="n">ringInfo</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="c1">//文件长度</span>

<span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mAlarmClockManager</span><span class="w"> </span><span class="n">cmdRtcAudition</span><span class="o">:</span><span class="n">rtcModel</span><span class="w"> </span><span class="n">Option</span><span class="o">:</span><span class="nb">YES</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id28">
<h4>2.5.2.7 停止铃声试听<a class="headerlink" href="#id28" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mAlarmClockManager</span><span class="w"> </span><span class="n">cmdRtcStopResult</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id29">
<h4>2.5.2.8 获取闹铃模式设置<a class="headerlink" href="#id29" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">JLModel_AlarmSetting</span> : <span class="bp">NSObject</span><span class="w"></span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">index</span><span class="p">;</span><span class="w">       </span><span class="c1">//Index of the alarm clock</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">isCount</span><span class="p">;</span><span class="w">     </span><span class="c1">//Whether the [alarm times] can be set</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w">       </span><span class="c1">//The alarm number</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">isInterval</span><span class="p">;</span><span class="w">  </span><span class="c1">//Whether the [time interval] can be set</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">interval</span><span class="p">;</span><span class="w">    </span><span class="c1">//The time interval</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">isTime</span><span class="p">;</span><span class="w">      </span><span class="c1">//Whether the [time length] can be set</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">time</span><span class="p">;</span><span class="w">        </span><span class="c1">//Length of time</span>
<span class="p">-(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nf">dataModel</span><span class="p">;</span><span class="w"></span>
<span class="k">@end</span><span class="w"></span>

<span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">getAlarmModelSetting</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">mCmdManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="c1">// 是否支持闹钟设置</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">rtcAlarmType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">YES</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">//itemArray是指从读取闹钟里获取到闹钟列表</span>
<span class="w">      </span><span class="n">JLModel_RTC</span><span class="w"> </span><span class="o">*</span><span class="n">rtcModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itemArray</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w">      </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">bit_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">rtcModel</span><span class="p">.</span><span class="n">rtcIndex</span><span class="p">;</span><span class="w"></span>
<span class="cm">/**</span>
<span class="cm"> @param operate 0x00:读取 0x01:设置</span>
<span class="cm"> @param index  掩码</span>
<span class="cm">//Bit0：闹钟0</span>
<span class="cm">//Bit1：闹钟1</span>
<span class="cm">//Bit1：闹钟2</span>
<span class="cm">//Bit1：闹钟3</span>
<span class="cm">//Bit1：闹钟4</span>
<span class="cm">如下所示：</span>
<span class="cm">0b0000 0001：设置闹钟0</span>
<span class="cm">0b0000 0011：设置闹钟0和闹钟1（其他同理）</span>
<span class="cm">当如要设置0 3 4闹钟，则index= 0x19</span>
<span class="cm">如要设置1 2 闹钟，则index = 0x06</span>
<span class="cm"> @param setting 设置选项，读取时无需传入</span>
<span class="cm"> @param result 回复</span>
<span class="cm"> */</span><span class="w"></span>
<span class="p">[</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mAlarmClockManager</span><span class="w"> </span><span class="n">cmdRtcOperate</span><span class="o">:</span><span class="n">JL_FlashOperateFlagRead</span><span class="w"> </span><span class="n">Index</span><span class="o">:</span><span class="n">bit_index</span><span class="w"> </span><span class="n">Setting</span><span class="o">:</span><span class="nb">nil</span><span class="w"></span>
<span class="w">                            </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLModel_AlarmSetting</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">flag</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="p">}];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id30">
<h4>2.5.2.9 设置闹铃模式<a class="headerlink" href="#id30" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">JLModel_RTC</span> : <span class="bp">NSObject</span><span class="w"></span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w">       </span><span class="n">rtcYear</span><span class="p">;</span><span class="w"> </span><span class="c1">//年</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">        </span><span class="n">rtcMonth</span><span class="p">;</span><span class="c1">//月</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">        </span><span class="n">rtcDay</span><span class="p">;</span><span class="w"> </span><span class="c1">//日</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">        </span><span class="n">rtcHour</span><span class="p">;</span><span class="c1">//时</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">        </span><span class="n">rtcMin</span><span class="p">;</span><span class="w"> </span><span class="c1">//分</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">        </span><span class="n">rtcSec</span><span class="p">;</span><span class="w"> </span><span class="c1">//秒</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">BOOL</span><span class="w">           </span><span class="n">rtcEnable</span><span class="p">;</span><span class="w"> </span><span class="c1">//开启关闭</span>
<span class="c1">//模式：</span>
<span class="cm">/*</span>
<span class="cm">情况1:</span>
<span class="cm">mode=0:只响一次</span>
<span class="cm">情况2:</span>
<span class="cm">Bit0:每天</span>
<span class="cm">Bit1：星期一</span>
<span class="cm">Bit2：星期二</span>
<span class="cm">Bit3：星期三</span>
<span class="cm">Bit4：星期四</span>
<span class="cm">Bit5：星期五</span>
<span class="cm">Bit6：星期六</span>
<span class="cm">Bit7：星期天</span>
<span class="cm">*/</span><span class="w"></span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">        </span><span class="n">rtcMode</span><span class="p">;</span><span class="w"></span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">        </span><span class="n">rtcIndex</span><span class="p">;</span><span class="w"> </span><span class="c1">//序号</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">copy</span><span class="w">  </span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSString</span><span class="w">       </span><span class="o">*</span><span class="n">rtcName</span><span class="p">;</span><span class="w"> </span><span class="c1">//名称</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">RTC_RingInfo</span><span class="w">   </span><span class="o">*</span><span class="n">ringInfo</span><span class="p">;</span><span class="c1">//详情</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSData</span><span class="w">         </span><span class="o">*</span><span class="n">RingData</span><span class="p">;</span><span class="c1">//响铃数据</span>
<span class="k">@end</span><span class="w"></span>

<span class="k">@interface</span> <span class="nc">RTC_RingInfo</span> : <span class="bp">NSObject</span><span class="w"></span>
<span class="c1">//类型：0 ：默认  1：外置</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"></span>
<span class="c1">//存放位置</span>
<span class="cm">/*</span>
<span class="cm">typedef NS_ENUM(UInt8, JL_CardType) {</span>
<span class="cm">    JL_CardTypeUSB                  = 0, //USB</span>
<span class="cm">    JL_CardTypeSD_0                 = 1, //SD_0</span>
<span class="cm">    JL_CardTypeSD_1                 = 2, //SD_1</span>
<span class="cm">    JL_CardTypeFLASH                = 3, //FLASH</span>
<span class="cm">    JL_CardTypeLineIn               = 4, //LineIn</span>
<span class="cm">    JL_CardTypeFLASH2               = 5, //FLASH2</span>
<span class="cm">};</span>
<span class="cm">*/</span><span class="w"></span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">  </span><span class="n">dev</span><span class="p">;</span><span class="w"></span>
<span class="c1">//文件簇号</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">clust</span><span class="p">;</span><span class="w"></span>
<span class="c1">//铃声名字长度</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"></span>
<span class="c1">//铃声名字内容</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="k">@end</span><span class="w"></span>

<span class="c1">//响铃周期模式设置</span>
<span class="o">-</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">rtcmode</span><span class="p">{</span><span class="w"></span>
<span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">@[</span><span class="mi">@1</span><span class="p">,</span><span class="mi">@3</span><span class="p">,</span><span class="mi">@5</span><span class="l">]</span><span class="p">;</span><span class="w"></span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">array</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">num</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">num</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">tmp_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">|</span><span class="n">tmp_n</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">mode</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">//新建闹钟</span>
<span class="n">JLModel_RTC</span><span class="w"> </span><span class="o">*</span><span class="n">rtcmodel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLModel_RTC</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="c1">//响铃周期模式设置</span>
<span class="n">rtcmodel</span><span class="p">.</span><span class="n">rtcMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">rtcmode</span><span class="p">];</span><span class="w"></span>
<span class="c1">//接口声明</span>
<span class="cp">#pragma mark ---&gt; 闹铃设置</span>
<span class="cm">/**</span>
<span class="cm"> @param operate 0x00:读取 0x01:设置</span>
<span class="cm"> @param index 掩码</span>
<span class="cm">//Bit0：闹钟0</span>
<span class="cm">//Bit1：闹钟1</span>
<span class="cm">//Bit1：闹钟2</span>
<span class="cm">//Bit1：闹钟3</span>
<span class="cm">//Bit1：闹钟4</span>
<span class="cm">如下所示：</span>
<span class="cm">0b0000 0001：设置闹钟0</span>
<span class="cm">0b0000 0011：设置闹钟0和闹钟1（其他同理）</span>
<span class="cm">当如要设置0 3 4闹钟，则index= 0x19</span>
<span class="cm">如要设置1 2 闹钟，则index = 0x06</span>
<span class="cm"> @param setting 设置选项，读取时无需传入</span>
<span class="cm"> @param result 回复</span>
<span class="cm"> */</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdRtcOperate:</span><span class="p">(</span><span class="n">JL_RtcOperate</span><span class="p">)</span><span class="nv">operate</span><span class="w"></span>
<span class="w">               </span><span class="nl">Index</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">index</span><span class="w"></span>
<span class="w">               </span><span class="nl">Setting</span><span class="p">:(</span><span class="n">JLModel_AlarmSetting</span><span class="o">*</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">setting</span><span class="w"></span>
<span class="w">               </span><span class="nl">Result</span><span class="p">:(</span><span class="n">JL_RTC_ALARM_BK</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setRingModel</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="c1">//可以新建</span>
<span class="w">    </span><span class="n">JLModel_AlarmSetting</span><span class="w"> </span><span class="o">*</span><span class="n">setting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLModel_AlarmSetting</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">setting</span><span class="p">.</span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">index</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">setting</span><span class="p">.</span><span class="n">isCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">setting</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mCount</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">setting</span><span class="p">.</span><span class="n">isInterval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">setting</span><span class="p">.</span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mInterval</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">setting</span><span class="p">.</span><span class="n">isTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">setting</span><span class="p">.</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mTime</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//也可以通过上面的方式获取闹铃模式后，使用该模式进行设置</span>

<span class="w">    </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;闹钟Index ---&gt; %d count:%d interval:%d time:%d&quot;</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">mCount</span><span class="p">,</span><span class="n">mInterval</span><span class="p">,</span><span class="n">mTime</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mAlarmClockManager</span><span class="w"> </span><span class="n">cmdRtcOperate</span><span class="o">:</span><span class="n">JL_FlashOperateFlagWrite</span><span class="w"> </span><span class="n">Index</span><span class="o">:</span><span class="n">index</span><span class="w"> </span><span class="n">Setting</span><span class="o">:</span><span class="n">setting</span><span class="w"></span>
<span class="w">                               </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLModel_AlarmSetting</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">flag</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">flag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;设置闹钟成功&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id31">
<h4>2.5.2.10 闹钟正在响或则闹钟停止响<a class="headerlink" href="#id31" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">kJL_RTC_RINGING</span><span class="p">;</span><span class="w">       </span><span class="c1">//闹钟正在响</span>
<span class="k">extern</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">kJL_RTC_RINGSTOP</span><span class="p">;</span><span class="w">      </span><span class="c1">//闹钟停止响</span>
</pre></div>
</div>
</section>
<section id="id32">
<h4>2.5.2.11 停止闹钟响声回调<a class="headerlink" href="#id32" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">停止闹钟响声</span>
<span class="cm">@param result 回复</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdRtcStopResult:</span><span class="p">(</span><span class="n">JL_CMD_BK</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id33">
<h5>2.5.2.11.1 使用范例<a class="headerlink" href="#id33" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mAlarmClockManager</span><span class="w"> </span><span class="n">cmdRtcStopResult</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="id34">
<h2>2.6 外接设备控制功能<a class="headerlink" href="#id34" title="永久链接至标题"></a></h2>
<section id="id35">
<h3>2.6.1 功能描述<a class="headerlink" href="#id35" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>切换到Linein模式,以及LineIn模式下的操作</p>
</div></blockquote>
</section>
<section id="id36">
<h3>2.6.2 示例代码<a class="headerlink" href="#id36" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdFunction</span><span class="o">:</span><span class="n">JL_FunctionCodeCOMMON</span><span class="w"> </span><span class="n">Command</span><span class="o">:</span><span class="n">JL_FunctionCodeLINEIN</span><span class="w"> </span><span class="n">Extend</span><span class="o">:</span><span class="mh">0x00</span><span class="w"> </span><span class="n">Result</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"> </span><span class="c1">//切换到Linein模式</span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetSystemInfo</span><span class="o">:</span><span class="n">JL_FunctionCodeLINEIN</span><span class="w"> </span><span class="n">Result</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"> </span><span class="c1">//获取Linein模式下的信息</span>
<span class="c1">//设置Linein下的播放和暂停</span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdFunction</span><span class="o">:</span><span class="n">JL_FunctionCodeLINEIN</span><span class="w"> </span><span class="n">Command</span><span class="o">:</span><span class="n">JL_FCmdLineInPP</span><span class="w"> </span><span class="n">Extend</span><span class="o">:</span><span class="mi">0</span><span class="w"> </span><span class="n">Result</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id37">
<h3>2.6.3 注意事项<a class="headerlink" href="#id37" title="永久链接至标题"></a></h3>
<p>获取LineIn的状态，通过<strong>JL_ManagerM</strong>
的<strong>outputDeviceModel</strong>方法，其中的属性</p>
<p>/<em>— LineIn Info —</em>/</p>
<p><strong>&#64;property</strong> (<strong>assign</strong>,<strong>nonatomic</strong>) JL_LineInStatus lineInStatus;
//LineIn状态</p>
</section>
</section>
<section id="fm">
<h2>2.7 FM控制功能<a class="headerlink" href="#fm" title="永久链接至标题"></a></h2>
<section id="id38">
<h3>2.7.1 功能描述<a class="headerlink" href="#id38" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>控制固件收音机模块的相关操作<strong>FM相关操作</strong></p>
</div></blockquote>
</section>
<section id="id39">
<h3>2.7.2 相关接口<a class="headerlink" href="#id39" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="k">typedef</span><span class="w"> </span><span class="n">NS_ENUM</span><span class="p">(</span><span class="kt">UInt8</span><span class="p">,</span><span class="w"> </span><span class="n">JL_FCmdFM</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_FCmdFMPP</span><span class="w">                     </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="c1">//FM 暂停/播放</span>
<span class="w">    </span><span class="n">JL_FCmdFMPonitBefore</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="c1">//上一个频点</span>
<span class="w">    </span><span class="n">JL_FCmdFMPonitNext</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="c1">//下一个频点</span>
<span class="w">    </span><span class="n">JL_FCmdFMChannelBefore</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="c1">//上一个频道</span>
<span class="w">    </span><span class="n">JL_FCmdFMChannelNext</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="c1">//下一个频道</span>
<span class="w">    </span><span class="n">JL_FCmdFMSearch</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="c1">//扫描</span>
<span class="w">    </span><span class="n">JL_FCmdFMChannelSelect</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x07</span><span class="p">,</span><span class="w"> </span><span class="c1">//选择频道</span>
<span class="w">    </span><span class="n">JL_FCmdFMChannelDelete</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x08</span><span class="p">,</span><span class="w"> </span><span class="c1">//删除频道</span>
<span class="w">    </span><span class="n">JL_FCmdFMFrequencySelect</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x09</span><span class="p">,</span><span class="w"> </span><span class="c1">//选择频点</span>
<span class="w">    </span><span class="n">JL_FCmdFMFrequencyDelete</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0a</span><span class="p">,</span><span class="w"> </span><span class="c1">//删除频点</span>
<span class="p">};</span><span class="w"></span>

<span class="k">typedef</span><span class="w"> </span><span class="n">NS_ENUM</span><span class="p">(</span><span class="kt">UInt8</span><span class="p">,</span><span class="w"> </span><span class="n">JL_FMSearch</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_FMSearchALL</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="c1">//FM 暂停/播放</span>
<span class="w">    </span><span class="n">JL_FMSearchForward</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="c1">//向前搜索</span>
<span class="w">    </span><span class="n">JL_FMSearchBackward</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="c1">//向后搜索</span>
<span class="w">    </span><span class="n">JL_FMSearchStop</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="c1">//停止搜索</span>
<span class="p">};</span><span class="w"></span>

<span class="n">NS_ASSUME_NONNULL_BEGIN</span><span class="w"></span>

<span class="k">@interface</span> <span class="nc">JL_FmManager</span> : <span class="nc">JL_FunctionBaseManager</span><span class="w"></span>
<span class="w"> </span><span class="c1">///Fm状态</span>
<span class="w"> </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JL_FMStatus</span><span class="w">        </span><span class="n">fmStatus</span><span class="p">;</span><span class="w"></span>

<span class="w"> </span><span class="c1">///Fm 频段范围</span>
<span class="w"> </span><span class="c1">///76.5-108.0Mhz</span>
<span class="w"> </span><span class="c1">///87.5-108.0Mhz</span>
<span class="w"> </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JL_FMMode</span><span class="w">          </span><span class="n">fmMode</span><span class="p">;</span><span class="w"></span>

<span class="w"> </span><span class="c1">///当前fm</span>
<span class="w"> </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JLModel_FM</span><span class="w">          </span><span class="o">*</span><span class="n">currentFm</span><span class="p">;</span><span class="w"></span>

<span class="w"> </span><span class="c1">///Fm列表</span>
<span class="w"> </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSArray</span><span class="w">            </span><span class="o">*</span><span class="n">fmArray</span><span class="p">;</span><span class="w"></span>

<span class="w"> </span><span class="cp">#pragma mark ---&gt; FM相关操作</span>
<span class="w"> </span><span class="cm">/**</span>
<span class="cm"> @param cmd FM功能</span>
<span class="cm"> @param search FM搜索</span>
<span class="cm"> @param channel FM频道</span>
<span class="cm"> @param frequency FM频点</span>
<span class="cm"> @param result 返回结果</span>
<span class="cm"> */</span><span class="w"></span>
<span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">cmdFm</span><span class="o">:</span><span class="p">(</span><span class="n">JL_FCmdFM</span><span class="p">)</span><span class="n">cmd</span><span class="w"></span>
<span class="w">     </span><span class="nl">Saerch</span><span class="p">:(</span><span class="n">JL_FMSearch</span><span class="p">)</span><span class="n">search</span><span class="w"></span>
<span class="w">     </span><span class="nl">Channel</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">channel</span><span class="w"></span>
<span class="w"> </span><span class="nl">Frequency</span><span class="p">:(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="n">frequency</span><span class="w"></span>
<span class="w">     </span><span class="nl">Result</span><span class="p">:(</span><span class="n">JL_CMD_RESPOND</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">@end</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id40">
<h3>2.7.3 示例代码<a class="headerlink" href="#id40" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="c1">///上一个节点</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">btn_lastPoint</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">currentFunc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_FunctionCodeFM</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mFmManager</span><span class="w"> </span><span class="n">cmdFm</span><span class="o">:</span><span class="n">JL_FCmdFMChannelBefore</span><span class="w"></span>
<span class="w">                   </span><span class="nl">Saerch</span><span class="p">:</span><span class="mh">0x00</span><span class="w"> </span><span class="n">Channel</span><span class="o">:</span><span class="mh">0x00</span><span class="w"></span>
<span class="w">                </span><span class="nl">Frequency</span><span class="p">:</span><span class="mh">0x00</span><span class="w"> </span><span class="n">Result</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id41">
<h2>2.8 灯光控制功能<a class="headerlink" href="#id41" title="永久链接至标题"></a></h2>
<section id="id42">
<h3>2.8.1 功能描述<a class="headerlink" href="#id42" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>设备设置灯光相关的内容</p>
</div></blockquote>
</section>
<section id="id43">
<h3>2.8.2 相关接口<a class="headerlink" href="#id43" title="永久链接至标题"></a></h3>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">NS_ASSUME_NONNULL_BEGIN</span><span class="w"></span>

<span class="k">@interface</span> <span class="nc">JL_LightManager</span> : <span class="nc">JL_FunctionBaseManager</span><span class="w"></span>

<span class="cp">#pragma mark ---&gt; 设置灯光</span>
<span class="cm">/**</span>
<span class="cm"> *  设置灯光</span>
<span class="cm"> *  @param lightState 灯光状态</span>
<span class="cm"> *  @param lightMode 灯光模式</span>
<span class="cm"> *  @param red 红色色值</span>
<span class="cm"> *  @param green 绿色色值</span>
<span class="cm"> *  @param blue 蓝色色值</span>
<span class="cm"> *  @param flashIndex 闪烁模式index</span>
<span class="cm"> *  @param flashFreqIndex 闪烁频率</span>
<span class="cm"> *  @param sceneIndex 情景模式</span>
<span class="cm"> *  @param hue 色调，范围0-360</span>
<span class="cm"> *  @param saturation 饱和度，0-100</span>
<span class="cm"> *  @param lightness 亮度，0-100</span>
<span class="cm"> */</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetState:</span><span class="p">(</span><span class="n">JL_LightState</span><span class="p">)</span><span class="nv">lightState</span><span class="w"></span>
<span class="w">              </span><span class="nl">Mode</span><span class="p">:(</span><span class="n">JL_LightMode</span><span class="p">)</span><span class="nv">lightMode</span><span class="w"></span>
<span class="w">               </span><span class="nl">Red</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">red</span><span class="w"></span>
<span class="w">             </span><span class="nl">Green</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">green</span><span class="w"></span>
<span class="w">              </span><span class="nl">Blue</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">blue</span><span class="w"></span>
<span class="w">         </span><span class="nl">FlashInex</span><span class="p">:(</span><span class="n">JL_LightFlashModeIndex</span><span class="p">)</span><span class="nv">flashIndex</span><span class="w"></span>
<span class="w">         </span><span class="nl">FlashFreq</span><span class="p">:(</span><span class="n">JL_LightFlashModeFrequency</span><span class="p">)</span><span class="nv">flashFreqIndex</span><span class="w"></span>
<span class="w">        </span><span class="nl">SceneIndex</span><span class="p">:(</span><span class="n">JL_LightSceneMode</span><span class="p">)</span><span class="nv">sceneIndex</span><span class="w"></span>
<span class="w">               </span><span class="nl">Hue</span><span class="p">:(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="nv">hue</span><span class="w"></span>
<span class="w">        </span><span class="nl">Saturation</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">saturation</span><span class="w"></span>
<span class="w">         </span><span class="nl">Lightness</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">lightness</span><span class="p">;</span><span class="w"></span>

<span class="k">@end</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id44">
<h3>2.8.3 示例代码<a class="headerlink" href="#id44" title="永久链接至标题"></a></h3>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cp">#pragma mark 发送命令给固件</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">sendMessageLightState:</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="p">)</span><span class="nv">lightState</span><span class="w"> </span><span class="nf">withLightMode:</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="nv">lightMode</span><span class="p">{</span><span class="w"></span>

<span class="w">   </span><span class="n">COLOR_HSL</span><span class="w"> </span><span class="n">hsl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">360</span><span class="o">*</span><span class="p">(</span><span class="n">sliderSewen_0</span><span class="p">.</span><span class="n">value</span><span class="p">),</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">sliderSewen_1</span><span class="p">.</span><span class="n">value</span><span class="p">),</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">sliderSewen_2</span><span class="p">.</span><span class="n">value</span><span class="p">)};</span><span class="w"></span>
<span class="w">   </span><span class="n">COLOR_RGB</span><span class="w"> </span><span class="n">rgb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">   </span><span class="n">HSLtoRGB</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hsl</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rgb</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">btnColor</span><span class="p">.</span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kDF_RGBA</span><span class="p">(</span><span class="n">rgb</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="w"> </span><span class="n">rgb</span><span class="p">.</span><span class="n">green</span><span class="p">,</span><span class="w"> </span><span class="n">rgb</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="n">addColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kDF_RGBA</span><span class="p">(</span><span class="n">rgb</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="w"> </span><span class="n">rgb</span><span class="p">.</span><span class="n">green</span><span class="p">,</span><span class="w"> </span><span class="n">rgb</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">hue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">360</span><span class="o">*</span><span class="p">(</span><span class="n">sliderSewen_0</span><span class="p">.</span><span class="n">value</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">saturation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">sliderSewen_1</span><span class="p">.</span><span class="n">value</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="kt">float</span><span class="w"> </span><span class="n">lightness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">sliderSewen_2</span><span class="p">.</span><span class="n">value</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mLightManager</span><span class="w"> </span><span class="n">cmdSetState</span><span class="o">:</span><span class="n">lightState</span><span class="w"> </span><span class="n">Mode</span><span class="o">:</span><span class="n">lightMode</span><span class="w"></span>
<span class="w">                                           </span><span class="nl">Red</span><span class="p">:</span><span class="n">rgb</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="n">Green</span><span class="o">:</span><span class="n">rgb</span><span class="p">.</span><span class="n">green</span><span class="w"> </span><span class="n">Blue</span><span class="o">:</span><span class="n">rgb</span><span class="p">.</span><span class="n">blue</span><span class="w"></span>
<span class="w">                                     </span><span class="nl">FlashInex</span><span class="p">:</span><span class="n">flashIndex</span><span class="w"> </span><span class="n">FlashFreq</span><span class="o">:</span><span class="n">freqenyIndex</span><span class="w"> </span><span class="n">SceneIndex</span><span class="o">:</span><span class="n">sceneIndex</span><span class="w"></span>
<span class="w">                                           </span><span class="nl">Hue</span><span class="p">:</span><span class="n">hue</span><span class="w"> </span><span class="n">Saturation</span><span class="o">:</span><span class="n">saturation</span><span class="w"> </span><span class="n">Lightness</span><span class="o">:</span><span class="n">lightness</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id45">
<h2>2.9 ID3信息控制功能<a class="headerlink" href="#id45" title="永久链接至标题"></a></h2>
<p>设备通过ID3向APP发送在播歌曲的相关信息，APP这边可通过以下接口进行控制</p>
<section id="id46">
<h3>2.9.1 控制类相关接口<a class="headerlink" href="#id46" title="永久链接至标题"></a></h3>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">//播放/暂停</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdID3_PP</span><span class="p">;</span><span class="w"></span>

<span class="c1">//上一曲</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdID3_Before</span><span class="p">;</span><span class="w"></span>

<span class="c1">//下一曲</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdID3_Next</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 开启/暂停 音乐信息推送</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdID3_PushEnable:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">enable</span><span class="p">;</span><span class="w"></span>

<span class="c1">//主动设置ID3播放状态</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setID3_Status:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">st</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id47">
<h4>2.9.1.1 使用范例<a class="headerlink" href="#id47" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// 播放/暂停</span>
<span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mChargingBinManager</span><span class="w"> </span><span class="n">cmdID3_PP</span><span class="p">];</span><span class="w"></span>

<span class="c1">// 上一曲</span>
<span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mChargingBinManager</span><span class="w"> </span><span class="n">cmdID3_Before</span><span class="p">];</span><span class="w"></span>

<span class="c1">// 下一曲</span>
<span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mChargingBinManager</span><span class="w"> </span><span class="n">cmdID3_Next</span><span class="p">];</span><span class="w"></span>

<span class="c1">// 开启/暂停 音乐信息推送</span>
<span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mChargingBinManager</span><span class="w"> </span><span class="n">cmdID3_PushEnable</span><span class="o">:</span><span class="nb">YES</span><span class="p">];</span><span class="w"></span>

<span class="c1">//主动设置ID3播放状态</span>
<span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">getDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">ID3_Status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//播放</span>
<span class="w">       </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mChargingBinManager</span><span class="w"> </span><span class="n">setID3_Status</span><span class="o">:</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="p">{</span><span class="w"> </span><span class="c1">//暂停</span>
<span class="w">       </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mChargingBinManager</span><span class="w"> </span><span class="n">setID3_Status</span><span class="o">:</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id48">
<h3>2.9.2 监听以及使用方法<a class="headerlink" href="#id48" title="永久链接至标题"></a></h3>
<p>ID3 是手机其他的播放器在播放音乐时，向手机发送的一些信息，手机可以通过以下接口监听到这些信息，注意的是：需要开发者主动定时查询变化</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">addNote</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//监听ID3播放状态</span>
<span class="w">    </span><span class="p">[</span><span class="n">JL_Tools</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="n">kUI_JL_SHOW_ID3</span><span class="w"> </span><span class="n">Action</span><span class="o">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">noteShowId3</span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="n">Own</span><span class="o">:</span><span class="nb">self</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">noteShowId3:</span><span class="p">(</span><span class="bp">NSNotification</span><span class="o">*</span><span class="p">)</span><span class="nv">note</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//第三方音乐，关闭设备音乐的定时器.</span>
<span class="w">    </span><span class="p">[</span><span class="n">DFAction</span><span class="w"> </span><span class="n">timingStop</span><span class="o">:</span><span class="n">myTimer</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;----------&gt; showID3UI 1111&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">showID3UI</span><span class="o">:</span><span class="nb">YES</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">name_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span><span class="n">model</span><span class="p">.</span><span class="n">ID3_Title</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">name_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span><span class="n">model</span><span class="p">.</span><span class="n">ID3_Artist</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">name_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span><span class="n">model</span><span class="p">.</span><span class="n">ID3_AlBum</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="lrc">
<h3>2.9.3 设备LRC歌词显示<a class="headerlink" href="#lrc" title="永久链接至标题"></a></h3>
<section id="id49">
<h4>2.9.3.1 功能描述<a class="headerlink" href="#id49" title="永久链接至标题"></a></h4>
<blockquote>
<div><p>对固件传输的歌词进行显示</p>
</div></blockquote>
</section>
<section id="id50">
<h4>2.9.3.2 示例代码<a class="headerlink" href="#id50" title="永久链接至标题"></a></h4>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">speexTest</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p">[[</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">manager</span><span class="p">.</span><span class="n">mLrcManager</span><span class="w"> </span><span class="n">cmdLrcMonitorResult</span><span class="o">:^</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">lrc</span><span class="p">,</span><span class="w"> </span><span class="n">JL_LRCType</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="c1">//TODO:</span>
<span class="w">    </span><span class="p">}];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="tws">
<h2>2.10 TWS功能<a class="headerlink" href="#tws" title="永久链接至标题"></a></h2>
<section id="id51">
<h3>2.10.1 功能描述<a class="headerlink" href="#id51" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>对TWS耳机操作的相关接口</p>
</div></blockquote>
</section>
<section id="id52">
<h3>2.10.2 示例代码<a class="headerlink" href="#id52" title="永久链接至标题"></a></h3>
<section id="id53">
<h4>2.10.2.1 智能充电仓相关<a class="headerlink" href="#id53" title="永久链接至标题"></a></h4>
<blockquote>
<div><p>智能充电仓操作，通知固件App的信息，开启设备蓝⽛扫描、返回结果，其他操作等 (目前Demo工程没有使用这些接口)</p>
</div></blockquote>
<ul class="simple">
<li><p>示例代码</p></li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// 通知固件App的信息</span>
<span class="c1">// @param flag  未知</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetAppInfo:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">flag</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 设置通讯MTU</span>
<span class="c1">// @param mtu app请求mtu⼤⼩</span>
<span class="c1">// @param result 实际设置的Mtu⼤⼩</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetMTU:</span><span class="p">(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="nv">mtu</span><span class="w"> </span><span class="nf">Result:</span><span class="p">(</span><span class="n">JL_CMD_VALUE_BK</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 开启蓝⽛扫描</span>
<span class="c1">// @param timeout 超时时间</span>
<span class="c1">// @param result  0:成功 1:失败</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdBTScanStartTimeout:</span><span class="p">(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="nv">timeout</span><span class="w"> </span><span class="nf">Result:</span><span class="p">(</span><span class="n">JL_CMD_VALUE_BK</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 推送蓝⽛扫描结果</span>
<span class="c1">// 返回【蓝⽛数据结构】数组</span>
<span class="c1">// @see JLBTModel</span>
<span class="k">extern</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">kJL_BT_LIST_RESULT</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 停⽌蓝⽛扫描（APP--&gt;固件）</span>
<span class="c1">// @param reason  0：超时结束  1：打断结束  2：开启扫描失败  3：正在扫描</span>
<span class="c1">// @param result  0：成功  1：失败</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdBTScanStopReason:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">reason</span><span class="w"> </span><span class="nf">Result:</span><span class="p">(</span><span class="n">JL_CMD_VALUE_BK</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 停⽌蓝⽛扫描（固件--&gt;APP）</span>
<span class="c1">// 0：超时结束  1：打断结束  2：开启扫描失败  3：正在扫描</span>
<span class="k">extern</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">kJL_BT_SCAN_STOP_NOTE</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 通知固件连接指定的蓝⽛设备</span>
<span class="c1">// @param addr 蓝⽛设备地址</span>
<span class="c1">// @param result  0：成功  1：失败</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdBTConnectAddress:</span><span class="p">(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nv">addr</span><span class="w"> </span><span class="nf">Result:</span><span class="p">(</span><span class="n">JL_CMD_VALUE_BK</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="c1">//文件传输 【固件--&gt;APP】</span>
<span class="c1">//1.监听文件数据</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdFileDataMonitorResult:</span><span class="p">(</span><span class="n">JL_FILE_DATA_BK</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="c1">//2.允许传输文件数据</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdAllowFileData</span><span class="p">;</span><span class="w"></span>

<span class="c1">//3.拒绝传输文件数据</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdRejectFileData</span><span class="p">;</span><span class="w"></span>

<span class="c1">//4.停止传输文件数据</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdStopFileData</span><span class="p">;</span><span class="w"></span>

<span class="c1">//文件传输 【APP--&gt;固件】</span>
<span class="c1">//5.请求传输文件给设备</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdFileDataSize:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">size</span><span class="w"></span>
<span class="w">             </span><span class="nl">SavePath</span><span class="p">:(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">path</span><span class="p">;</span><span class="w"></span>

<span class="c1">//6.推送文件数据给设备</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdPushFileData:</span><span class="p">(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nv">data</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id54">
<h4>2.10.2.2 获取设备的图片<a class="headerlink" href="#id54" title="永久链接至标题"></a></h4>
<blockquote>
<div><p>接⼝说明：
根据设备的 pid 以及 vid 获取加载时设备显示的图⽚，但此⽅法要求在服务器端存在对应可加载的内容。</p>
</div></blockquote>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">获取设备的图片。</span>
<span class="cm">@param vid 设备vid</span>
<span class="cm">@param pid 设备pid</span>
<span class="cm">@param result 图片数据</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdRequestDeviceImageVid:</span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">vid</span><span class="w"></span>
<span class="nl">Pid</span><span class="p">:(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">pid</span><span class="w"></span>
<span class="nl">Result</span><span class="p">:(</span><span class="n">JL_IMAGE_RT</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id55">
<h5>2.10.2.2.1 使用范例<a class="headerlink" href="#id55" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">uid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mUID</span><span class="p">;</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mPID</span><span class="p">;</span><span class="w"></span>

<span class="bp">NSNumber</span><span class="w"> </span><span class="o">*</span><span class="n">vidNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSNumber</span><span class="w"> </span><span class="n">numberWithLong</span><span class="o">:</span><span class="n">strtoul</span><span class="p">(</span><span class="n">uid</span><span class="p">.</span><span class="n">UTF8String</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)];</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">vidStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">vidNumber</span><span class="w"> </span><span class="n">stringValue</span><span class="p">];</span><span class="w"></span>

<span class="bp">NSNumber</span><span class="w"> </span><span class="o">*</span><span class="n">pidNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSNumber</span><span class="w"> </span><span class="n">numberWithLong</span><span class="o">:</span><span class="n">strtoul</span><span class="p">(</span><span class="n">pid</span><span class="p">.</span><span class="n">UTF8String</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)];</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">pidStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">pidNumber</span><span class="w"> </span><span class="n">stringValue</span><span class="p">];</span><span class="w"></span>


<span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">itemArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">@[</span><span class="s">@&quot;PRODUCT_MESSAGE&quot;</span><span class="l">]</span><span class="p">;</span><span class="w"></span>

<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdRequestDeviceImageVid</span><span class="o">:</span><span class="n">vidStr</span><span class="w"> </span><span class="n">Pid</span><span class="o">:</span><span class="n">pidStr</span><span class="w"></span>
<span class="w">                                               </span><span class="nl">ItemArray</span><span class="p">:</span><span class="n">itemArr</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="bp">NSMutableDictionary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">dict</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dict</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="p">[</span><span class="s">@&quot;PRODUCT_MESSAGE&quot;</span><span class="p">][</span><span class="s">@&quot;IMG&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">nil</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="n">totalDict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSJSONSerialization</span><span class="w"> </span><span class="n">JSONObjectWithData</span><span class="o">:</span><span class="n">data</span><span class="w"></span>
<span class="w">                                     </span><span class="nl">options</span><span class="p">:</span><span class="n">NSJSONReadingMutableLeaves</span><span class="w"></span>
<span class="w">                                       </span><span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="n">myDic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalDict</span><span class="p">[</span><span class="s">@&quot;device&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_DEBUG</span><span class="p">,</span><span class="s">@&quot;Image Data -----&gt;%@&quot;</span><span class="p">,</span><span class="n">myDic</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="edr">
<h4>2.10.2.3 设置EDR名字<a class="headerlink" href="#edr" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">//对耳相关API</span>
<span class="cm">/**</span>
<span class="cm">设置EDR名字</span>
<span class="cm">@param name</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeatsetEdrName:</span><span class="p">(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nv">name</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id56">
<h5>2.10.2.3.1 使用范例<a class="headerlink" href="#id56" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AC69X_CY1&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// EDR的名字</span>
<span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="p">[</span><span class="n">text</span><span class="w"> </span><span class="n">dataUsingEncoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span><span class="w"></span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeadsetEdrName</span><span class="o">:</span><span class="n">data</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id57">
<h4>2.10.2.4 按键设置(对耳)<a class="headerlink" href="#id57" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">按键设置(对耳)</span>
<span class="cm">@param key 左耳0x01 右耳0x02</span>
<span class="cm">@param act 单击0x01 双击0x02</span>
<span class="cm">@param fuc 0x00    无作用</span>
<span class="cm">0x01    开机</span>
<span class="cm">0x02    关机</span>
<span class="cm">0x03    上一曲</span>
<span class="cm">0x04    下一曲</span>
<span class="cm">0x05    播放/暂停</span>
<span class="cm">0x06    接听/挂断</span>
<span class="cm">0x07    拒听</span>
<span class="cm">0x08    拍照</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeatsetKeySettingKey:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">key</span><span class="w"></span>
<span class="nl">Action</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">act</span><span class="w"></span>
<span class="nl">Function</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">fuc</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id58">
<h5>2.10.2.4.1 使用范例<a class="headerlink" href="#id58" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">keyIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="w"> </span><span class="c1">// 右耳</span>
<span class="kt">int</span><span class="w"> </span><span class="n">actionIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="c1">// 单击</span>
<span class="kt">int</span><span class="w"> </span><span class="n">funcIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="c1">// 开机</span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeadsetKeySettingKey</span><span class="o">:</span><span class="n">keyIndex</span><span class="w"> </span><span class="n">Action</span><span class="o">:</span><span class="n">actionIndex</span><span class="w"> </span><span class="n">Function</span><span class="o">:</span><span class="n">funcIndex</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="led">
<h4>2.10.2.5 LED设置(对耳)<a class="headerlink" href="#led" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">LED设置(对耳)</span>
<span class="cm">@param scene 未配对     0x01</span>
<span class="cm">未连接     0x02</span>
<span class="cm">连接       0x03</span>
<span class="cm">@param effect  0x00    全灭</span>
<span class="cm">0x01    红灯常亮</span>
<span class="cm">0x02    蓝灯常亮</span>
<span class="cm">0x03    红灯呼吸</span>
<span class="cm">0x04    蓝灯呼吸</span>
<span class="cm">0x05    红蓝交替快闪</span>
<span class="cm">0x06    红蓝交替慢闪</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeatsetLedSettingScene:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">scene</span><span class="w"></span>
<span class="nl">Effect</span><span class="p">:(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">effect</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id59">
<h5>2.10.2.5.1 使用范例<a class="headerlink" href="#id59" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">sceneIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="c1">// 未配对</span>
<span class="kt">int</span><span class="w"> </span><span class="n">effectIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x03</span><span class="w"> </span><span class="c1">// 红灯呼吸</span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeatsetLedSettingScene</span><span class="o">:</span><span class="n">sceneIndex</span><span class="w"> </span><span class="n">Effect</span><span class="o">:</span><span class="n">effectIndex</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="mic">
<h4>2.10.2.6 MIC设置(耳机)<a class="headerlink" href="#mic" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">MIC设置(耳机)</span>
<span class="cm">@param mode 0： 仅左耳</span>
<span class="cm">1： 仅右耳</span>
<span class="cm">2： 自动选择</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeadsetMicSettingMode:</span><span class="p">(</span><span class="n">JL_HeadsetMicSettingMode</span><span class="p">)</span><span class="nv">mode</span><span class="w"></span>
<span class="w">                      </span><span class="nl">Result</span><span class="p">:(</span><span class="n">JL_CMD_RESPOND</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id60">
<h5>2.10.2.6.1 使用范例<a class="headerlink" href="#id60" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">modeIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">// 仅右耳</span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeadsetMicSettingMode</span><span class="o">:</span><span class="n">modeIndex</span><span class="w"> </span><span class="n">Result</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id61">
<h4>2.10.2.7 工作模式(耳机)<a class="headerlink" href="#id61" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">工作模式(耳机)</span>
<span class="cm">@param mode 0： 普通模式</span>
<span class="cm">1： 游戏模式</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeatsetWorkSettingMode:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">mode</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id62">
<h5>2.10.2.7.1 使用范例<a class="headerlink" href="#id62" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">modeIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c1">// 普通模式</span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeatsetWorkSettingMode</span><span class="o">:</span><span class="n">modeIndex</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id63">
<h4>2.10.2.8 同步时间戳(耳机)<a class="headerlink" href="#id63" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> 同步时间戳(耳机)</span>
<span class="cm"> @param date  当前系统时间</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeatsetTimeSetting:</span><span class="p">(</span><span class="bp">NSDate</span><span class="o">*</span><span class="p">)</span><span class="nv">date</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id64">
<h5>2.10.2.8.1 使用范例<a class="headerlink" href="#id64" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSDate</span><span class="w"> </span><span class="o">*</span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSDate</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeatsetTimeSetting</span><span class="o">:</span><span class="n">date</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id65">
<h4>2.10.2.9 获取设备信息(耳机)<a class="headerlink" href="#id65" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">获取设备信息(耳机)</span>
<span class="cm">@param flag BIT0    小机电量获取 格式为3个字节 参考广播包格式</span>
<span class="cm">BIT1    Edr 名称</span>
<span class="cm">BIT2    按键功能</span>
<span class="cm">BIT3    LED 显示状态</span>
<span class="cm">BIT4    MIC 模式</span>
<span class="cm">BIT5    工作模式</span>

<span class="cm">@param result 返回字典：</span>
<span class="cm">@&quot;ISCHARGING_L&quot;</span>
<span class="cm">@&quot;ISCHARGING_R&quot;</span>
<span class="cm">@&quot;ISCHARGING_C&quot;</span>
<span class="cm">@&quot;POWER_L&quot;</span>
<span class="cm">@&quot;POWER_R&quot;</span>
<span class="cm">@&quot;POWER_C&quot;</span>
<span class="cm">@&quot;EDR&quot;</span>
<span class="cm">@&quot;KEY_LR&quot;</span>
<span class="cm">@&quot;KEY_ACTION&quot;</span>
<span class="cm">@&quot;KEY_FUNCTION&quot;</span>
<span class="cm">@&quot;LED_SCENE&quot;</span>
<span class="cm">@&quot;LED_EFFECT&quot;</span>
<span class="cm">@&quot;MIC_MODE&quot;</span>
<span class="cm">@&quot;WORK_MODE&quot;</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeatsetGetAdvFlag:</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="nv">flag</span><span class="w"></span>
<span class="nl">Result</span><span class="p">:(</span><span class="n">JL_HEADSET_BK</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id66">
<h5>2.10.2.9.1 使用范例<a class="headerlink" href="#id66" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeadsetGetAdvFlag</span><span class="o">:</span><span class="mh">0x3F</span><span class="w"></span>
<span class="w">                                                          </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">dict</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dict</span><span class="p">[</span><span class="s">@&quot;KEY_SETTING&quot;</span><span class="p">]){</span><span class="w"></span>
<span class="w">        </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="n">headsetDict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_DEBUG</span><span class="p">,</span><span class="s">@&quot;headsetDict:%@&quot;</span><span class="p">,</span><span class="n">headsetDict</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id67">
<h4>2.10.2.10 设备广播通知(耳机)<a class="headerlink" href="#id67" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">设备广播通知(耳机)</span>
<span class="cm">@{@&quot;JLID&quot;: 杰理ID,</span>
<span class="cm">@&quot;VID&quot;: ,</span>
<span class="cm">@&quot;PID&quot;:  ,</span>
<span class="cm">@&quot;EDR&quot;: ,</span>
<span class="cm">@&quot;SCENE&quot;: ,</span>
<span class="cm">@&quot;ISCHARGING_L&quot;: ,</span>
<span class="cm">@&quot;ISCHARGING_R&quot;: ,</span>
<span class="cm">@&quot;ISCHARGING_C&quot;: ,</span>
<span class="cm">@&quot;POWER_L&quot;: ,</span>
<span class="cm">@&quot;POWER_R&quot;: ,</span>
<span class="cm">@&quot;POWER_C&quot;: ,</span>
<span class="cm">@&quot;CHIP_TYPE&quot;: ,</span>
<span class="cm">@&quot;PROTOCOL_TYPE&quot;: ,</span>
<span class="cm">@&quot;SEQ&quot;: };</span>
<span class="cm">*/</span><span class="w"></span>
<span class="k">extern</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">kJL_MANAGER_HEADSET_ADV</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id68">
<h5>2.10.2.10.1 使用范例<a class="headerlink" href="#id68" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">JL_Tools</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="n">kJL_MANAGER_HEADSET_ADV</span><span class="w"> </span><span class="n">Action</span><span class="o">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">noteHeadsetInfo</span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="n">Own</span><span class="o">:</span><span class="nb">self</span><span class="p">];</span><span class="w"></span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">noteHeadsetInfo:</span><span class="p">(</span><span class="bp">NSNotification</span><span class="o">*</span><span class="p">)</span><span class="nv">note</span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">note</span><span class="p">.</span><span class="n">object</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="p">[</span><span class="n">kJL_MANAGER_KEY_UUID</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="n">dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="p">[</span><span class="n">kJL_MANAGER_KEY_OBJECT</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_DEBUG</span><span class="p">,</span><span class="s">@&quot;dict:%@&quot;</span><span class="p">,</span><span class="n">dict</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id69">
<h4>2.10.2.11 关闭或开启设备广播(耳机)<a class="headerlink" href="#id69" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">关闭或开启设备广播(耳机)</span>
<span class="cm">@param enable 使能位</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdHeatsetAdvEnable:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">enable</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id70">
<h5>2.10.2.11.1 使用范例<a class="headerlink" href="#id70" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="kt">BOOL</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NO</span><span class="p">;</span><span class="w"></span>
<span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdHeatsetAdvEnable</span><span class="o">:</span><span class="n">enable</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="adv">
<h4>2.10.2.12 用于ADV设置同步后需要主机操作的行为<a class="headerlink" href="#adv" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> 用于ADV设置同步后需要主机操作的行为。</span>
<span class="cm">  1：更新配置信息，需要重启生效。</span>
<span class="cm"> */</span><span class="w"></span>
<span class="k">extern</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">kJL_MANAGER_HEADSET_TIPS</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id71">
<h5>2.10.2.12.1 使用范例<a class="headerlink" href="#id71" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">[</span><span class="n">JL_Tools</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="n">kJL_MANAGER_HEADSET_TIPS</span><span class="w"> </span><span class="n">Action</span><span class="o">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">handleHeadsetTips</span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="n">Own</span><span class="o">:</span><span class="nb">self</span><span class="p">];</span><span class="w"></span>

<span class="w">  </span><span class="c1">//MARK: - 设备请求主机TWS操作</span>
<span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">handleHeadsetTips</span><span class="o">:</span><span class="p">(</span><span class="bp">NSNotification</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">note</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_INFO</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;JLTranslationManager handleHeadsetTips&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="n">dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">note</span><span class="p">.</span><span class="n">object</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">dict</span><span class="p">[</span><span class="s">@&quot;JL_MANAGER_KEY_OBJECT&quot;</span><span class="p">]</span><span class="w"> </span><span class="n">intValue</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x04</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 请求同步设备信息</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">queueDict</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">           </span><span class="n">JLTranslatQueue</span><span class="w"> </span><span class="o">*</span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">queueDict</span><span class="p">[</span><span class="n">key</span><span class="p">];</span><span class="w"></span>
<span class="w">           </span><span class="p">[</span><span class="n">queue</span><span class="w"> </span><span class="n">resRequest</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id72">
<h4>2.10.2.13 对挂脖耳机类型支持<a class="headerlink" href="#id72" title="永久链接至标题"></a></h4>
<p>挂脖耳机的功能和前面所提及的对耳、TWS耳机功能类似，只是产品造型方式不一致，APP这边就按照TWS对耳的方式来进行解析。</p>
<p>详见<strong>JL_EntityM</strong>类的以下属性：</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">    JL_DeviceTypeSoundBox           = 0,     //AI音箱类型</span>
<span class="cm">    JL_DeviceTypeChargingBin        = 1,     //充电仓类型</span>
<span class="cm">    JL_DeviceTypeTWS                = 2,     //TWS耳机类型</span>
<span class="cm">    JL_DeviceTypeHeadset            = 3,     //普通耳机类型</span>
<span class="cm">    JL_DeviceTypeSoundCard          = 4,     //声卡类型</span>
<span class="cm">    JL_DeviceTypeWatch              = 5,     //手表类型</span>
<span class="cm">    JL_DeviceTypeTradition          = -1,    //传统设备类型</span>
<span class="cm"> */</span><span class="w"></span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JL_DeviceType</span><span class="w">   </span><span class="n">mType</span><span class="p">;</span><span class="w"> </span><span class="c1">//这里标记为：TWS耳机类型</span>

<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">BOOL</span><span class="w">            </span><span class="n">isCharging_L</span><span class="p">;</span><span class="w"> </span><span class="c1">//左耳状态显示为整个耳机的电量</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">BOOL</span><span class="w">            </span><span class="n">isCharging_R</span><span class="p">;</span><span class="c1">//为零或无参考意义</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">BOOL</span><span class="w">            </span><span class="n">isCharging_C</span><span class="p">;</span><span class="c1">//为零或无参考意义</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">         </span><span class="n">mPower</span><span class="p">;</span><span class="w">  </span><span class="c1">//左耳电量显示为整个耳机的电量</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">         </span><span class="n">mPower_L</span><span class="p">;</span><span class="w"> </span><span class="c1">//左耳电量显示为整个耳机的电量</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">         </span><span class="n">mPower_R</span><span class="p">;</span><span class="w"> </span><span class="c1">//为零或无参考意义</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">         </span><span class="n">mPower_C</span><span class="p">;</span><span class="c1">//为零或无参考意义</span>

<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w">         </span><span class="n">mProtocolType</span><span class="p">;</span><span class="w"> </span><span class="c1">//当为挂脖耳机时，此属性显示值为0x03 ，当设备是普通TWS耳机是0x02</span>
</pre></div>
</div>
<p>其他的属性与设置和<a class="reference external" href="##11.%20TWS功能">TWS功能属性</a>保持一致</p>
</section>
<section id="id73">
<h4>2.10.2.14 辅听耳机验配功能<a class="headerlink" href="#id73" title="永久链接至标题"></a></h4>
<blockquote>
<div><p>辅听功能，是作用于TWS耳机设置的内容，其他设备不支持。实现需要依赖于<cite>JL_EntityM</cite>类的以下属性：<cite>mCmdManager</cite>属性。</p>
</div></blockquote>
<ul>
<li><p>判断当前设备是否支持辅听功能：</p>
<blockquote>
<div><p>当前是是否支持辅听功能，可以通过<cite>JLModel_Device</cite>类的以下属性：<cite>isSupportDhaFitting</cite>属性来判断。</p>
<p><cite>JLModel_Device</cite>类对象是通过，<cite>JL_EntityM</cite>类的以下属性：<cite>mCmdManager</cite>属性的，<cite>outputDeviceModel</cite>方法来获取。</p>
</div></blockquote>
</li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 是否支持辅听设置</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">BOOL</span><span class="w">               </span><span class="n">isSupportDhaFitting</span><span class="p">;</span><span class="w"></span>
<span class="c1">///验配信息交互：版本、通道数、通道频率</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">DhaFittingInfo</span><span class="w">     </span><span class="o">*</span><span class="n">dhaFitInfo</span><span class="p">;</span><span class="w"></span>
<span class="c1">/// 验配中断/开启的对象，仅限于监听</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">DhaFittingSwitch</span><span class="w">   </span><span class="o">*</span><span class="n">dhaFitSwitch</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>获取设备当前辅听的基础信息：版本、通道数、通道频率</p></li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">JLDhaFitting</span><span class="w"> </span><span class="n">auxiGetInfo</span><span class="o">:^</span><span class="p">(</span><span class="n">DhaFittingInfo</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">gains</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">ch_num</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">navigationController</span><span class="w"> </span><span class="n">pushViewController</span><span class="o">:</span><span class="n">vc</span><span class="w"> </span><span class="n">animated</span><span class="o">:</span><span class="nb">true</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">Dialog</span><span class="p">()</span><span class="w"></span>
<span class="w">            </span><span class="c1">//位置</span>
<span class="w">                </span><span class="p">.</span><span class="n">wToastPositionSet</span><span class="p">(</span><span class="n">DialogToastBottom</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">.</span><span class="n">wTypeSet</span><span class="p">(</span><span class="n">DialogTypeToast</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">.</span><span class="n">wMessageSet</span><span class="p">(</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;msg_read_file_err_reading&quot;</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="c1">//调整宽度</span>
<span class="w">                </span><span class="p">.</span><span class="n">wMainOffsetXSet</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">.</span><span class="n">wStart</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Dialog</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="c1">//位置</span>
<span class="w">            </span><span class="p">.</span><span class="n">wToastPositionSet</span><span class="p">(</span><span class="n">DialogToastBottom</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">wTypeSet</span><span class="p">(</span><span class="n">DialogTypeToast</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">wMessageSet</span><span class="p">(</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;msg_read_file_err_reading&quot;</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="c1">//调整宽度</span>
<span class="w">            </span><span class="p">.</span><span class="n">wMainOffsetXSet</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">wStart</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">Manager</span><span class="o">:</span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>进行辅听验配：</p></li>
</ul>
<blockquote>
<div><div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">dhaManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JLDhaFitting</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"></span>
<span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">DhaFittingData</span><span class="w"> </span><span class="o">*</span><span class="n">dataInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">DhaFittingData</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="n">dataInfo</span><span class="p">.</span><span class="n">leftOn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NO</span><span class="p">;</span><span class="c1">//左耳是否开启</span>
<span class="n">dataInfo</span><span class="p">.</span><span class="n">rightOn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NO</span><span class="p">;</span><span class="c1">//右耳是否开启</span>
<span class="n">dataInfo</span><span class="p">.</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//频率</span>
<span class="n">dataInfo</span><span class="p">.</span><span class="n">gain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="c1">//增益</span>
<span class="p">[</span><span class="n">dhaManager</span><span class="w"> </span><span class="n">auxiCheckByStep</span><span class="o">:</span><span class="n">dataInfo</span><span class="w"> </span><span class="n">Manager</span><span class="o">:</span><span class="n">cmd</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;验配：channecl:%d freq:%d gains:%.2f&quot;</span><span class="p">,</span><span class="n">dataInfo</span><span class="p">.</span><span class="n">channel</span><span class="p">,</span><span class="n">dataInfo</span><span class="p">.</span><span class="n">freq</span><span class="p">,</span><span class="n">dataInfo</span><span class="p">.</span><span class="n">gain</span><span class="p">);</span><span class="w"></span>

<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>保存验配设置:</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>这里需要注意的是，保存验配设置，需要把前面验配好的N条<cite>DhaFittingData</cite>数据，重新整理发送到设备。</p>
</div>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">newArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">FittingMgr</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nb">self</span><span class="p">.</span><span class="n">results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">DhaFittingData</span><span class="w"> </span><span class="o">*</span><span class="n">item2</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">dhaList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">newArray</span><span class="w"> </span><span class="n">addObject</span><span class="o">:</span><span class="n">item2</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">mgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>

<span class="p">[</span><span class="n">fitting</span><span class="w"> </span><span class="n">auxiSaveGainsList</span><span class="o">:</span><span class="n">newArray</span><span class="w"> </span><span class="n">Manager</span><span class="o">:</span><span class="n">mgr</span><span class="w"> </span><span class="n">Type</span><span class="o">:</span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">getType</span><span class="p">]</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//保存成功或失败</span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>退出辅听验配：</p></li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="p">[[</span><span class="n">JLDhaFitting</span><span class="w"> </span><span class="n">new</span><span class="p">]</span><span class="w"> </span><span class="n">auxiCloseManager</span><span class="o">:</span><span class="n">cmd</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;退出验配&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当前协议版本，只针对辅听开关只通过固件按键进行设置，所以设备会在辅听开关开启的时候，自动进入辅听验配状态。每次只要请求设备信息，回复正确时，设备就会进入辅听验配状态。
在此特定条件下，需要注意及时执行退出辅听验配的操作。</p>
</div>
<ul class="simple">
<li><p>监听设备推出辅听验配状态：</p></li>
</ul>
<p>使用KVO的方式监听设备推出辅听验配状态，当设备推出辅听验配状态时，会触发该回调。</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">FittingBasicVC</span><span class="w"> </span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">devModel</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">@end</span><span class="w"></span>

<span class="k">@implementation</span> <span class="nc">FittingBasicVC</span><span class="w"></span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidLoad</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dhaFitSwitchContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dhaFitSwitchContext</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">devModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">getDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">devModel</span><span class="w"> </span><span class="n">addObserver</span><span class="o">:</span><span class="nb">self</span><span class="w"> </span><span class="n">forKeyPath</span><span class="o">:</span><span class="s">@&quot;dhaFitSwitch&quot;</span><span class="w"> </span><span class="n">options</span><span class="o">:</span><span class="n">NSKeyValueObservingOptionNew</span><span class="w"> </span><span class="n">context</span><span class="o">:</span><span class="n">dhaFitSwitchContext</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">observeValueForKeyPath:</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">keyPath</span><span class="w"> </span><span class="nf">ofObject:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">object</span><span class="w"> </span><span class="nf">change:</span><span class="p">(</span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">change</span><span class="w"> </span><span class="nf">context:</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">context</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">dhaFitSwitchContext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">change</span><span class="w"> </span><span class="n">objectForKey</span><span class="o">:</span><span class="s">@&quot;new&quot;</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">            </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">TwsElectricity</span><span class="w"> </span><span class="o">*</span><span class="n">electricity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">manager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="p">.</span><span class="n">electricity</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">DhaFittingSwitch</span><span class="w"> </span><span class="o">*</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">change</span><span class="w"> </span><span class="n">objectForKey</span><span class="o">:</span><span class="s">@&quot;new&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">electricity</span><span class="p">.</span><span class="n">powerLeft</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">electricity</span><span class="p">.</span><span class="n">powerRight</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">//双耳</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="p">.</span><span class="n">rightOn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NO</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">sw</span><span class="p">.</span><span class="n">leftOn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">goBackToRoot</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">electricity</span><span class="p">.</span><span class="n">powerLeft</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">electricity</span><span class="p">.</span><span class="n">powerRight</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">//右耳</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="p">.</span><span class="n">rightOn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">goBackToRoot</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">electricity</span><span class="p">.</span><span class="n">powerRight</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">electricity</span><span class="p">.</span><span class="n">powerLeft</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">//左耳</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="p">.</span><span class="n">leftOn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">goBackToRoot</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">observeValueForKeyPath</span><span class="o">:</span><span class="n">keyPath</span><span class="w"> </span><span class="n">ofObject</span><span class="o">:</span><span class="n">object</span><span class="w"> </span><span class="n">change</span><span class="o">:</span><span class="n">change</span><span class="w"> </span><span class="n">context</span><span class="o">:</span><span class="n">context</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidDisappear:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">animated</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">viewDidDisappear</span><span class="o">:</span><span class="n">animated</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">devModel</span><span class="w"> </span><span class="n">removeObserver</span><span class="o">:</span><span class="nb">self</span><span class="w"> </span><span class="n">forKeyPath</span><span class="o">:</span><span class="s">@&quot;dhaFitSwitch&quot;</span><span class="w"> </span><span class="n">context</span><span class="o">:</span><span class="n">dhaFitSwitchContext</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">goBackToRoot</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">navigationController</span><span class="w"> </span><span class="n">popToRootViewControllerAnimated</span><span class="o">:</span><span class="nb">YES</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">@end</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id74">
<h4>2.10.2.15 一拖二耳机功能支持<a class="headerlink" href="#id74" title="永久链接至标题"></a></h4>
<p>一拖二功能的支持可以通过 <cite>JL_TwsManager</cite> 类的扩展功能支持属性 <strong>TwsSupportFuncs *supports;</strong>，下的 <cite>isSupportDragWithMore;</cite> 来判断是否支持；</p>
<ul class="simple">
<li><p>获取设备已连接的手机名</p></li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">itemList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>

<span class="n">JL_TwsManager</span><span class="w"> </span><span class="o">*</span><span class="n">tws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="p">;</span><span class="w"></span>

<span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdGetDeviceInfoListResult</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">){</span><span class="w"></span>

<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">itemList</span><span class="w"> </span><span class="n">setArray</span><span class="o">:</span><span class="n">phoneInfos</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">info</span><span class="w"> </span><span class="n">logProperties</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">valueForKey</span><span class="o">:</span><span class="n">PhoneEdrAddr</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">phoneInfos</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">.</span><span class="n">firstObject</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneEdrAddr</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneName</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">synchronize</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="c1">//绑定</span>
<span class="w">            </span><span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdBindDeviceInfo</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">phone</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="p">}];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">phoneInfos</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">isBind</span><span class="p">){</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">isEqualToData</span><span class="o">:</span><span class="n">addr</span><span class="p">]){</span><span class="w"></span>
<span class="w">                        </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneName</span><span class="p">];</span><span class="w"></span>
<span class="w">                        </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">synchronize</span><span class="p">];</span><span class="w"></span>
<span class="w">                        </span><span class="c1">//绑定</span>
<span class="w">                        </span><span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdBindDeviceInfo</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">phone</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="w">                        </span><span class="p">}];</span><span class="w"></span>

<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">isEqualToData</span><span class="o">:</span><span class="n">addr</span><span class="p">]){</span><span class="w"></span>
<span class="w">                        </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneEdrAddr</span><span class="p">];</span><span class="w"></span>
<span class="w">                        </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneName</span><span class="p">];</span><span class="w"></span>
<span class="w">                        </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">synchronize</span><span class="p">];</span><span class="w"></span>
<span class="w">                        </span><span class="c1">//绑定</span>
<span class="w">                        </span><span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdBindDeviceInfo</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">phone</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="w">                        </span><span class="p">}];</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
<p>以上逻辑是一个判断本机对应的蓝牙地址的判断：</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<ol class="arabic simple">
<li><p>当设备返回只有一台手机信息的时候，手机本地需要更新并记录该名字与地址（无论本身是否已经记录过），如果手机本地记录（名字或地址）有更改，请绑定后重新发送C031；</p></li>
<li><p>当设备返回两台手机信息都没有绑定的时候，手机不做任何操作；</p></li>
<li><p>当设备返回两台手机信息其中一台有绑定、另外一台没有绑定时：</p></li>
<li><p>如果绑定的地址与手机本地的相符，查看是否有更新，如果有更新则重新发送C031命令，没有更新则不作处理；</p></li>
<li><p>如果绑定的地址与手机本地的不相符（包括手机本地），则没有绑定的手机信息是当前手机的信息，绑定后重新发送C031命令。</p></li>
</ol>
</div>
<p>一拖二设备列表信息也能通过以下通知获得：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">///</span> <span class="n">设备上传一拖二设备信息列表</span>
<span class="n">extern</span> <span class="n">NSString</span><span class="o">*</span> <span class="n">kJL_MULIT_NAME_LIST</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>通知设备一连上手机地址和绑定信息</dt><dd><p>此接口需要配合上述的获取设备已连接手机信息接口使用，具体绑定规则如上述注意点所述</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 通知设备一连上手机地址和绑定信息</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - addr: 手机EDR地址</span>
<span class="c1">///   - name: 手机蓝牙名称</span>
<span class="c1">///   - result: 结果</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdBindDeviceInfo:</span><span class="p">(</span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">addr</span><span class="w"> </span><span class="nf">phone:</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">name</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JL_MulitLinksInfo_BK</span><span class="p">)</span><span class="nv">result</span><span class="w"></span>
</pre></div>
</div>
<section id="id75">
<h5>2.10.2.15.1 使用范例<a class="headerlink" href="#id75" title="永久链接至标题"></a></h5>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">initData</span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">JL_TwsManager</span><span class="w"> </span><span class="o">*</span><span class="n">tws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="p">;</span><span class="w"></span>

<span class="w">   </span><span class="p">[</span><span class="n">itemList</span><span class="w"> </span><span class="n">removeAllObjects</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdGetDeviceInfoListResult</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">){</span><span class="w"></span>

<span class="w">           </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">itemList</span><span class="w"> </span><span class="n">setArray</span><span class="o">:</span><span class="n">phoneInfos</span><span class="p">];</span><span class="w"></span>
<span class="w">           </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">){</span><span class="w"></span>
<span class="w">               </span><span class="p">[</span><span class="n">info</span><span class="w"> </span><span class="n">logProperties</span><span class="p">];</span><span class="w"></span>
<span class="w">           </span><span class="p">}</span><span class="w"></span>

<span class="w">           </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">valueForKey</span><span class="o">:</span><span class="n">PhoneEdrAddr</span><span class="p">];</span><span class="w"></span>

<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">phoneInfos</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span><span class="w"></span>
<span class="w">               </span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">.</span><span class="n">firstObject</span><span class="p">;</span><span class="w"></span>
<span class="w">               </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneEdrAddr</span><span class="p">];</span><span class="w"></span>
<span class="w">               </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneName</span><span class="p">];</span><span class="w"></span>
<span class="w">               </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">synchronize</span><span class="p">];</span><span class="w"></span>
<span class="w">               </span><span class="c1">//绑定</span>
<span class="w">               </span><span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdBindDeviceInfo</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">phone</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                   </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="w">               </span><span class="p">}];</span><span class="w"></span>
<span class="w">           </span><span class="p">}</span><span class="w"></span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">phoneInfos</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">){</span><span class="w"></span>
<span class="w">               </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">isBind</span><span class="p">){</span><span class="w"></span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">isEqualToData</span><span class="o">:</span><span class="n">addr</span><span class="p">]){</span><span class="w"></span>
<span class="w">                           </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneName</span><span class="p">];</span><span class="w"></span>
<span class="w">                           </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">synchronize</span><span class="p">];</span><span class="w"></span>
<span class="w">                           </span><span class="c1">//绑定</span>
<span class="w">                           </span><span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdBindDeviceInfo</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">phone</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                               </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="w">                           </span><span class="p">}];</span><span class="w"></span>

<span class="w">                       </span><span class="p">}</span><span class="w"></span>
<span class="w">                   </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">isEqualToData</span><span class="o">:</span><span class="n">addr</span><span class="p">]){</span><span class="w"></span>
<span class="w">                           </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneEdrAddr</span><span class="p">];</span><span class="w"></span>
<span class="w">                           </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">forKey</span><span class="o">:</span><span class="n">PhoneName</span><span class="p">];</span><span class="w"></span>
<span class="w">                           </span><span class="p">[[</span><span class="bp">NSUserDefaults</span><span class="w"> </span><span class="n">standardUserDefaults</span><span class="p">]</span><span class="w"> </span><span class="n">synchronize</span><span class="p">];</span><span class="w"></span>
<span class="w">                           </span><span class="c1">//绑定</span>
<span class="w">                           </span><span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">cmdBindDeviceInfo</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneEdrAddr</span><span class="w"> </span><span class="n">phone</span><span class="o">:</span><span class="n">info</span><span class="p">.</span><span class="n">phoneName</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLTWSAddrNameInfo</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">phoneInfos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                               </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="w">                           </span><span class="p">}];</span><span class="w"></span>
<span class="w">                       </span><span class="p">}</span><span class="w"></span>
<span class="w">                   </span><span class="p">}</span><span class="w"></span>
<span class="w">               </span><span class="p">}</span><span class="w"></span>
<span class="w">           </span><span class="p">}</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="w">       </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">subTable</span><span class="w"> </span><span class="n">reloadData</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="p">}];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>设备开启/关闭多连接手机接口</p></li>
</ul>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 一拖二开关</span>
<span class="c1">/// @param dragWithMore 开关状态</span>
<span class="c1">/// @param addr 手机的经典蓝牙地址（通过cmdGetDeviceInfoList获取）</span>
<span class="c1">/// @param result   结果回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setDragWithMore:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">dragWithMore</span><span class="w"> </span><span class="nf">phoneBleAddr:</span><span class="p">(</span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">addr</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">result</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>设备开启/关闭多连接手机接口的使用范例</p></li>
</ul>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="n">JL_TwsManager</span><span class="w"> </span><span class="o">*</span><span class="n">tws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="p">;</span><span class="w"></span>
<span class="kt">BOOL</span><span class="w"> </span><span class="n">isOn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">YES</span><span class="p">;</span><span class="w"></span>
<span class="p">[</span><span class="n">tws</span><span class="w"> </span><span class="n">setDragWithMore</span><span class="o">:</span><span class="n">isOn</span><span class="w"> </span><span class="n">phoneBleAddr</span><span class="o">:</span><span class="n">addr</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_DEBUG</span><span class="p">,</span><span class="s">@&quot;status:%@&quot;</span><span class="p">,</span><span class="n">status</span><span class="p">);</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="anc">
<h2>2.11 ANC设置功能<a class="headerlink" href="#anc" title="永久链接至标题"></a></h2>
<section id="id76">
<h3>2.11.1 功能说明<a class="headerlink" href="#id76" title="永久链接至标题"></a></h3>
<p>当前接口只针对具备降噪功能的耳机起作用，属于公共接口。</p>
</section>
<section id="sdkanc">
<h3>2.11.2 耳机SDK添加ANC(主动降噪)<a class="headerlink" href="#sdkanc" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>耳机主动降噪支持模式</p></li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">copy</span><span class="w">  </span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="bp">NSMutableArray</span><span class="w">     </span><span class="o">*</span><span class="n">mAncModeArray</span><span class="p">;</span><span class="w">         </span><span class="c1">//ANC模式数组</span>
</pre></div>
</div>
<ul class="simple">
<li><p>耳机主动降噪当前的模式</p></li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">copy</span><span class="w">  </span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="n">JLModel_ANC</span><span class="w">        </span><span class="o">*</span><span class="n">mAncModeCurrent</span><span class="p">;</span><span class="w">       </span><span class="c1">//当前ANC的模式</span>
</pre></div>
</div>
<ul class="simple">
<li><p>对耳机主动降噪进行设置</p></li>
</ul>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">JLModel_ANC</span> : <span class="bp">NSObject</span><span class="w"></span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="n">JL_AncMode</span><span class="w">       </span><span class="n">mAncMode</span><span class="p">;</span><span class="w">               </span><span class="c1">//耳机降噪模式</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w">        </span><span class="n">mAncMax_L</span><span class="p">;</span><span class="w">              </span><span class="c1">//左耳最大增益</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w">        </span><span class="n">mAncCurrent_L</span><span class="p">;</span><span class="w">          </span><span class="c1">//左耳当前增益</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w">        </span><span class="n">mAncMax_R</span><span class="p">;</span><span class="w">              </span><span class="c1">//右耳最大增益</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w">        </span><span class="n">mAncCurrent_R</span><span class="p">;</span><span class="w">          </span><span class="c1">//右耳当前增益</span>
<span class="p">-(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nf">dataModel</span><span class="p">;</span><span class="w"></span>

<span class="cp">#pragma mark ---&gt; 耳机主动降噪ANC设置</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetANC:</span><span class="p">(</span><span class="n">JLModel_ANC</span><span class="o">*</span><span class="p">)</span><span class="nv">model</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id77">
<h4>2.11.2.1 使用范例<a class="headerlink" href="#id77" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">mAncModeCurrent</span><span class="p">.</span><span class="n">mAncMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_AncMode_NoiseReduction</span><span class="w"> </span><span class="o">||</span><span class="w"></span>
<span class="w">      </span><span class="n">model</span><span class="p">.</span><span class="n">mAncModeCurrent</span><span class="p">.</span><span class="n">mAncMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_AncMode_Transparent</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="w">      </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">deviceModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">getDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">      </span><span class="n">JLModel_ANC</span><span class="w"> </span><span class="o">*</span><span class="n">modelANC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deviceModel</span><span class="p">.</span><span class="n">mAncModeCurrent</span><span class="w"></span>
<span class="w">      </span><span class="n">modelANC</span><span class="p">.</span><span class="n">mAncCurrent_L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftCurrentValue</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="n">modelANC</span><span class="p">.</span><span class="n">mAncCurrent_R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightCurrentValue</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mTwsManager</span><span class="w"> </span><span class="n">cmdSetANC</span><span class="o">:</span><span class="n">modelANC</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id78">
<h2>2.12 声卡功能配置<a class="headerlink" href="#id78" title="永久链接至标题"></a></h2>
<section id="id79">
<h3>2.12.1 功能描述<a class="headerlink" href="#id79" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>对声卡设备的处理</p>
</div></blockquote>
</section>
<section id="id80">
<h3>2.12.2 示例代码<a class="headerlink" href="#id80" title="永久链接至标题"></a></h3>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 声卡功能</span>
<span class="k">@interface</span> <span class="nc">JLSoundCardIndexValue</span> : <span class="bp">NSObject</span><span class="w"></span>

<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">index</span><span class="p">;</span><span class="w"></span>

<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>

<span class="k">@end</span><span class="w"></span>

<span class="k">@protocol</span> <span class="nc">JLSoundCardMgrDelegate</span> <span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span><span class="w"></span>

<span class="c1">/// 声卡控制回调</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - mask: 掩码</span>
<span class="c1">///   - items: 掩码对应的值</span>
<span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">jlsoundCardMask</span><span class="o">:</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">)</span><span class="n">mask</span><span class="w"> </span><span class="n">values</span><span class="o">:</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">JLSoundCardIndexValue</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">items</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 声卡控制回调</span>
<span class="c1">/// - Parameter frequencyArray: 频率数组</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">jlsoundCardMicFrequency:</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">*</span><span class="p">)</span><span class="nv">frequencyArray</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 声卡控制回调</span>
<span class="c1">/// - Parameter eqArray: EQ数组</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">jlsoundCardMicEQ:</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">*</span><span class="p">)</span><span class="nv">eqArray</span><span class="p">;</span><span class="w"></span>

<span class="k">@end</span><span class="w"></span>


<span class="c1">/// 卡拉OK（声卡控制相关）</span>
<span class="k">@interface</span> <span class="nc">JL_SoundCardManager</span> : <span class="bp">NSObject</span><span class="w"></span>

<span class="c1">/// 卡拉OK 组件索引</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">long</span><span class="w"> </span><span class="n">index</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 卡拉OK 组件的值</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">long</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 卡拉OK 固件返回的掩码</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">assign</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">mask</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 声卡功能参数列表</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">JLSoundCardIndexValue</span><span class="w"> </span><span class="o">*&gt;*</span><span class="w"> </span><span class="n">iVitems</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 卡拉OK 频率数组</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">micFrequencyArray</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 卡拉OK EQ数组</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">strong</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">micEQArray</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 代理</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">weak</span><span class="p">,</span><span class="k">nonatomic</span><span class="p">)</span><span class="kt">id</span><span class="o">&lt;</span><span class="n">JLSoundCardMgrDelegate</span><span class="o">&gt;</span><span class="w"> </span><span class="n">delegate</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 设置卡拉OK【index、value】</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///  - manager: 设备对象</span>
<span class="c1">///  - index: index 参数类型 JL_KalaoIndex 目前支持混响、延时、音量的设置。（具体可以看固件的json文件）</span>
<span class="c1">///  - value:  0-100</span>
<span class="c1">///  - result: 设置结果</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetKalaok:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">Index:</span><span class="p">(</span><span class="n">JL_KalaoIndex</span><span class="p">)</span><span class="nv">index</span><span class="w"> </span><span class="nf">Value:</span><span class="p">(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="nv">value</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 设置卡拉OK【MIC EQ增益】</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///  - manager: 设备对象</span>
<span class="c1">///  - array:  @[@(0),@(0),@(0),@(0),@(0)]  单个取值范围 [-8.0 , +8.0]。</span>
<span class="c1">///  - result: 设置结果</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdSetKaraoke:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">micEQ:</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">*</span><span class="p">)</span><span class="nv">array</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id81">
<h4>2.12.2.1 使用范例<a class="headerlink" href="#id81" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// 使用 JLSoundCardMgrDelegate 的示例</span>

<span class="c1">// 1. 创建一个遵循 JLSoundCardMgrDelegate 协议的类</span>
<span class="k">@interface</span> <span class="nc">MySoundCardManager</span> : <span class="bp">NSObject</span><span class="w"> </span><span class="o">&lt;</span><span class="n">JLSoundCardMgrDelegate</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">@end</span><span class="w"></span>

<span class="k">@implementation</span> <span class="nc">MySoundCardManager</span><span class="w"></span>

<span class="c1">// 2. 设置代理</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">init</span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="n">manager</span><span class="p">.</span><span class="n">mSoundCardManager</span><span class="p">.</span><span class="n">delegate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 3. 实现声卡控制回调方法 - 掩码回调</span>
<span class="w">   </span><span class="c1">/// - Parameters:</span>
<span class="w">   </span><span class="c1">///   - mask: 掩码</span>
<span class="w">   </span><span class="c1">///   - items: 掩码对应的值</span>
<span class="w">   </span><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">jlsoundCardMask</span><span class="o">:</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">)</span><span class="n">mask</span><span class="w"> </span><span class="n">values</span><span class="o">:</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">JLSoundCardIndexValue</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">items</span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="k">for</span><span class="p">(</span><span class="n">JLSoundCardIndexValue</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">items</span><span class="p">){</span><span class="w"></span>
<span class="w">         </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;掩码索引:%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">index</span><span class="p">);</span><span class="w"></span>
<span class="w">         </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;掩码的值:%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">value</span><span class="p">);</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>

<span class="c1">// 4. 实现声卡控制回调方法 - 频率回调</span>
<span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">jlsoundCardMicFrequency</span><span class="o">:</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">frequencyArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="c1">// 处理频率数据</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">frequencyArray</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">frequencyArray</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="c1">// 遍历频率数组中的每个频率值</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*</span><span class="n">frequencyValue</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">frequencyArray</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">           </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">frequency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">frequencyValue</span><span class="w"> </span><span class="n">floatValue</span><span class="p">];</span><span class="w"></span>
<span class="w">           </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;频率值: %f Hz&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">frequency</span><span class="p">);</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>

<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">frequencyArray</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">           </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">leftChannel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">frequencyArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n">floatValue</span><span class="p">];</span><span class="w"></span>
<span class="w">           </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">rightChannel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">frequencyArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="n">floatValue</span><span class="p">];</span><span class="w"></span>
<span class="w">           </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;左声道: %f Hz, 右声道: %f Hz&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">leftChannel</span><span class="p">,</span><span class="w"> </span><span class="n">rightChannel</span><span class="p">);</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 5. 实现声卡控制回调方法 - EQ回调</span>
<span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">jlsoundCardMicEQ</span><span class="o">:</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">eqArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// 处理EQ数据</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eqArray</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eqArray</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="c1">// 示例：假设EQ数组包含多个频段的增益值</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">eqArray</span><span class="p">.</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">           </span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*</span><span class="n">eqGain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eqArray</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">           </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">gainValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">eqGain</span><span class="w"> </span><span class="n">floatValue</span><span class="p">];</span><span class="w"></span>

<span class="w">           </span><span class="c1">// 处理每个EQ频段的增益值</span>
<span class="w">           </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;EQ频段 %d: 增益 %f dB&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">gainValue</span><span class="p">);</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 6.设置卡拉OK【index、value】(index包括JL_KalaoIndexReverberation、JL_KalaoIndexDelayed、JL_KalaoIndexVolume;value的范围是0到100)</span>
<span class="w">   </span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="w"> </span><span class="n">mCmdManager</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="p">[</span><span class="n">manager</span><span class="p">.</span><span class="n">mSoundCardManager</span><span class="w"> </span><span class="n">cmdSetKalaok</span><span class="o">:</span><span class="n">manager</span><span class="w"> </span><span class="n">Index</span><span class="o">:</span><span class="n">JL_KalaoIndexVolume</span><span class="w"> </span><span class="n">Value</span><span class="o">:</span><span class="mi">75</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">   </span><span class="p">}];</span><span class="w"></span>

<span class="c1">// 7.设置卡拉OK【MIC EQ增益】</span>
<span class="w"> </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">eqArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">@[@(</span><span class="mi">100</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">500</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">1000</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">4000</span><span class="l">)</span><span class="p">,</span><span class="l">@(</span><span class="mi">8000</span><span class="l">)]</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="o">*</span><span class="n">bleSDK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="w"> </span><span class="n">mCmdManager</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="n">manager</span><span class="p">.</span><span class="n">mSoundCardManager</span><span class="w"> </span><span class="n">cmdSetKaraoke</span><span class="o">:</span><span class="n">manager</span><span class="w"> </span><span class="n">micEQ</span><span class="o">:</span><span class="n">eqArray</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w"> </span><span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id82">
<h3>2.12.3 配置文档<a class="headerlink" href="#id82" title="永久链接至标题"></a></h3>
<p><strong>sound_card_json.txt</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;hasEq&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;变声&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Voice&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;select&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon_voice_nol.png&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;column&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;paging&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;正常&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Normal&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;男声&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Boy&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;女声&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Girl&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;童音&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Children&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;魔音&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Magic&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;电音&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EM&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;group&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;升A大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;L A major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;B大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;B major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;升C大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;L C major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;升D大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;L D major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;E大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;E major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;F大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;F major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;升F大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;L F major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;G大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;G major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;升G大调&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;L G major&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">          </span><span class="p">]</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;其他&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Other&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon_others_nol.png&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;select&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;column&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;paging&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;爆音&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Popping&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;喊麦&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Shout&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">37</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;闪避&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dodge&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">38</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;气氛&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AtmosPhere&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon_effect_nol.png&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_select&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;column&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;paging&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;row&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;欢呼&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cheers&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">17</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_cheer.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;尴尬&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Awkward&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_awkward.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;枪声&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Gunfire&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_gun.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;鄙视&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Despise&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_despise.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;开场&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Stage&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_stage.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;飞吻&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Kiss&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_kiss.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;笑声&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Laugh&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_laugh.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;掌声&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Applause&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_applause.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;请关注&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Attention&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_follow.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;么么哒&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mua&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">26</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_memeda.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;贼啦啦&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Song01&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">27</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_song_01.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;非诚勿扰&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Song02&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;img_song_02.png&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mic参数&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mic Args&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;icon_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon_settle_nol.png&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;slider&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">         </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;麦音量&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mic Vol&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">29</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;录音音量&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Record Vol&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;混响&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Reverberation&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">31</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;高音&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;High&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;低音&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bass&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">33</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;伴奏音量&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Accomp Vol&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;zh&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;监听音量&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;en&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Monitor Vol&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p><strong>字段说明</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>字段</p></th>
<th class="head"><p>描述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>区分分类</p></td>
</tr>
<tr class="row-odd"><td><p>title</p></td>
<td><p>标题</p></td>
</tr>
<tr class="row-even"><td><p>icon_url</p></td>
<td><p>项目图标链接</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><div class="line-block">
<div class="line">子项的控件类型：</div>
<div class="line">目前支持：</div>
<div class="line">img_select(可以设置图片),select,slider</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>column</p></td>
<td><div class="line-block">
<div class="line">控件列数，</div>
<div class="line">当type==slider,无效</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>row</p></td>
<td><div class="line-block">
<div class="line">控件行数，</div>
<div class="line">需要结合colume使用且paging==true有效</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>paging</p></td>
<td><div class="line-block">
<div class="line">控件的唯一表示码，全局唯一，</div>
<div class="line">group为true时,index无效</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>max</p></td>
<td><div class="line-block">
<div class="line">最大值,</div>
<div class="line">type==slider时有效</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>group</p></td>
<td><div class="line-block">
<div class="line">是否组类型,</div>
<div class="line">true则没有index字段,当type为select有效</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>enable</p></td>
<td><div class="line-block">
<div class="line">slider类型有效,</div>
<div class="line">true:app可以调节, false:app不可已调节</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>注意事项:该sound_card_json.txt在服务器上也有一份，当服务器请求失败，才会从本地读取。</p>
<section id="id83">
<h4>2.12.3.1 使用范例<a class="headerlink" href="#id83" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// NSData转换成NSDictionary</span>
<span class="p">-(</span><span class="kt">id</span><span class="p">)</span><span class="nf">jsonWithData:</span><span class="p">(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nv">data</span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">nil</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="kt">id</span><span class="w"> </span><span class="n">dic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSJSONSerialization</span><span class="w"> </span><span class="n">JSONObjectWithData</span><span class="o">:</span><span class="n">data</span><span class="w"></span>
<span class="w">                                            </span><span class="nl">options</span><span class="p">:</span><span class="n">NSJSONReadingMutableLeaves</span><span class="w"></span>
<span class="w">                                              </span><span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">dic</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 请求本地Json文件</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">requestLocalJson</span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSBundle</span><span class="w"> </span><span class="n">mainBundle</span><span class="p">]</span><span class="w"> </span><span class="n">pathForResource</span><span class="o">:</span><span class="s">@&quot;sound_card_json.txt&quot;</span><span class="w"> </span><span class="n">ofType</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">localData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSData</span><span class="w"> </span><span class="n">dataWithContentsOfFile</span><span class="o">:</span><span class="n">path</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="n">dic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">jsonWithData</span><span class="o">:</span><span class="n">localData</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">parseJson</span><span class="o">:</span><span class="n">dic</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 解析Json文件</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">parseJson:</span><span class="p">(</span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="p">)</span> <span class="nv">dic</span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">hasEq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dic</span><span class="p">[</span><span class="s">@&quot;hasEq&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">tempArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="n">functionArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dic</span><span class="p">[</span><span class="s">@&quot;function&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">functionArray</span><span class="p">.</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="n">KalaokModel</span><span class="w"> </span><span class="o">*</span><span class="n">myModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">KalaokModel</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">functionArray</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">mId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;id&quot;</span><span class="p">]</span><span class="w"> </span><span class="n">integerValue</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">zh_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;title&quot;</span><span class="p">][</span><span class="s">@&quot;zh&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">en_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;title&quot;</span><span class="p">][</span><span class="s">@&quot;en&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;type&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">icon_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;icon_url&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">column</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;column&quot;</span><span class="p">]</span><span class="w"> </span><span class="n">integerValue</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;row&quot;</span><span class="p">]</span><span class="w"> </span><span class="n">integerValue</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">paging</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;paging&quot;</span><span class="p">]</span><span class="w"> </span><span class="n">boolValue</span><span class="p">];</span><span class="w"></span>
<span class="w">       </span><span class="n">myModel</span><span class="p">.</span><span class="n">mList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">@&quot;list&quot;</span><span class="p">];</span><span class="w"></span>

<span class="w">       </span><span class="p">[</span><span class="n">tempArray</span><span class="w"> </span><span class="n">addObject</span><span class="o">:</span><span class="n">myModel</span><span class="p">];</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="n">NSLog</span><span class="p">(</span><span class="s">&quot;获取到的Json数组 %@&quot;</span><span class="p">,</span><span class="n">tempArray</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id84">
<h2>2.13 查找设备功能<a class="headerlink" href="#id84" title="永久链接至标题"></a></h2>
<section id="id85">
<h3>2.13.1 功能描述<a class="headerlink" href="#id85" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>接收到设备的命令后，通过播放手机的音频，从而使用户找到手机，或手机通过发送命令到设备，设备发出声响。</p>
</div></blockquote>
</section>
<section id="id86">
<h3>2.13.2 示例代码<a class="headerlink" href="#id86" title="永久链接至标题"></a></h3>
<p>设备查找手机的通知，携带了响铃时长</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">kJL_BT_FIND_PHONE</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>查找设备命令</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">/// 查找设备命令</span>
<span class="w">  </span><span class="c1">/// @param isVoice 是否发声</span>
<span class="w">  </span><span class="c1">/// @param timeout 超时时间</span>
<span class="w">  </span><span class="c1">/// @param isIphone 是否设备查找手机（默认是手机找设备）</span>
<span class="w">  </span><span class="c1">/// @param opDict 这是一个可选项，若tws未连接，则该值无效，默认是全部播放</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdFindDevice:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">isVoice</span><span class="w"></span>
<span class="w">            </span><span class="nl">timeOut</span><span class="p">:(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="nv">timeout</span><span class="w"></span>
<span class="w">         </span><span class="nl">findIphone</span><span class="p">:(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">isIphone</span><span class="w"></span>
<span class="w">          </span><span class="nl">Operation</span><span class="p">:(</span><span class="w"> </span><span class="bp">NSDictionary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="p">)</span><span class="nv">opDict</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="id87">
<h4>2.13.2.1 使用范例<a class="headerlink" href="#id87" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">[[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mFindDeviceManager</span><span class="w"> </span><span class="n">cmdFindDevice</span><span class="o">:</span><span class="nb">NO</span><span class="w"> </span><span class="n">timeOut</span><span class="o">:</span><span class="mi">10</span><span class="w"> </span><span class="n">findIphone</span><span class="o">:</span><span class="nb">YES</span><span class="w"> </span><span class="n">Operation</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id88">
<h2>2.14 用户自定义命令功能<a class="headerlink" href="#id88" title="永久链接至标题"></a></h2>
<section id="id89">
<h3>2.14.1 功能描述<a class="headerlink" href="#id89" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>通过此接口可以收发自定义数据。</p>
</div></blockquote>
</section>
<section id="id90">
<h3>2.14.2 示例代码<a class="headerlink" href="#id90" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//发送自定义数据</span>
<span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSData</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="p">[[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">.</span><span class="n">mCustomManager</span><span class="w"> </span><span class="n">cmdCustomData</span><span class="o">:</span><span class="n">data</span><span class="w"> </span><span class="n">isNeedResponse</span><span class="o">:</span><span class="nb">YES</span><span class="w"></span>
<span class="w">                                                    </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                             </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;发数成功...&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;发数失败~&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>

<span class="c1">//接收自定义数据</span>
<span class="p">[</span><span class="n">JL_Tools</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="n">kJL_MANAGER_CUSTOM_DATA</span><span class="w"> </span><span class="n">Action</span><span class="o">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">noteCustomData</span><span class="o">:</span><span class="p">)</span><span class="w"> </span><span class="n">Own</span><span class="o">:</span><span class="nb">self</span><span class="p">];</span><span class="w"></span>

<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">noteCustomData:</span><span class="p">(</span><span class="bp">NSNotification</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">note</span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">note</span><span class="p">.</span><span class="n">object</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">&quot;固件返回的自定义数据:%@&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id91">
<h3>2.14.3 注意事项<a class="headerlink" href="#id91" title="永久链接至标题"></a></h3>
<p>发数成功会有<code class="docutils literal notranslate"><span class="pre">JL_CMDStatusSuccess</span></code>回调。</p>
</section>
</section>
<section id="ota">
<h2>2.15 OTA<a class="headerlink" href="#ota" title="永久链接至标题"></a></h2>
<section id="id92">
<h3>2.15.1 功能描述<a class="headerlink" href="#id92" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>对设备进行升级,详细版参考：<a class="reference external" href="https://doc.zh-jieli.com/Apps/iOS/ota/zh-cn/master/index.html">【杰理OTA升级(iOS)开发说明】</a></p>
</div></blockquote>
</section>
<section id="id93">
<h3>2.15.2 使用demo<a class="headerlink" href="#id93" title="永久链接至标题"></a></h3>
<section id="id94">
<h4>2.15.2.1 OTA升级文件下载<a class="headerlink" href="#id94" title="永久链接至标题"></a></h4>
<p>若使用杰理提供的服务器资源，则协商后可使用以下接口进行升级文件下载。</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">OTA升级文件下载</span>
<span class="cm">@param key 授权key</span>
<span class="cm">@param code 授权code</span>
<span class="cm">@param result 回复</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdGetOtaFileKey:</span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">key</span><span class="w"></span>
<span class="nl">Code</span><span class="p">:(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">code</span><span class="w"></span>
<span class="nl">Result</span><span class="p">:(</span><span class="n">JL_OTA_URL</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="cm">/**</span>
<span class="cm">OTA升级文件下载【MD5】</span>
<span class="cm">@param key 授权key</span>
<span class="cm">@param code 授权code</span>
<span class="cm">@param hash  MD5值</span>
<span class="cm">@param result 回复</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdGetOtaFileKey:</span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">key</span><span class="w"></span>
<span class="w">                   </span><span class="nl">Code</span><span class="p">:(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">code</span><span class="w"></span>
<span class="w">                   </span><span class="nl">hash</span><span class="p">:(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">hash</span><span class="w"></span>
<span class="w">                 </span><span class="nl">Result</span><span class="p">:(</span><span class="n">JL_OTA_URL</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id95">
<h4>2.15.2.2 OTA升级设备<a class="headerlink" href="#id95" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">OTA升级设备</span>
<span class="cm">@param data 升级数据</span>
<span class="cm">@param result 升级结果</span>
<span class="cm">*/</span><span class="w"></span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdOTAData:</span><span class="p">(</span><span class="bp">NSData</span><span class="o">*</span><span class="p">)</span><span class="nv">data</span><span class="w"></span>
<span class="nl">Result</span><span class="p">:(</span><span class="n">JL_OTA_RT</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id96">
<h4>2.15.2.3 OTA的升级状态<a class="headerlink" href="#id96" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_OtaStatusNormal</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">    </span><span class="c1">//正常升级</span>
<span class="n">JL_OtaStatusForce</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">    </span><span class="c1">//强制升级</span>
</pre></div>
</div>
</section>
<section id="id97">
<h4>2.15.2.4 OTA的返回结果<a class="headerlink" href="#id97" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">JL_OTAResultSuccess</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA升级成功</span>
<span class="n">JL_OTAResultFail</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA升级失败</span>
<span class="n">JL_OTAResultDataIsNull</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA升级数据为空</span>
<span class="n">JL_OTAResultCommandFail</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA指令失败</span>
<span class="n">JL_OTAResultSeekFail</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA标示偏移查找失败</span>
<span class="n">JL_OTAResultInfoFail</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA升级固件信息错误</span>
<span class="n">JL_OTAResultLowPower</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA升级设备电压低</span>
<span class="n">JL_OTAResultEnterFail</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mh">0x07</span><span class="p">,</span><span class="w"> </span><span class="c1">//未能进入OTA升级模式</span>
<span class="n">JL_OTAResultUpgrading</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mh">0x08</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA升级中</span>
<span class="n">JL_OTAResultReconnect</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mh">0x09</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA需重连设备</span>
<span class="n">JL_OTAResultReboot</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0a</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA需设备重启</span>
<span class="n">JL_OTAResultPreparing</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0b</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA准备中</span>
<span class="n">JL_OTAResultPrepared</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0f</span><span class="p">,</span><span class="w"> </span><span class="c1">//OTA准备完成</span>
<span class="n">JL_OTAResultFailVerification</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf1</span><span class="p">,</span><span class="w"> </span><span class="c1">//升级数据校验失败</span>
<span class="n">JL_OTAResultFailCompletely</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf2</span><span class="p">,</span><span class="w"> </span><span class="c1">//升级失败</span>
<span class="n">JL_OTAResultFailKey</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf3</span><span class="p">,</span><span class="w"> </span><span class="c1">//升级数据校验失败</span>
<span class="n">JL_OTAResultFailErrorFile</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf4</span><span class="p">,</span><span class="w"> </span><span class="c1">//升级文件出错</span>
<span class="n">JL_OTAResultFailUboot</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf5</span><span class="p">,</span><span class="w"> </span><span class="c1">//uboot不匹配</span>
<span class="n">JL_OTAResultFailLenght</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf6</span><span class="p">,</span><span class="w"> </span><span class="c1">//升级过程长度出错</span>
<span class="n">JL_OTAResultFailFlash</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf7</span><span class="p">,</span><span class="w"> </span><span class="c1">//升级过程flash读写失败</span>
<span class="n">JL_OTAResultFailCmdTimeout</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf8</span><span class="p">,</span><span class="w"> </span><span class="c1">//升级过程指令超时</span>
<span class="n">JL_OTAResultFailSameVersion</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf9</span><span class="p">,</span><span class="w"> </span><span class="c1">//相同版本</span>
<span class="n">JL_OTAResultFailTWSDisconnect</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfa</span><span class="p">,</span><span class="w"> </span><span class="c1">//TWS耳机未连接</span>
<span class="n">JL_OTAResultFailNotInBin</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">0xfb</span><span class="p">,</span><span class="w"> </span><span class="c1">//耳机未在充电仓</span>
<span class="n">JL_OTAResultUnknown</span><span class="p">,</span><span class="w">                    </span><span class="c1">//OTA未知错误</span>
</pre></div>
</div>
</section>
<section id="md5">
<h4>2.15.2.5 获取MD5的数据<a class="headerlink" href="#md5" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cp">#pragma mark 获取MD5数据</span>
<span class="p">+(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdGetMD5_Result:</span><span class="p">(</span><span class="n">JL_CMD_BK</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id98">
<h4>2.15.2.6 版本校对,并获取升级文件<a class="headerlink" href="#id98" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">checkVersion</span><span class="p">{</span><span class="w"></span>

<span class="cp">#if (LT==0)</span>

<span class="c1">//    //有新版本</span>
<span class="c1">//    self-&gt;shouldUp = YES;</span>
<span class="c1">//    self-&gt;downloadUrl = [JL_Tools find:@&quot;update_yx_hp_93.ufw&quot;];</span>
<span class="c1">//    savePath = [JL_Tools find:@&quot;update_yx_hp_93.ufw&quot;];</span>
<span class="c1">//    dispatch_async(dispatch_get_main_queue(), ^{</span>
<span class="c1">//        [self-&gt;upgradeView initWithNews:@&quot;1.0.0.0&quot; tips:@&quot;升级测试&quot;];</span>
<span class="c1">//        [self.view addSubview:self-&gt;upgradeView];</span>
<span class="c1">//    });</span>
<span class="c1">//    [self.upgradeTable reloadData];</span>
<span class="c1">//    return;</span>

<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">md5Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">YES</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/*---- OTA升级使用MD5校验 ----*/</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetMD5_Result</span><span class="o">:^</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">array</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">data_md5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">str_md5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithData</span><span class="o">:</span><span class="n">data_md5</span><span class="w"> </span><span class="n">encoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;MD5 ----&gt; %@&quot;</span><span class="p">,</span><span class="n">str_md5</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="c1">//NSString* test = @&quot;eb5eaa7e89664adc2c840230fc494656&quot;;</span>
<span class="w">                </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetOtaFileKey</span><span class="o">:</span><span class="n">model</span><span class="p">.</span><span class="n">authKey</span><span class="w"> </span><span class="n">Code</span><span class="o">:</span><span class="n">model</span><span class="p">.</span><span class="n">proCode</span><span class="w"> </span><span class="n">hash</span><span class="o">:</span><span class="n">str_md5</span><span class="w"></span>
<span class="w">                                      </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">JL_OTAUrlResult</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">url</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">explain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">updateWithOTAResult</span><span class="o">:</span><span class="n">result</span><span class="w"> </span><span class="n">Version</span><span class="o">:</span><span class="n">version</span><span class="w"> </span><span class="n">Url</span><span class="o">:</span><span class="n">url</span><span class="w"> </span><span class="n">Explain</span><span class="o">:</span><span class="n">explain</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="p">}];</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/*--- 传统OTA升级 ---*/</span><span class="w"></span>
<span class="w">        </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">authKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">proCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">model</span><span class="p">.</span><span class="n">authKey</span><span class="w"> </span><span class="n">isEqualToString</span><span class="o">:</span><span class="s">@&quot;&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="n">proCode</span><span class="w"> </span><span class="n">isEqualToString</span><span class="o">:</span><span class="s">@&quot;&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">            </span><span class="n">DeviceModel</span><span class="w"> </span><span class="o">*</span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">SqliteManager</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">]</span><span class="w"> </span><span class="n">checkoutDeviceModelBy</span><span class="o">:</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mUUID</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="n">authKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="p">.</span><span class="n">authKey</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">proCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="p">.</span><span class="n">proCode</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">authKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">authKey</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">proCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">proCode</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdGetOtaFileKey</span><span class="o">:</span><span class="n">authKey</span><span class="w"> </span><span class="n">Code</span><span class="o">:</span><span class="n">proCode</span><span class="w"></span>
<span class="w">                              </span><span class="nl">Result</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">JL_OTAUrlResult</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">url</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">explain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">updateWithOTAResult</span><span class="o">:</span><span class="n">result</span><span class="w"> </span><span class="n">Version</span><span class="o">:</span><span class="n">version</span><span class="w"> </span><span class="n">Url</span><span class="o">:</span><span class="n">url</span><span class="w"> </span><span class="n">Explain</span><span class="o">:</span><span class="n">explain</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="cp">#else</span>
<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">outputDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">authKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">proCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">model</span><span class="p">.</span><span class="n">authKey</span><span class="w"> </span><span class="n">isEqualToString</span><span class="o">:</span><span class="s">@&quot;&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="n">proCode</span><span class="w"> </span><span class="n">isEqualToString</span><span class="o">:</span><span class="s">@&quot;&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">        </span><span class="n">DeviceModel</span><span class="w"> </span><span class="o">*</span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">SqliteManager</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">]</span><span class="w"> </span><span class="n">checkoutDeviceModelBy</span><span class="o">:</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mUUID</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">authKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="p">.</span><span class="n">authKey</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">proCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="p">.</span><span class="n">proCode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">authKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">authKey</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">proCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">proCode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">//有新版本</span>
<span class="w">    </span><span class="n">shouldUp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">YES</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span><span class="w"> </span><span class="n">NSUserDomainMask</span><span class="p">,</span><span class="w"> </span><span class="nb">YES</span><span class="p">)</span><span class="w"> </span><span class="n">firstObject</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">path</span><span class="w"> </span><span class="n">stringByAppendingPathComponent</span><span class="o">:</span><span class="s">@&quot;update.ufw&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">savePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">upgradeView</span><span class="w"> </span><span class="n">initWithNews</span><span class="o">:</span><span class="s">@&quot;Max&quot;</span><span class="w"> </span><span class="n">tips</span><span class="o">:</span><span class="s">@&quot;无限制升级&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="w"> </span><span class="n">addSubview</span><span class="o">:</span><span class="n">upgradeView</span><span class="p">];</span><span class="w"></span>


<span class="cp">#endif</span>

<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id99">
<h4>2.15.2.7 执行OTA升级<a class="headerlink" href="#id99" title="永久链接至标题"></a></h4>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdOTAData</span><span class="o">:</span><span class="n">data</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_OTAResult</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">transportView</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="mf">1.0</span><span class="w"> </span><span class="n">Text</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">transportView</span><span class="p">.</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="p">[[</span><span class="n">JLUI_Cache</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">]</span><span class="w"> </span><span class="n">setOtaUUID</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">upgradeFinish</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultFail</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA升级失败&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultDataIsNull</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA升级数据为空!&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultCommandFail</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA指令失败!&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultSeekFail</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA标示偏移查找失败!&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultInfoFail</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA升级固件信息错误!&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultLowPower</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA升级设备电压低!&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultEnterFail</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;未能进入OTA升级模式!&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultUnknown</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA未知错误!&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultFailSameVersion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;相同版本！&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultFailTWSDisconnect</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;TWS耳机未连接&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultFailNotInBin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;耳机未在充电仓&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultPreparing</span><span class="w"> </span><span class="o">||</span><span class="w"></span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultUpgrading</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultUpgrading</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">transportView</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="n">progress</span><span class="w"> </span><span class="n">Text</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;正在升级&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultPreparing</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">transportView</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="n">progress</span><span class="w"> </span><span class="n">Text</span><span class="o">:</span><span class="s">@&quot;检验文件&quot;</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">otaTimeCheck</span><span class="p">];</span><span class="c1">//增加超时检测</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultPrepared</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">otaTimeCheck</span><span class="p">];</span><span class="c1">//增加超时检测</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_OTAResultReconnect</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">otaTimeCheck</span><span class="p">];</span><span class="c1">//增加超时检测</span>

<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;---&gt; OTA正在回连设备... %@&quot;</span><span class="p">,</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="p">.</span><span class="n">mItem</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="o">-&gt;</span><span class="n">bleSDK</span><span class="p">.</span><span class="n">mBleMultiple</span><span class="w"> </span><span class="n">connectEntity</span><span class="o">:</span><span class="nb">self</span><span class="p">.</span><span class="n">otaEntity</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_EntityM_Status</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">JL_EntityM_StatusPaired</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="p">[</span><span class="n">weakSelf</span><span class="w"> </span><span class="n">failedWithAction</span><span class="o">:</span><span class="n">kJL_TXT</span><span class="p">(</span><span class="s">&quot;OTA升级超时&quot;</span><span class="p">)];</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id100">
<h2>2.16 设备提示音替换<a class="headerlink" href="#id100" title="永久链接至标题"></a></h2>
<section id="id101">
<h3>2.16.1 功能描述<a class="headerlink" href="#id101" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>对设备端的提示音进行批量更换</p>
</div></blockquote>
</section>
<section id="wts">
<h3>2.16.2 音频文件转码 .WTS<a class="headerlink" href="#wts" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>将PCM音频文件转换为.WTS特殊格式的文件，当前要求的PCM文件参数为：
采样率: 16000
声道数: 1
位深: 16
采样格式: 16位 PCM</p>
</div></blockquote>
<p>代码示例参考如下：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="c1">//这里是先从本地的沙盒中读取文件，然后转换为WTS格式</span>
<span class="kd">let</span> <span class="nv">wtsPath</span> <span class="p">=</span> <span class="n">R</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">tipsVoice</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">model</span><span class="p">.</span><span class="n">fileName</span>
<span class="k">try</span><span class="p">?</span><span class="n">FileManager</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">atPath</span><span class="p">:</span> <span class="n">wtsPath</span><span class="p">)</span>
<span class="n">JLPcmToWts</span><span class="p">.</span><span class="n">share</span><span class="p">().</span><span class="n">pcm</span><span class="p">(</span><span class="n">toWts</span><span class="p">:</span> <span class="n">R</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">library</span><span class="o">+</span><span class="s">&quot;/temp.pcm&quot;</span><span class="p">,</span> <span class="n">bitOutFileName</span><span class="p">:</span> <span class="n">wtsPath</span><span class="p">,</span> <span class="n">targetRate</span><span class="p">:</span> <span class="mi">20000</span><span class="p">,</span> <span class="n">sr_in</span><span class="p">:</span> <span class="mi">16000</span><span class="p">,</span> <span class="n">vadthr</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">usesavemodef</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="n">status</span><span class="p">,</span> <span class="n">data</span> <span class="p">,</span><span class="n">path</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">status</span><span class="p">{</span>
        <span class="n">ECPrintDebug</span><span class="p">(</span><span class="s">&quot;pcm2wts success&quot;</span><span class="p">,</span> <span class="kc">self</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">\(</span><span class="kc">#function</span><span class="si">)</span><span class="s">&quot;</span><span class="p">,</span> <span class="kc">#line</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">&quot;生成成功&quot;</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">finishIndex</span><span class="o">+=</span><span class="mi">1</span>
        <span class="kd">let</span> <span class="nv">md</span> <span class="p">=</span> <span class="n">TipsVoiceModel</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="n">model</span><span class="p">.</span><span class="n">nickName</span> <span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="n">model</span><span class="p">.</span><span class="n">fileName</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">wtsPath</span><span class="p">,</span> <span class="n">type</span><span class="p">:</span> <span class="kc">false</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">tipsVoiceInfos</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">md</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">subTable</span><span class="p">.</span><span class="n">reloadData</span><span class="p">()</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">tipsView</span><span class="p">.</span><span class="n">isHidden</span> <span class="p">=</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>接口参考：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// PCM 转换 WTS</span>
<span class="k">@interface</span> <span class="nc">JLPcmToWts</span> : <span class="bp">NSObject</span><span class="w"></span>

<span class="c1">/// 单例</span>
<span class="p">+(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">share</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// PCM 文件编码 WTS 文件</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - speechInFileName: PCM 文件路径</span>
<span class="c1">///   - bitOutFileName: WTS 文件路径</span>
<span class="c1">///   - targetRate: wts 文件的目标码率</span>
<span class="c1">///   - sr_in: pcm 文件的采样率</span>
<span class="c1">///   - vadthr: vad 阈值</span>
<span class="c1">///   - usesavemodef: 0:位流优先 1:质量优先</span>
<span class="c1">///   - block: 数据回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">pcmToWts:</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">speechInFileName</span><span class="w"> </span><span class="nf">bitOutFileName:</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">bitOutFileName</span><span class="w"> </span><span class="nf">targetRate:</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nv">targetRate</span><span class="w"> </span><span class="nf">sr_in:</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nv">sr_in</span><span class="w"> </span><span class="nf">vadthr:</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nv">vadthr</span><span class="w"> </span><span class="nf">usesavemodef:</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nv">usesavemodef</span><span class="w"> </span><span class="nf">Result:</span><span class="p">(</span><span class="n">wtsResultBlock</span><span class="p">)</span><span class="nv">block</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id102">
<h3>2.16.3 打包/解包音频文件<a class="headerlink" href="#id102" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>提示音替换时，需要对多个WTS文件进行打包，然后传输给到设备</p>
<p>注意：打包后的文件不能超过设备所支持的最大空间值，具体可以参考查询命令 <strong>voicesReplaceGetVoiceInfo</strong> 的返回值</p>
</div></blockquote>
<p>示例代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nv">paths</span> <span class="p">=</span> <span class="p">[</span><span class="nb">String</span><span class="p">]()</span><span class="c1">//存放WTS文件的路径</span>
<span class="kd">var</span> <span class="nv">names</span> <span class="p">=</span> <span class="p">[</span><span class="nb">String</span><span class="p">]()</span><span class="c1">//存放WTS文件的名字</span>
<span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="kc">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">value</span><span class="p">{</span>
    <span class="k">if</span> <span class="n">item</span><span class="p">.</span><span class="n">type</span><span class="p">{</span>
        <span class="n">paths</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">names</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">nickName</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="n">paths</span><span class="p">.</span><span class="bp">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">{</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">statusLab</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">&quot;正在生成...&quot;</span>

    <span class="kd">let</span> <span class="nv">dt</span> <span class="p">=</span> <span class="n">JLVoicePackageManager</span><span class="p">.</span><span class="n">makePks</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">fileNames</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span><span class="n">info</span><span class="p">:</span> <span class="n">info</span><span class="p">)</span>

    <span class="kc">self</span><span class="p">.</span><span class="n">statusLab</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">&quot;生成成功&quot;</span>
    <span class="kd">let</span> <span class="nv">filePath</span> <span class="p">=</span> <span class="n">R</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">document</span><span class="o">+</span><span class="s">&quot;/tone.cfg&quot;</span>
    <span class="k">try</span><span class="p">?</span><span class="n">FileManager</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">atPath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
    <span class="n">FileManager</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">createFile</span><span class="p">(</span><span class="n">atPath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">contents</span><span class="p">:</span> <span class="n">dt</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>接口说明：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 打包多个 .wts 文件成 tone.cfg 数据</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - paths: 文件存放路径</span>
<span class="c1">///   - names: 文件在设备端使用时的名称</span>
<span class="c1">///   - info: 设备限制的信息</span>
<span class="p">+(</span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nf">makePks:</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">paths</span><span class="w"> </span><span class="nf">FileNames:</span><span class="p">(</span><span class="bp">NSArray</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">names</span><span class="w"> </span><span class="nf">Info:</span><span class="p">(</span><span class="n">JLVoiceReplaceInfo</span><span class="o">*</span><span class="p">)</span><span class="nv">info</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 解包 tone.cfg 数据</span>
<span class="c1">/// - Parameter data: tone.cfg 数据</span>
<span class="p">+(</span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLToneCfgModel</span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nf">parsePks:</span><span class="p">(</span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">data</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 当前 SDK 版本</span>
<span class="p">+(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nf">getVersion</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id103">
<h3>2.16.4 获取设备的提示音信息<a class="headerlink" href="#id103" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>获取设备的提示音信息，用于提示音替换</p>
</div></blockquote>
<p>示例代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="k">guard</span> <span class="kd">let</span> <span class="nv">cmdMgr</span> <span class="p">=</span> <span class="n">BleManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">currentCmdMgr</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
<span class="kd">let</span> <span class="nv">voiceReplace</span> <span class="p">=</span> <span class="n">JLVoicePackageManager</span><span class="p">.</span><span class="n">share</span><span class="p">()</span>
<span class="n">voiceReplace</span><span class="p">.</span><span class="n">voicesReplaceGetVoiceInfo</span><span class="p">(</span><span class="n">cmdMgr</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="p">{</span> <span class="n">cmdStatus</span> <span class="p">,</span><span class="n">info</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">cmdStatus</span> <span class="o">!=</span> <span class="p">.</span><span class="n">success</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">&quot;请求设备信息错误：</span><span class="si">\(</span><span class="n">cmdStatus</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">voiceInfo</span> <span class="p">=</span> <span class="n">info</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="nv">info</span> <span class="p">=</span> <span class="n">info</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">infoLab</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">&quot;文件数目：&quot;</span> <span class="o">+</span> <span class="nb">String</span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">maxNum</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">文件名称：&quot;</span> <span class="o">+</span> <span class="n">info</span><span class="p">.</span><span class="n">fileName</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">预留区域大小：&quot;</span> <span class="o">+</span> <span class="nb">String</span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">blockSize</span><span class="p">)</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">accept</span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">infoArray</span><span class="p">)</span>

<span class="p">})</span>
</pre></div>
</div>
<p>接口说明：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 单例</span>
<span class="p">+(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">share</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 是否处于替换中</span>
<span class="p">-(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">isReplacing</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 是否支持提示音替换查询</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - result: 回调结果</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">isSupportTipsVoiceReplace:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JLConfigTwsRsp</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 获取设备端提示音的信息</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - result: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">voicesReplaceGetVoiceInfo:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">Result:</span><span class="p">(</span><span class="n">JLTipsVoiceBlock</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id104">
<h3>2.16.5 替换设备的提示音<a class="headerlink" href="#id104" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>替换设备的提示音</p>
</div></blockquote>
<p>示例代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="k">guard</span> <span class="kd">let</span> <span class="nv">cmdMgr</span> <span class="p">=</span> <span class="n">BleManager</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">currentCmdMgr</span> <span class="k">else</span><span class="p">{</span><span class="k">return</span><span class="p">}</span>
<span class="kd">let</span> <span class="nv">filePath</span> <span class="p">=</span> <span class="n">R</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">document</span><span class="o">+</span><span class="s">&quot;/tone.cfg&quot;</span>
<span class="kd">let</span> <span class="nv">url</span> <span class="p">=</span> <span class="n">URL</span><span class="p">(</span><span class="n">fileURLWithPath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span>
<span class="k">guard</span> <span class="kd">let</span> <span class="nv">dt</span> <span class="p">=</span> <span class="k">try</span><span class="p">?</span><span class="n">Data</span><span class="p">(</span><span class="n">contentsOf</span><span class="p">:</span><span class="n">url</span><span class="p">)</span> <span class="k">else</span><span class="p">{</span><span class="k">return</span><span class="p">}</span>
<span class="kd">let</span> <span class="nv">model</span> <span class="p">=</span> <span class="n">cmdMgr</span><span class="p">.</span><span class="n">getDeviceModel</span><span class="p">()</span>

<span class="kc">self</span><span class="p">.</span><span class="n">voiceManager</span><span class="p">.</span><span class="n">voicesReplacePushDataRequest</span><span class="p">(</span><span class="n">cmdMgr</span><span class="p">,</span> <span class="n">devHandle</span><span class="p">:</span><span class="n">model</span><span class="p">.</span><span class="n">cardInfo</span><span class="p">.</span><span class="n">flashHandle</span> <span class="p">,</span> <span class="n">tonePath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">isReborn</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="n">transportStatus</span><span class="p">,</span> <span class="n">progress</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">transportStatus</span><span class="p">{</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">transferStart</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;开始传输&quot;</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">transferDownload</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;传输中&quot;</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">progressView</span><span class="p">.</span><span class="n">progress</span> <span class="p">=</span> <span class="n">progress</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">statusLab</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">&quot;</span><span class="si">\(</span><span class="n">progress</span><span class="o">*</span><span class="mi">100</span><span class="si">)</span><span class="s">%&quot;</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">transferEnd</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;传输完成&quot;</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">&quot;传输完成&quot;</span><span class="p">,</span><span class="n">position</span><span class="p">:</span> <span class="p">.</span><span class="n">center</span><span class="p">)</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">transferOutOfRange</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;超出范围&quot;</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">&quot;超出范围&quot;</span><span class="p">,</span><span class="n">position</span><span class="p">:</span> <span class="p">.</span><span class="n">center</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">transferFail</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;传输失败&quot;</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">&quot;传输失败&quot;</span><span class="p">,</span><span class="n">position</span><span class="p">:</span> <span class="p">.</span><span class="n">center</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">crcError</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;CRC错误&quot;</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">&quot;CRC错误&quot;</span><span class="p">,</span><span class="n">position</span><span class="p">:</span> <span class="p">.</span><span class="n">center</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">outOfMemory</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;内存不足&quot;</span><span class="p">)</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">&quot;内存不足&quot;</span><span class="p">,</span><span class="n">position</span><span class="p">:</span> <span class="p">.</span><span class="n">center</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">transferCancel</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;取消传输&quot;</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">transferNoResponse</span><span class="p">:</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;没有响应&quot;</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="p">@</span><span class="n">unknown</span> <span class="k">default</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>接口说明：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 推送提示音数据到设备</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - mgr: 设备</span>
<span class="c1">///   - devhandle: 设备句柄，当前句柄需要通过获取设备存储信息获得，可参考 JLModel_Device 类的 cardInfo 属性，当设备不作要求时，此值填 0xffffffff</span>
<span class="c1">///   - path: 提示音本地存放路径</span>
<span class="c1">///   - isReborn: 完成后是否重启设备</span>
<span class="c1">///   - result: 回调结果</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">voicesReplacePushDataRequest:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">mgr</span><span class="w"> </span><span class="nf">DevHandle:</span><span class="p">(</span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">devhandle</span><span class="w"> </span><span class="nf">TonePath:</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">path</span><span class="w"> </span><span class="nf">IsReborn:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">isReborn</span><span class="w"> </span><span class="nf">Result:</span><span class="p">(</span><span class="n">JL_BIGFILE_RT</span><span class="w"> </span><span class="n">__nullable</span><span class="p">)</span><span class="nv">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="id105">
<span id="id106"></span><h2>2.17 带屏幕设备功能设置<a class="headerlink" href="#id105" title="永久链接至标题"></a></h2>
<section id="id107">
<h3>2.17.1 功能描述<a class="headerlink" href="#id107" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>如果开发者所使用设备为带屏设备，并支持RCSP协议，则可以使用以下的相关接口内容；
当前带屏幕设备设置功能主要包含了：</p>
<ol class="arabic simple">
<li><p>静态图片设置到设备以及动态图片设置到设备作为屏保；</p></li>
<li><p>屏幕亮度设置/获取</p></li>
<li><p>手电筒开关设置/获取</p></li>
</ol>
</div></blockquote>
</section>
<section id="id108">
<h3>2.17.2 屏幕亮度设置/获取<a class="headerlink" href="#id108" title="永久链接至标题"></a></h3>
<p>此类属于公共属性设置类，开发者可以在 <strong>JLPublicSetting</strong> 中进行获取和设置，具体接口如下：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 读取设备当前屏幕亮度</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - block: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdScreenLightGet:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JLPSScreenLightCbk</span><span class="p">)</span><span class="nv">block</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 设置设备的屏幕亮度</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - value: 亮度值 0～100</span>
<span class="c1">///   - block: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdScreenLightSet:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w">  </span><span class="nf">Value:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">value</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JLPSScreenLightCbk</span><span class="p">)</span><span class="nv">block</span><span class="p">;</span><span class="w"></span>

<span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">cmdMgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="k">__weak</span><span class="w"> </span><span class="nf">typeof</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span><span class="w"> </span><span class="n">weakSelf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span><span class="w"></span>

<span class="c1">//获取</span>
<span class="p">[</span><span class="n">publicSetting</span><span class="w"> </span><span class="n">cmdScreenLightGet</span><span class="o">:</span><span class="n">cmdMgr</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">__strong</span><span class="w"> </span><span class="nf">typeof</span><span class="p">(</span><span class="n">weakSelf</span><span class="p">)</span><span class="w"> </span><span class="n">strongSelf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weakSelf</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strongSelf</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">strongSelf</span><span class="o">-&gt;</span><span class="n">lightSetView</span><span class="w"> </span><span class="n">setLightValue</span><span class="o">:</span><span class="n">value</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>

<span class="c1">//设置</span>
<span class="p">[</span><span class="n">publicSetting</span><span class="w"> </span><span class="n">cmdScreenLightSet</span><span class="o">:</span><span class="n">cmdMgr</span><span class="w"> </span><span class="n">Value</span><span class="o">:</span><span class="mi">20</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id109">
<h3>2.17.3 手电筒设置/获取<a class="headerlink" href="#id109" title="永久链接至标题"></a></h3>
<p>此类属于公共属性设置类，开发者可以在 <strong>JLPublicSetting</strong> 中进行获取和设置，具体接口如下：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 读取手电筒开关</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - block: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdFlashLightGet:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JLPSFlashLightCbk</span><span class="p">)</span><span class="nv">block</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 设置手电筒开关</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - isOn: 开关</span>
<span class="c1">///   - block: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdFlashLightSet:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w">  </span><span class="nf">Status:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">isOn</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JLPSFlashLightCbk</span><span class="p">)</span><span class="nv">block</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id110">
<h3>2.17.4 当前设备使用的屏显信息获取<a class="headerlink" href="#id110" title="永久链接至标题"></a></h3>
<p>此类属于公共属性设置类，开发者可以在 <strong>JLPublicSetting</strong> 中进行获取，具体接口如下：</p>
<p>以下方法是用于获取当前设备所使用的资源信息：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 获取功能使用资源设置（彩屏舱）</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - funcType: 功能码</span>
<span class="c1">///   0x01 屏幕保护程序</span>
<span class="c1">///   0x02 开机动画</span>
<span class="c1">///   - block: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdDeviceFuncUsedSourceGet:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">Type:</span><span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="nv">funcType</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JLPSSourceInfoCbk</span><span class="p">)</span><span class="nv">block</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>屏幕的参数扩展内容获取，需要通过 <strong>JLDialInfoExtentManager</strong> 获取设备屏幕信息：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//// 屏幕参数扩展内容获取</span>
<span class="p">[[</span><span class="n">JLDialInfoExtentManager</span><span class="w"> </span><span class="n">share</span><span class="p">]</span><span class="w"> </span><span class="n">getDialInfoExtented</span><span class="o">:</span><span class="w"> </span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">JLDialInfoExtentedModel</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">op</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">setDialInfoExtentedModel</span><span class="o">:</span><span class="n">op</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;getDialInfoExtented fail :%d&quot;</span><span class="p">,</span><span class="n">status</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
<p><strong>设备 SDK 信息获取</strong>
获取内容的接口在 <strong>JLPublicSetting</strong> 中，可以通过 <strong>cmdDeviceGetDeviceSDKInfo</strong> 获取</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 获取设备 SDK 信息</span>
<span class="c1">/// - Parameters:</span>
<span class="c1">///   - manager: 设备</span>
<span class="c1">///   - block: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cmdDeviceGetDeviceSDKInfo:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">result:</span><span class="p">(</span><span class="n">JLPSSDKInfoCbk</span><span class="p">)</span><span class="nv">block</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>当前SDK信息包含了以下信息:</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 设备 SDK 信息</span>
<span class="k">@interface</span> <span class="nc">JLPublicSDKInfoModel</span> : <span class="bp">NSObject</span><span class="w"></span>

<span class="c1">/// 项目对应 ID</span>
<span class="c1">/// 0x0001 充电仓</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">projectId</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 产品对应 ID</span>
<span class="c1">/// 0x0001 彩屏舱</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">productId</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 芯片 ID</span>
<span class="c1">/// 0x0001 AC701N</span>
<span class="c1">/// 0x0002 AC707N</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">chipId</span><span class="p">;</span><span class="w"></span>

<span class="c1">/// 是否支持 gif</span>
<span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="kt">BOOL</span><span class="w"> </span><span class="n">isSupportGif</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>我们可以通过队列加载的形式来获取到对应内容：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//MARK: - 充电仓特殊处理</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">handleWithChargeBin</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JLModel_Device</span><span class="w"> </span><span class="o">*</span><span class="n">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">getDeviceModel</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dev</span><span class="p">.</span><span class="n">sdkType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_SDKTypeChargingCase</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">JLPublicSetting</span><span class="w"> </span><span class="o">*</span><span class="n">set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">publicSetMgr</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">mgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="p">.</span><span class="n">mBleEntityM</span><span class="p">.</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">JLTaskChain</span><span class="w"> </span><span class="o">*</span><span class="n">chain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLTaskChain</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="c1">//获取SDK信息</span>
<span class="w">        </span><span class="p">[</span><span class="n">chain</span><span class="w"> </span><span class="n">addTask</span><span class="o">:^</span><span class="p">(</span><span class="kt">id</span><span class="w">  </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">^</span><span class="w"> </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">completion</span><span class="p">)(</span><span class="kt">id</span><span class="w"> </span><span class="n">_Nullable</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">set</span><span class="w"> </span><span class="n">cmdDeviceGetDeviceSDKInfo</span><span class="o">:</span><span class="n">mgr</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">JLPublicSDKInfoModel</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_CMDStatusSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">setPublicSDKInfoModel</span><span class="o">:</span><span class="n">model</span><span class="p">];</span><span class="w"></span>
<span class="w">                    </span><span class="n">completion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">completion</span><span class="p">(</span><span class="nb">nil</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}];</span><span class="w"></span>
<span class="w">        </span><span class="p">}];</span><span class="w"></span>

<span class="w">        </span><span class="c1">//获取表盘信息</span>
<span class="w">        </span><span class="p">[</span><span class="n">chain</span><span class="w"> </span><span class="n">addTask</span><span class="o">:^</span><span class="p">(</span><span class="kt">id</span><span class="w">  </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">^</span><span class="w"> </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">completion</span><span class="p">)(</span><span class="kt">id</span><span class="w"> </span><span class="n">_Nullable</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">JLPublicSDKInfoModel</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">productId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x0001</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">chipId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x0002</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">].</span><span class="n">dialUnitMgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JLDialUnitMgr</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithManager</span><span class="o">:</span><span class="n">mgr</span><span class="w"> </span><span class="n">completion</span><span class="o">:^</span><span class="p">(</span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">completion</span><span class="p">(</span><span class="nb">nil</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">completion</span><span class="p">([</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">].</span><span class="n">dialUnitMgr</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}];</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">completion</span><span class="p">(</span><span class="nb">nil</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}];</span><span class="w"></span>

<span class="w">        </span><span class="c1">//获取表盘的文件数据</span>
<span class="w">        </span><span class="p">[</span><span class="n">chain</span><span class="w"> </span><span class="n">addTask</span><span class="o">:^</span><span class="p">(</span><span class="kt">id</span><span class="w">  </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">^</span><span class="w"> </span><span class="n">_Nonnull</span><span class="w"> </span><span class="n">completion</span><span class="p">)(</span><span class="kt">id</span><span class="w"> </span><span class="n">_Nullable</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">JLDialUnitMgr</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">manager</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="p">[</span><span class="n">manager</span><span class="w"> </span><span class="n">getFileList</span><span class="o">:</span><span class="n">JL_CardTypeFLASH</span><span class="w"> </span><span class="n">count</span><span class="o">:</span><span class="mi">100</span><span class="w"> </span><span class="n">completion</span><span class="o">:^</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLDialSourceModel</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">completion</span><span class="p">(</span><span class="nb">nil</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">completion</span><span class="p">(</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}];</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">completion</span><span class="p">(</span><span class="nb">nil</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}];</span><span class="w"></span>

<span class="w">        </span><span class="p">[</span><span class="n">chain</span><span class="w"> </span><span class="n">runWithInitialInput</span><span class="o">:</span><span class="nb">nil</span><span class="w"> </span><span class="n">completion</span><span class="o">:^</span><span class="p">(</span><span class="kt">id</span><span class="w">  </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;---&gt;update Get file list error.&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}];</span><span class="w"></span>

<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id111">
<h3>2.17.5 屏幕保护程序背景获取<a class="headerlink" href="#id111" title="永久链接至标题"></a></h3>
<p>此功能需要先对设备进行上述的获取屏幕参数后，才允许进行调用使用，否则会出现传过去的图片，设备端显示不匹配;
由于新旧业务的更迭，获取的方法需要先根据所获取到是设备SDK信息区分是哪一款芯片，然后在行获取。</p>
<ul class="simple">
<li><p>获取具体的芯片型号：</p></li>
</ul>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="p">-(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nf">witchChipType</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JLPublicSDKInfoModel</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">].</span><span class="n">publicSDKInfoModel</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">chipId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x02</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">productId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">projectId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x01</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;AC_707&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">chipId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">productId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">projectId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x02</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;AC_701&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">nil</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>若固件上 AC70N 系列的芯片，则使用如下的方法进行获取：</p></li>
</ul>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">request701NScreenSaver</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JLPublicSetting</span><span class="w"> </span><span class="o">*</span><span class="n">publicMgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="p">.</span><span class="n">publicSetMgr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">publicMgr</span><span class="w"> </span><span class="n">cmdDeviceFuncUsedSourceGet</span><span class="o">:</span><span class="n">manager</span><span class="w"> </span><span class="n">Type</span><span class="o">:</span><span class="mh">0x01</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">JLPublicSourceInfoModel</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//TODO: 处理返回的当前屏保信息内容</span>
<span class="w">    </span><span class="p">}];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>若固件上 AC707N 系列的芯片，则使用如下的方法进行获取：</p></li>
</ul>
<p>因为707N系列芯片是复用了表盘信息内容所以需要先初始化表盘内容，即系当前的设备有一个固定的空白表盘，当前轮番切换或者插入屏幕保护背景图片时，
等同于给手表设备进行表盘自定义背景的替换、切换。
以下内容需要接 <strong>2.17.4 当前设备使用的屏显信息获取</strong></p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">request707NScreenSaver</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">JLPublicSetting</span><span class="w"> </span><span class="o">*</span><span class="n">publicMgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="p">.</span><span class="n">publicSetMgr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="n">manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">].</span><span class="n">mCmdManager</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">JLDialUnitMgr</span><span class="w"> </span><span class="o">*</span><span class="n">dialUnitMgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">dialUnitMgr</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="c1">//请求设备端有多少个屏幕保护背景（表盘背景）列表</span>
<span class="w">    </span><span class="c1">//这里需要指定存储的句柄位置以及请求个数</span>
<span class="w">    </span><span class="p">[</span><span class="n">dialUnitMgr</span><span class="w"> </span><span class="n">getFileList</span><span class="o">:</span><span class="n">JL_CardTypeFLASH</span><span class="w"> </span><span class="n">count</span><span class="o">:</span><span class="mi">100</span><span class="w"> </span><span class="n">completion</span><span class="o">:^</span><span class="p">(</span><span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">JLDialSourceModel</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;---&gt;update Get file list error.&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;---&gt;update Get file list success.&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">JLDialSourceModel</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="p">[</span><span class="n">model</span><span class="w"> </span><span class="n">logProperties</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}];</span><span class="w"></span>

<span class="w">    </span><span class="c1">//请求当前正在使用的屏幕保护背景（表盘背景）</span>
<span class="w">    </span><span class="p">[</span><span class="n">dialUnitMgr</span><span class="w"> </span><span class="n">dialGetCurrentBackground</span><span class="o">:^</span><span class="p">(</span><span class="n">JLDialSourceModel</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">kJLLog</span><span class="p">(</span><span class="n">JLLOG_ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;---&gt;update Get file list success.%@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id112">
<h3>2.17.6 屏幕图片设置<a class="headerlink" href="#id112" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>若固件上 AC70N 系列的芯片，则使用如下的方法进行设置：</p></li>
</ul>
<p>此功能需要先对设备进行上述的获取屏幕参数后，才允许进行调用使用，否则会出现传过去的图片，设备端显示不匹配；</p>
<p>当所传输的图片是静态图时，使用以下的方法进行设置：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="n">JLDialInfoExtentedModel</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">dialInfoExtentedModel</span><span class="p">];</span><span class="w"></span>
<span class="n">CGSize</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span><span class="w"> </span><span class="mi">172</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="w"> </span><span class="n">size</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="bp">UIImage</span><span class="w"> </span><span class="o">*</span><span class="n">targetImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">UIImage</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"> </span><span class="c1">//FIXME: 目标图片</span>
<span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">imgData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLBmpConvert</span><span class="w"> </span><span class="n">resizeImage</span><span class="o">:</span><span class="n">targetImage</span><span class="w"> </span><span class="n">andResizeTo</span><span class="o">:</span><span class="n">size</span><span class="p">];</span><span class="w"></span>
<span class="n">JLBmpConvertOption</span><span class="w"> </span><span class="o">*</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JLBmpConvertOption</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"></span>
<span class="n">option</span><span class="p">.</span><span class="n">convertType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JLBmpConvertType701N_RBG</span><span class="p">;</span><span class="w"></span>
<span class="n">JLImageConvertResult</span><span class="w"> </span><span class="o">*</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLBmpConvert</span><span class="w"> </span><span class="n">convert</span><span class="o">:</span><span class="n">option</span><span class="w"> </span><span class="n">ImageData</span><span class="o">:</span><span class="n">imgData</span><span class="p">];</span><span class="w"></span>
<span class="c1">//开始传输屏幕保护程序</span>
<span class="p">[</span><span class="n">DialManager</span><span class="w"> </span><span class="n">addFile</span><span class="o">:</span><span class="s">@&quot;VIE_1&quot;</span><span class="w"> </span><span class="n">Content</span><span class="o">:</span><span class="n">result</span><span class="p">.</span><span class="n">outFileData</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">DialOperateType</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
<p>如果开发者所下发的图片是GIF的时候，需要先对图片进行转换才可以下发到设备，由于GIF的尺寸比较大，开发者需要先与固件端协商好所使用的GIF大小：
注意：这里还需要根据获取到的设备信息进行查看是否支持GIF</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gifUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;xxxxx/xxxxxx/xxxx.gif&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">//FIXME: - gifUrl</span>
<span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSData</span><span class="w"> </span><span class="n">dataWithContentsOfURL</span><span class="o">:</span><span class="n">gifUrl</span><span class="p">];</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">tmpBin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;%@/tmp.bin&quot;</span><span class="p">,[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSLibraryDirectory</span><span class="p">,</span><span class="w"> </span><span class="n">NSUserDomainMask</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="n">firstObject</span><span class="p">]];</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;VIE_1&quot;</span><span class="p">;</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;%@/%@.gif&quot;</span><span class="p">,</span><span class="n">gifUrl</span><span class="p">,</span><span class="n">fileName</span><span class="p">];</span><span class="w"></span>
<span class="k">__weak</span><span class="w"> </span><span class="nf">typeof</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span><span class="n">weakSelf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span><span class="w"></span>
<span class="p">[</span><span class="n">JLGifBin</span><span class="w"> </span><span class="n">makeDataToBin</span><span class="o">:</span><span class="n">data</span><span class="w"> </span><span class="n">Level</span><span class="o">:</span><span class="mi">1</span><span class="w"> </span><span class="n">ChipType</span><span class="o">:</span><span class="n">JLGIFBinChipJL_701N</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">binData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">__strong</span><span class="w"> </span><span class="nf">typeof</span><span class="p">(</span><span class="n">weakSelf</span><span class="p">)</span><span class="n">strongSelf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weakSelf</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">binData</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="bp">NSFileManager</span><span class="w"> </span><span class="o">*</span><span class="n">fm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSFileManager</span><span class="w"> </span><span class="n">defaultManager</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">fm</span><span class="w"> </span><span class="n">removeItemAtPath</span><span class="o">:</span><span class="n">tmpBin</span><span class="w"> </span><span class="n">error</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">fm</span><span class="w"> </span><span class="n">createFileAtPath</span><span class="o">:</span><span class="n">tmpBin</span><span class="w"> </span><span class="n">contents</span><span class="o">:</span><span class="n">binData</span><span class="w"> </span><span class="n">attributes</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;/%@.RES&quot;</span><span class="p">,</span><span class="n">fileName</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">DialManager</span><span class="w"> </span><span class="n">addFile</span><span class="o">:</span><span class="n">name</span><span class="w"> </span><span class="n">Content</span><span class="o">:</span><span class="n">binData</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">DialOperateType</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">progress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">        </span><span class="p">}];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>若固件上 AC707N 系列的芯片，则使用如下的方法进行获取：</p></li>
</ul>
<p>因为707N系列芯片是复用了表盘信息内容所以需要先初始化表盘内容，即系当前的设备有一个固定的空白表盘，当前轮番切换或者插入屏幕保护背景图片时，
等同于给手表设备进行表盘自定义背景的替换、切换。
以下内容需要接 <strong>2.17.4 当前设备使用的屏显信息获取</strong></p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="n">JLDialUnitMgr</span><span class="w"> </span><span class="o">*</span><span class="n">dialUnitMgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">dialUnitMgr</span><span class="p">];</span><span class="w"></span>
<span class="n">JLDialInfoExtentedModel</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">dialInfoExtentedModel</span><span class="p">];</span><span class="w"></span>
<span class="n">CGSize</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span><span class="w"> </span><span class="mi">172</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">model</span><span class="w"> </span><span class="n">size</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="bp">UIImage</span><span class="w"> </span><span class="o">*</span><span class="n">targetImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">UIImage</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"> </span><span class="c1">//FIXME: 目标图片</span>
<span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">imgData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLBmpConvert</span><span class="w"> </span><span class="n">resizeImage</span><span class="o">:</span><span class="n">targetImage</span><span class="w"> </span><span class="n">andResizeTo</span><span class="o">:</span><span class="n">size</span><span class="p">];</span><span class="w"></span>
<span class="n">JLBmpConvertOption</span><span class="w"> </span><span class="o">*</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JLBmpConvertOption</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"></span>
<span class="n">option</span><span class="p">.</span><span class="n">convertType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JLBmpConvertType701N_RBG</span><span class="p">;</span><span class="w"></span>
<span class="n">JLImageConvertResult</span><span class="w"> </span><span class="o">*</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JLBmpConvert</span><span class="w"> </span><span class="n">convert</span><span class="o">:</span><span class="n">option</span><span class="w"> </span><span class="n">ImageData</span><span class="o">:</span><span class="n">imgData</span><span class="p">];</span><span class="w"></span>

<span class="c1">//若为 GIF</span>
<span class="c1">//    [JLGifBin makeDataToBin:data Level:1 ChipType:JLGIFBinChipJL_701N Result:^(int code, NSData * _Nullable binData) {</span>
<span class="c1">//        __strong typeof(weakSelf)strongSelf = weakSelf;</span>
<span class="c1">//        if (code == 0 &amp;&amp; binData){</span>
<span class="c1">//            NSFileManager *fm = [NSFileManager defaultManager];</span>
<span class="c1">//            [fm removeItemAtPath:tmpBin error:nil];</span>
<span class="c1">//            [fm createFileAtPath:tmpBin contents:binData attributes:nil];</span>
<span class="c1">//</span>
<span class="c1">//            NSString *name = [NSString stringWithFormat:@&quot;/%@.RES&quot;,fileName];</span>
<span class="c1">//            //TODO: 上传文件</span>
<span class="c1">//        }</span>
<span class="c1">//    }];</span>

<span class="p">[</span><span class="n">dialUnitMgr</span><span class="w"> </span><span class="n">updateFileToDevice</span><span class="o">:</span><span class="n">JL_FileHandleTypeFLASH</span><span class="w"> </span><span class="n">Data</span><span class="o">:</span><span class="n">result</span><span class="p">.</span><span class="n">outFileData</span><span class="w"> </span><span class="n">FilePath</span><span class="o">:</span><span class="s">@&quot;/VIE_1&quot;</span><span class="w"> </span><span class="n">completion</span><span class="o">:^</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">progress</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//0:成功 1:传输中 -1:失败</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//失败</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//成功</span>

<span class="w">        </span><span class="c1">//激活表盘操作</span>
<span class="w">        </span><span class="n">JLDialSourceModel</span><span class="w"> </span><span class="o">*</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JLDialSourceModel</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;VIE_1&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">dialUnitMgr</span><span class="w"> </span><span class="n">dialActiveCustomBackground</span><span class="o">:</span><span class="n">model</span><span class="w"> </span><span class="n">Completion</span><span class="o">:^</span><span class="p">(</span><span class="kt">BOOL</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">        </span><span class="p">}];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//传输中</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id113">
<h3>2.17.7 同步天气到设备<a class="headerlink" href="#id113" title="永久链接至标题"></a></h3>
<p>此部分功能需要利用第三方服务，先获取了地理位置后再获取天气信息，具体使用可参考以下：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="n">AMapLocalWeatherLive</span><span class="w"> </span><span class="o">*</span><span class="n">live</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">lives</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">live</span><span class="w"> </span><span class="n">logProperties</span><span class="p">];</span><span class="w"></span>
<span class="bp">NSDateFormatter</span><span class="w"> </span><span class="o">*</span><span class="n">fm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSDateFormatter</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="n">fm</span><span class="p">.</span><span class="n">dateFormat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="p">;</span><span class="w"></span>
<span class="n">JL_MSG_Weather</span><span class="w"> </span><span class="o">*</span><span class="n">weather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">JL_MSG_Weather</span><span class="w"> </span><span class="n">new</span><span class="p">];</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">fm</span><span class="w"> </span><span class="n">dateFromString</span><span class="o">:</span><span class="n">live</span><span class="p">.</span><span class="n">reportTime</span><span class="p">];</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">province</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">live</span><span class="p">.</span><span class="n">province</span><span class="p">;</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">live</span><span class="p">.</span><span class="n">city</span><span class="p">;</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">weatherTypeFromString</span><span class="o">:</span><span class="n">live</span><span class="p">.</span><span class="n">weather</span><span class="p">];</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">live</span><span class="p">.</span><span class="n">temperature</span><span class="p">.</span><span class="n">integerValue</span><span class="p">;</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">humidity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">live</span><span class="p">.</span><span class="n">humidity</span><span class="p">.</span><span class="n">integerValue</span><span class="p">;</span><span class="w"></span>

<span class="bp">NSCharacterSet</span><span class="w"> </span><span class="o">*</span><span class="n">nonDigitsSet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSCharacterSet</span><span class="w"> </span><span class="n">decimalDigitCharacterSet</span><span class="p">]</span><span class="w"> </span><span class="n">invertedSet</span><span class="p">];</span><span class="w"></span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">digitsOnlyString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">live</span><span class="p">.</span><span class="n">windPower</span><span class="w"> </span><span class="n">stringByReplacingOccurrencesOfString</span><span class="o">:</span><span class="s">@&quot;&quot;</span><span class="w"> </span><span class="n">withString</span><span class="o">:</span><span class="s">@&quot;&quot;</span><span class="w"> </span><span class="n">options</span><span class="o">:</span><span class="n">NSRegularExpressionSearch</span><span class="w"> </span><span class="n">range</span><span class="o">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">live</span><span class="p">.</span><span class="n">windPower</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">wind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">digitsOnlyString</span><span class="p">.</span><span class="n">integerValue</span><span class="p">;</span><span class="w"></span>
<span class="n">weather</span><span class="p">.</span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">wDirectionTypeFrom</span><span class="o">:</span><span class="n">live</span><span class="p">.</span><span class="n">windDirection</span><span class="p">];</span><span class="w"></span>
<span class="p">[[</span><span class="n">JLWearable</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">]</span><span class="w"> </span><span class="n">w_syncWeather</span><span class="o">:</span><span class="n">weather</span><span class="w"> </span><span class="n">withEntity</span><span class="o">:</span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">]</span><span class="w"> </span><span class="n">result</span><span class="o">:^</span><span class="p">(</span><span class="kt">BOOL</span><span class="w"> </span><span class="n">succeed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;weather sync to device isSuccess:%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">succeed</span><span class="p">);</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="spdif">
<span id="id114"></span><h2>2.18 SPDIF模式<a class="headerlink" href="#spdif" title="永久链接至标题"></a></h2>
<section id="id115">
<h3>2.18.1 功能描述<a class="headerlink" href="#id115" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>该功能可调用功能设置相关RCSP的底层接口，通过 0x07/0x08/0x09等命令进行获取/设置和推送等，
其功能在于控制设备端的播放状态以及音源切换，诸如HDMI/光纤/同轴等切换。</p>
</div></blockquote>
</section>
<section id="id116">
<h3>2.18.2 更新SPDIF模式<a class="headerlink" href="#id116" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 更新SPDIF模式</span>
<span class="c1">/// - Parameter spdifModel: SPDIF模式</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">updateSpdifModel:</span><span class="p">(</span><span class="n">JLModelSpdif</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">spdifModel</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nv">spdifModelListen</span> <span class="p">=</span> <span class="n">PublishSubject</span><span class="p">&lt;</span><span class="n">JLModelSpdif</span><span class="p">&gt;()</span>
<span class="kd">extension</span> <span class="nc">SpdifPcViewModel</span><span class="p">:</span><span class="n">JLSpdifPCProtocol</span> <span class="p">{</span>
<span class="kd">func</span> <span class="nf">updateSpdifModel</span><span class="p">(</span><span class="kc">_</span> <span class="n">spdifModel</span><span class="p">:</span> <span class="n">JLModelSpdif</span><span class="p">)</span> <span class="p">{</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">spdifModelListen</span><span class="p">.</span><span class="n">onNext</span><span class="p">(</span><span class="n">spdifModel</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>UI层调用SpdifPcViewModel中的代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span>    <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">spdifModelListen</span><span class="p">.</span><span class="n">subscribe</span><span class="p">()</span> <span class="p">{</span> <span class="p">[</span><span class="kr">weak</span> <span class="kc">self</span><span class="p">]</span> <span class="n">model</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="p">`</span><span class="kc">self</span><span class="p">`</span> <span class="p">=</span> <span class="kc">self</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">model</span><span class="p">.</span><span class="n">playStatus</span> <span class="p">{</span>
        <span class="c1">// 更新播放暂停按钮，播放状态下的图片</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="c1">// 更新播放暂停按钮，暂停状态下的图片</span>
    <span class="p">}</span>
    <span class="k">switch</span> <span class="n">model</span><span class="p">.</span><span class="n">audioType</span> <span class="p">{</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">HDMI</span><span class="p">:</span>
        <span class="c1">// 当前是HDMI类型，更新HDMI按钮的选中状态</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">FO</span><span class="p">:</span>
        <span class="c1">// 当前是光纤类型，更新光纤按钮的选中状态</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">coaxial</span><span class="p">:</span>
        <span class="c1">// 当前是同轴类型，更新同轴按钮的选中状态</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}.</span><span class="n">disposed</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id117">
<h3>2.18.3 获取SPDIF模式的状态<a class="headerlink" href="#id117" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 获取SPDIF模式的状态</span>
<span class="c1">/// - Parameter manager: 设备对象</span>
<span class="c1">/// - Parameter callBack: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">getSpdifStatus:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">callBack:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">callBack</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nf">getSpdifStatus</span><span class="p">(</span><span class="kc">_</span> <span class="n">mgr</span><span class="p">:</span><span class="n">JL_EntityM</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span><span class="p">){</span>
    <span class="k">if</span> <span class="n">mgr</span> <span class="p">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="kd">let</span> <span class="nv">mgr</span> <span class="p">=</span> <span class="n">JL_RunSDK</span><span class="p">.</span><span class="n">sharedMe</span><span class="p">().</span><span class="n">mBleEntityM</span><span class="p">?.</span><span class="n">mCmdManager</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
        <span class="n">manager</span><span class="p">.</span><span class="n">getSpdifStatus</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span> <span class="p">{</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
        <span class="p">}</span>
     <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">manager</span><span class="p">.</span><span class="n">getSpdifStatus</span><span class="p">(</span><span class="n">mgr</span><span class="p">!.</span><span class="n">mCmdManager</span><span class="p">)</span> <span class="p">{</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
        <span class="p">}</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>UI层调用SpdifPcViewModel中的代码参考：</p>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="n">JL_EntityM</span><span class="w"> </span><span class="o">*</span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">JL_RunSDK</span><span class="w"> </span><span class="n">sharedMe</span><span class="p">]</span><span class="w"> </span><span class="n">mBleEntityM</span><span class="p">];</span><span class="w"></span>
<span class="p">[</span><span class="n">entity</span><span class="p">.</span><span class="n">mCmdManager</span><span class="w"> </span><span class="n">cmdFunction</span><span class="o">:</span><span class="n">JL_FunctionCodeCOMMON</span><span class="w"> </span><span class="n">Command</span><span class="o">:</span><span class="n">code</span><span class="w"> </span><span class="n">Extend</span><span class="o">:</span><span class="mh">0x00</span><span class="w"> </span><span class="n">Result</span><span class="o">:^</span><span class="p">(</span><span class="n">JL_CMDStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">JL_FunctionCodeSPDIF</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="p">[[</span><span class="n">SpdifPcViewModel</span><span class="w"> </span><span class="n">share</span><span class="p">]</span><span class="w"> </span><span class="n">getSpdifStatus</span><span class="o">:</span><span class="n">entity</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">showToolViewWithBit</span><span class="o">:</span><span class="mh">0x0080</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}];</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="id118">
<h3>2.18.4 设置SPDIF模式的播放状态<a class="headerlink" href="#id118" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 设置SPDIF模式的播放状态</span>
<span class="c1">/// - Parameter status: 播放状态</span>
<span class="c1">/// - Parameter manager: 设备对象</span>
<span class="c1">/// - Parameter callBack: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setSpdifPlayStatus:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">status</span><span class="w"> </span><span class="nf">Manager:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">callBack:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">callBack</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span>    <span class="kd">func</span> <span class="nf">setSpdifPlayStatus</span><span class="p">(){</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="nv">mgr</span> <span class="p">=</span> <span class="n">JL_RunSDK</span><span class="p">.</span><span class="n">sharedMe</span><span class="p">().</span><span class="n">mBleEntityM</span><span class="p">?.</span><span class="n">mCmdManager</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
    <span class="kd">let</span> <span class="nv">status</span> <span class="p">=</span> <span class="n">manager</span><span class="p">.</span><span class="n">spdifModel</span><span class="p">.</span><span class="n">playStatus</span>
    <span class="n">manager</span><span class="p">.</span><span class="n">setSpdifPlayStatus</span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">,</span> <span class="n">manager</span><span class="p">:</span> <span class="n">mgr</span><span class="p">)</span> <span class="p">{</span> <span class="n">status</span><span class="p">,</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
        <span class="k">if</span> <span class="n">status</span> <span class="p">==</span> <span class="p">.</span><span class="n">success</span> <span class="p">{</span>
            <span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">spdifModel</span><span class="p">.</span><span class="n">playStatus</span> <span class="p">=</span> <span class="o">!</span><span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">spdifModel</span><span class="p">.</span><span class="n">playStatus</span>
            <span class="kc">self</span><span class="p">.</span><span class="n">spdifModelListen</span><span class="p">.</span><span class="n">onNext</span><span class="p">(</span><span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">spdifModel</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>UI层调用SpdifPcViewModel中的代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="n">ppBtn</span><span class="p">.</span><span class="n">rx</span><span class="p">.</span><span class="n">tap</span><span class="p">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="kc">_</span> <span class="k">in</span>
    <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">setSpdifPlayStatus</span><span class="p">()</span>
<span class="p">}.</span><span class="n">disposed</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id119">
<h3>2.18.5 设置SPDIF模式音源<a class="headerlink" href="#id119" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// - Parameter type: 音源类型</span>
<span class="c1">/// - Parameter manager: 设备对象</span>
<span class="c1">/// - Parameter callBack: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setSpdifAction:</span><span class="p">(</span><span class="n">JLSpdifAudioType</span><span class="p">)</span><span class="nv">type</span><span class="w"> </span><span class="nf">Manager:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">callBack:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">callBack</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span>    <span class="kd">func</span> <span class="nf">setSpdifAudioType</span><span class="p">(</span><span class="kc">_</span> <span class="n">type</span><span class="p">:</span><span class="n">JLSpdifAudioType</span><span class="p">){</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="nv">mgr</span> <span class="p">=</span> <span class="n">JL_RunSDK</span><span class="p">.</span><span class="n">sharedMe</span><span class="p">().</span><span class="n">mBleEntityM</span><span class="p">?.</span><span class="n">mCmdManager</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
    <span class="n">manager</span><span class="p">.</span><span class="n">setSpdifAction</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">manager</span><span class="p">:</span> <span class="n">mgr</span><span class="p">,</span> <span class="n">callBack</span><span class="p">:</span> <span class="p">{</span> <span class="n">status</span><span class="p">,</span>  <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
        <span class="k">if</span> <span class="n">status</span> <span class="p">==</span> <span class="p">.</span><span class="n">success</span> <span class="p">{</span>
            <span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">spdifModel</span><span class="p">.</span><span class="n">audioType</span> <span class="p">=</span> <span class="n">type</span>
            <span class="kc">self</span><span class="p">.</span><span class="n">spdifModelListen</span><span class="p">.</span><span class="n">onNext</span><span class="p">(</span><span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">spdifModel</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">})</span>
<span class="p">}</span>
</pre></div>
</div>
<p>UI层调用SpdifPcViewModel中的代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="n">hdmiBtn</span><span class="p">.</span><span class="n">rx</span><span class="p">.</span><span class="n">tap</span><span class="p">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="kc">_</span> <span class="k">in</span>
    <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">setSpdifAudioType</span><span class="p">(.</span><span class="n">HDMI</span><span class="p">)</span>
<span class="p">}.</span><span class="n">disposed</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>

<span class="n">foBtn</span><span class="p">.</span><span class="n">rx</span><span class="p">.</span><span class="n">tap</span><span class="p">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="p">[</span><span class="kr">weak</span> <span class="kc">self</span><span class="p">]</span> <span class="kc">_</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="p">`</span><span class="kc">self</span><span class="p">`</span> <span class="p">=</span> <span class="kc">self</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
    <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">setSpdifAudioType</span><span class="p">(.</span><span class="n">FO</span><span class="p">)</span>
<span class="p">}.</span><span class="n">disposed</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>

<span class="n">coaxialBtn</span><span class="p">.</span><span class="n">rx</span><span class="p">.</span><span class="n">tap</span><span class="p">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="p">[</span><span class="kr">weak</span> <span class="kc">self</span><span class="p">]</span> <span class="kc">_</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="p">`</span><span class="kc">self</span><span class="p">`</span> <span class="p">=</span> <span class="kc">self</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
    <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">setSpdifAudioType</span><span class="p">(.</span><span class="n">coaxial</span><span class="p">)</span>
<span class="p">}.</span><span class="n">disposed</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="pc">
<span id="id120"></span><h2>2.19 PC从机模式<a class="headerlink" href="#pc" title="永久链接至标题"></a></h2>
<section id="id121">
<h3>2.19.1 功能描述<a class="headerlink" href="#id121" title="永久链接至标题"></a></h3>
<blockquote>
<div><p>新增PC从机模式，该功能可调用功能设置相关RCSP的底层接口，通过 0x07/0x08/0x09等命令进行获取/设置和推送等，
其功能在于控制设备端的播放状态、上下曲。</p>
</div></blockquote>
</section>
<section id="id122">
<h3>2.19.2 更新PC从机模式<a class="headerlink" href="#id122" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 更新PC从机模式</span>
<span class="c1">/// - Parameter pcServerModel: PC Server</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">updatePcServerModel:</span><span class="p">(</span><span class="n">JLModelPCServer</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">pcServerModel</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nv">pcServerModelListen</span> <span class="p">=</span> <span class="n">PublishSubject</span><span class="p">&lt;</span><span class="n">JLModelPCServer</span><span class="p">&gt;()</span>
<span class="kd">extension</span> <span class="nc">SpdifPcViewModel</span><span class="p">:</span><span class="n">JLSpdifPCProtocol</span> <span class="p">{</span>
<span class="kd">func</span> <span class="nf">updatePcServerModel</span><span class="p">(</span><span class="kc">_</span> <span class="n">pcServerModel</span><span class="p">:</span> <span class="n">JLModelPCServer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">pcServerModelListen</span><span class="p">.</span><span class="n">onNext</span><span class="p">(</span><span class="n">pcServerModel</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>UI层调用SpdifPcViewModel中的代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span>    <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">pcServerModelListen</span><span class="p">.</span><span class="n">subscribe</span><span class="p">()</span> <span class="p">{</span> <span class="p">[</span><span class="kr">weak</span> <span class="kc">self</span><span class="p">]</span> <span class="n">model</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="kd">let</span> <span class="p">`</span><span class="kc">self</span><span class="p">`</span> <span class="p">=</span> <span class="kc">self</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">model</span><span class="p">.</span><span class="n">playStatus</span> <span class="p">{</span>
        <span class="c1">// 更新播放暂停按钮，播放状态下的图片</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="c1">// 更新播放暂停按钮，暂停状态下的图片</span>
    <span class="p">}</span>
<span class="p">}.</span><span class="n">disposed</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id123">
<h3>2.19.3 获取PC从机模式的状态<a class="headerlink" href="#id123" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 获取PC从机模式的状态</span>
<span class="c1">/// - Parameter manager: 设备对象</span>
<span class="c1">/// - Parameter callBack: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">getPcServerStatus:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">callBack:</span><span class="w"> </span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">callBack</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span>    <span class="kd">let</span> <span class="nv">manager</span> <span class="p">=</span> <span class="n">JLSpdifPCManager</span><span class="p">()</span>
    <span class="kd">func</span> <span class="nf">getPcServiceStatus</span><span class="p">(</span><span class="kc">_</span> <span class="n">mgr</span><span class="p">:</span><span class="n">JL_EntityM</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span><span class="p">){</span>
    <span class="k">if</span> <span class="n">mgr</span> <span class="p">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="kd">let</span> <span class="nv">mgr</span> <span class="p">=</span> <span class="n">JL_RunSDK</span><span class="p">.</span><span class="n">sharedMe</span><span class="p">().</span><span class="n">mBleEntityM</span><span class="p">?.</span><span class="n">mCmdManager</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
        <span class="n">manager</span><span class="p">.</span><span class="n">getPcServerStatus</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span> <span class="p">{</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
        <span class="p">}</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">manager</span><span class="p">.</span><span class="n">getPcServerStatus</span><span class="p">(</span><span class="n">mgr</span><span class="p">!.</span><span class="n">mCmdManager</span><span class="p">)</span> <span class="p">{</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id124">
<h3>2.19.4 设置PC从机模式的播放状态<a class="headerlink" href="#id124" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// 设置PC从机模式的播放状态</span>
<span class="c1">/// - Parameter status: 播放状态</span>
<span class="c1">/// - Parameter manager: 设备对象</span>
<span class="c1">/// - Parameter callBack: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setPcServerPlayStatus:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">status</span><span class="w"> </span><span class="nf">Manager:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">callBack:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">callBack</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span>    <span class="kd">func</span> <span class="nf">setPCPlayStatus</span><span class="p">(){</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="nv">mgr</span> <span class="p">=</span> <span class="n">JL_RunSDK</span><span class="p">.</span><span class="n">sharedMe</span><span class="p">().</span><span class="n">mBleEntityM</span><span class="p">?.</span><span class="n">mCmdManager</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
    <span class="kd">let</span> <span class="nv">manager</span> <span class="p">=</span> <span class="n">JLSpdifPCManager</span><span class="p">()</span>
    <span class="kd">let</span> <span class="nv">status</span> <span class="p">=</span> <span class="n">manager</span><span class="p">.</span><span class="n">pcServerModel</span><span class="p">.</span><span class="n">playStatus</span>
    <span class="n">manager</span><span class="p">.</span><span class="n">setPcServerPlayStatus</span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">,</span> <span class="n">manager</span><span class="p">:</span> <span class="n">mgr</span><span class="p">)</span> <span class="p">{</span> <span class="n">status</span><span class="p">,</span> <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
        <span class="k">if</span> <span class="n">status</span> <span class="p">==</span> <span class="p">.</span><span class="n">success</span> <span class="p">{</span>
            <span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">pcServerModel</span><span class="p">.</span><span class="n">playStatus</span> <span class="p">=</span> <span class="o">!</span><span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">pcServerModel</span><span class="p">.</span><span class="n">playStatus</span>
            <span class="kc">self</span><span class="p">.</span><span class="n">pcServerModelListen</span><span class="p">.</span><span class="n">onNext</span><span class="p">(</span><span class="kc">self</span><span class="p">.</span><span class="n">manager</span><span class="p">.</span><span class="n">pcServerModel</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>UI层调用SpdifPcViewModel中的代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nf">pcPPState</span><span class="p">(){</span>
  <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">setPCPlayStatus</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id125">
<h3>2.19.5 设置PC从机模式的操作类型<a class="headerlink" href="#id125" title="永久链接至标题"></a></h3>
<div class="highlight-objective-c notranslate"><div class="highlight"><pre><span></span><span class="c1">/// - Parameter type: 操作类型</span>
<span class="c1">/// - Parameter manager: 设备对象</span>
<span class="c1">/// - Parameter callBack: 回调</span>
<span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setPcServerAction:</span><span class="p">(</span><span class="n">JLPcServerOpType</span><span class="p">)</span><span class="nv">type</span><span class="w"> </span><span class="nf">Manager:</span><span class="p">(</span><span class="n">JL_ManagerM</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">manager</span><span class="w"> </span><span class="nf">callBack:</span><span class="p">(</span><span class="n">JL_CMD_RESPOND</span><span class="p">)</span><span class="nv">callBack</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>SpdifPcViewModel调用代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nf">pcNextOrPrivious</span><span class="p">(</span><span class="kc">_</span> <span class="n">type</span><span class="p">:</span><span class="n">JLPcServerOpType</span><span class="p">){</span>
    <span class="k">guard</span> <span class="kd">let</span> <span class="nv">mgr</span> <span class="p">=</span> <span class="n">JL_RunSDK</span><span class="p">.</span><span class="n">sharedMe</span><span class="p">().</span><span class="n">mBleEntityM</span><span class="p">?.</span><span class="n">mCmdManager</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span><span class="p">}</span>
    <span class="kd">let</span> <span class="nv">manager</span> <span class="p">=</span> <span class="n">JLSpdifPCManager</span><span class="p">()</span>
    <span class="n">manager</span><span class="p">.</span><span class="n">setPcServerAction</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">manager</span><span class="p">:</span> <span class="n">mgr</span><span class="p">,</span> <span class="n">callBack</span><span class="p">:</span> <span class="p">{</span> <span class="n">status</span><span class="p">,</span>  <span class="kc">_</span><span class="p">,</span> <span class="kc">_</span> <span class="k">in</span>
    <span class="p">})</span>
<span class="p">}</span>
</pre></div>
</div>
<p>UI层调用SpdifPcViewModel中的代码参考：</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nf">pcPrivious</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">pcNextOrPrivious</span><span class="p">(.</span><span class="n">previous</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">pcNext</span><span class="p">(){</span>
  <span class="n">SpdifPcViewModel</span><span class="p">.</span><span class="n">share</span><span class="p">.</span><span class="n">pcNextOrPrivious</span><span class="p">(.</span><span class="n">next</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="import_desc.html" class="btn btn-neutral float-left" title="1.接入流程" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="browse_desc.html" class="btn btn-neutral float-right" title="3 目录浏览" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2024, 珠海市杰理科技股份有限公司.
      <span class="lastupdated">最后更新于 9月 10, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>